(window.multistep_editor_jsonpFunction=window.multistep_editor_jsonpFunction||[]).push([[21],{855:function(e,r){e.exports='<style>\r\n    :host * {\r\n        transition: all 0.5s ease-in;\r\n    }\r\n\r\n    .uploader-container {\r\n        width: 100%;\r\n        height: 100%;\r\n        color: var(--theme-text-color-1);\r\n    }\r\n\r\n    #drop-area {\r\n        position: relative;\r\n        height: 100%;\r\n        background: var(--au-uploader-background-color);\r\n        border: 2px dashed var(--au-uploader-dashed-border-color);\r\n        box-sizing: border-box;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        transition: all 0.25s ease-out;\r\n    }\r\n\r\n    #drop-area.highlight {\r\n        background: var(--theme-secondary-color);\r\n    }\r\n\r\n    #error-bar {\r\n        position: absolute;\r\n        top: calc(2*var(--au-hem));\r\n        margin: 0 auto;\r\n        background: #FFD4D4;\r\n        ;\r\n        width: 90%;\r\n        padding: calc(1*var(--au-hem));\r\n        border-radius: 3px;\r\n    }\r\n\r\n    #error-bar .caption {\r\n        color: #E53935;\r\n    }\r\n\r\n    p {\r\n        margin-top: 0;\r\n    }\r\n\r\n    .dragText {\r\n        @apply --au-h5-font;\r\n        color: var(--au-uploader-text-color);\r\n    }\r\n\r\n    .caption {\r\n        @apply --au-caption-font;\r\n        color: var(--au-uploader-supported-text-color)\r\n    }\r\n\r\n    .my-form {\r\n        margin-bottom: calc(0.625 * var(--au-hem));\r\n        text-align: center;\r\n        --iron-icon-fill-color: currentcolor;\r\n        --iron-icon-stroke-color: none;\r\n        --iron-icon-width: calc(4.0625 * var(--au-hem));\r\n        --iron-icon-height: calc(4.0625 * var(--au-hem));\r\n    }\r\n\r\n    #gallery {\r\n        margin-top: calc(0.625 * var(--au-hem));\r\n    }\r\n\r\n    #gallery img {\r\n        width: calc(9.375 * var(--au-hem));\r\n        margin-bottom: calc(0.625 * var(--au-hem));\r\n        margin-right: calc(0.625 * var(--au-hem));\r\n        vertical-align: middle;\r\n    }\r\n\r\n    .button {\r\n        color: var(--primary-color);\r\n        cursor: pointer;\r\n    }\r\n\r\n    .button:hover {\r\n        text-decoration: underline;\r\n    }\r\n\r\n    #fileElem {\r\n        display: none;\r\n    }\r\n\r\n    .hidden {\r\n        visibility: hidden !important;\r\n        display: none !important;\r\n    }\r\n\r\n    .progress-bar {\r\n        text-align: center;\r\n    }\r\n\r\n    #progress-bar__percent {\r\n        @apply --au-h3-font;\r\n    }\r\n\r\n    .progress-bar__indicator {\r\n        height: calc(0.625 * var(--au-hem));\r\n        min-width: calc(15 * var(--au-hem));\r\n        background-color: var(--au-progress-bar-background-color);\r\n        position: relative;\r\n    }\r\n\r\n    #progress-bar__indicator {\r\n        height: 100%;\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        background-color: var(--primary-color);\r\n        transition: all 0.25s ease-in;\r\n    }\r\n</style>\r\n<div class="uploader-container">\r\n    <div id="drop-area">\r\n        <form id="form" class="my-form">\r\n            <svg width="65px" height="65px" viewBox="0 0 65 65" fill="none" xmlns="http://www.w3.org/2000/svg">\r\n                <path\r\n                    d="M56.934 22.1002C57.2867 20.6913 57.4649 19.2415 57.4649 17.7733C57.4649 7.97315 49.4919 0 39.6915 0C33.5323 0 27.8589 3.17141 24.6194 8.34982C23.6475 8.00654 22.6153 7.82804 21.58 7.82804C16.9766 7.82804 13.1607 11.2645 12.5636 15.707C5.53504 16.3115 0 22.2256 0 29.4081C0 36.9909 6.16905 43.16 13.7518 43.16H19.1673L17.7791 44.9338C17.4798 45.3162 17.4249 45.8358 17.6375 46.2723C17.8502 46.7089 18.2932 46.9858 18.7788 46.9858H23.7662V63.7305C23.7662 64.4316 24.3345 65 25.0357 65H39.9643C40.6655 65 41.2338 64.4316 41.2338 63.7305V46.9858H46.2211C46.7067 46.9858 47.1496 46.7088 47.3624 46.2723C47.575 45.8358 47.5202 45.3162 47.2208 44.9338L45.8326 43.16H54.3081C60.2036 43.16 65 38.3636 65 32.4681C65.0001 27.497 61.6234 23.2752 56.934 22.1002ZM39.9644 44.4467C39.2633 44.4467 38.6949 45.0151 38.6949 45.7162V62.4609H26.3054V45.7162C26.3054 45.0151 25.737 44.4467 25.0358 44.4467H21.3845L32.5001 30.2436L43.6156 44.4467H39.9644ZM54.3082 40.621H43.8456L33.4998 27.4014C33.2591 27.0939 32.8904 26.9143 32.5001 26.9143C32.1097 26.9143 31.7409 27.0939 31.5003 27.4014L21.1545 40.621H13.7518C7.56909 40.621 2.53907 35.5909 2.53907 29.4081C2.53907 23.2254 7.56909 18.1953 13.7518 18.1953C14.453 18.1953 15.0214 17.6269 15.0214 16.9257C15.0214 13.3094 17.9635 10.3671 21.58 10.3671C22.6346 10.3671 23.6413 10.6096 24.572 11.0877C25.1869 11.4035 25.9418 11.1693 26.2698 10.5604C28.935 5.61271 34.0778 2.53906 39.6915 2.53906C48.0917 2.53906 54.9259 9.37306 54.9259 17.7733C54.9259 19.4568 54.653 21.1111 54.115 22.6902C53.9905 23.0554 54.039 23.4575 54.2467 23.7827C54.4544 24.1081 54.7987 24.3211 55.1824 24.362C59.332 24.8035 62.4612 28.2884 62.4612 32.4681C62.4611 36.9636 58.8037 40.621 54.3082 40.621Z"\r\n                    fill="#30C2FF" />\r\n                <path\r\n                    d="M29.3722 10.7039C28.7568 10.3685 27.9832 10.5998 27.6476 11.2154L27.6113 11.2823C27.2784 11.8994 27.5089 12.6695 28.1261 13.0023C28.3178 13.1056 28.5241 13.1546 28.7276 13.1546C29.1793 13.1546 29.6166 12.9129 29.8462 12.4875L29.8771 12.4306L29.882 12.4217C30.2174 11.8061 29.988 11.0394 29.3722 10.7039Z"\r\n                    fill="#30C2FF" />\r\n                <path\r\n                    d="M38.8495 4.08813C35.5655 4.28884 32.461 5.66602 30.1078 7.9659C29.6063 8.45594 29.5972 9.25968 30.0872 9.76114C30.336 10.0156 30.6655 10.1433 30.9952 10.1433C31.3152 10.1433 31.6355 10.023 31.8824 9.78158C33.7997 7.90789 36.3289 6.78588 39.0044 6.62236C39.7043 6.57958 40.2369 5.97757 40.1941 5.2778C40.1513 4.57804 39.5506 4.04509 38.8495 4.08813Z"\r\n                    fill="#30C2FF" />\r\n            </svg>\r\n            <input type="file" id="fileElem" multiple="[[multiple]]" accept="{{fileTypes}}">\r\n            <p class="dragText">{{text}} <label class="button" for="fileElem">{{buttonText}}</label> </p>\r\n            <p class="caption"> {{supportedText}} {{fileTypes}}</p>\r\n            <div id="gallery"></div>\r\n        </form>\r\n        <div id="progress-bar" class="progress-bar hidden">\r\n            <span id="progress-bar__percent"></span>\r\n            <div class="progress-bar__indicator">\r\n                <span id="progress-bar__indicator"></span>\r\n            </div>\r\n            <span class="caption">{{localize(\'widgets.uploader.uploading\')}}</span>\r\n        </div>\r\n        <div id="error-bar" class="error-bar hidden">\r\n            <span class="caption">{{localize(\'widgets.uploader.error.types\')}}</span>\r\n        </div>\r\n    </div>\r\n</div>'},907:function(e,r,t){"use strict";t.r(r),t.d(r,"AuWidgetUploader",function(){return p}),t.d(r,"widget",function(){return p});var n=t(0),o=t(855),s=t(117),i=t(1),a=t(20),d=t(6);let p=class extends s.c{constructor(){super(...arguments),this.response=null,this.httpCode=0,this.statusText="",this.responseType="json",this.errorResponse="",this.lockClose=!1,this.timeout=null}responseChanged(){this.emitChange({response:this.response})}get _(){return this.response}updateParams(e){this.text=e.text,this.supportedText=e.supportedText,this.buttonText=e.buttonText,this.multiple=e.multiple,this.fileTypes=e.fileTypes,this.destination=e.destination,this._onSuccess=d.a.functionWrapperConstructor(e.onSuccess),this._onError=d.a.functionWrapperConstructor(e.onError),this.dropArea=this.$["drop-area"],this.headers=e.headers||{},this.fileFormName=e.fileFormName||"file",this.form=e.form||{},this.responseType=e.responseType||"json"}connectedCallback(){super.connectedCallback(),this.events(this.$["drop-area"])}events(e){["dragenter","dragover","dragleave","dragend","dragexit","drop"].forEach(r=>{e.addEventListener(r,e=>{e.preventDefault(),e.stopPropagation()},!1)}),["dragenter","dragover"].forEach(r=>{e.addEventListener(r,r=>{e.classList.add("highlight")},!1)}),["dragend","dragexit","dragleave"].forEach(r=>{e.addEventListener(r,r=>{e.classList.remove("highlight"),this.eventShowWidgetClose(1e3)},!1)}),e.addEventListener("drop",r=>{e.classList.remove("highlight"),this.lockClose=!0,clearTimeout(this.timeout),this.handleFileList(r.dataTransfer.files)},!1),this.$.fileElem.addEventListener("change",e=>{this.handleFileList(e.srcElement.files)},!1)}cleanState(){this.$["drop-area"].classList.remove("highlight"),this.$["error-bar"].classList.contains("hidden")||this.$["error-bar"].classList.add("hidden"),clearTimeout(this.timeout),this.lockClose=!1}errorHandler(){this.$["error-bar"].classList.toggle("hidden")}handleFileList(e){let r=[];for(let t=0;t<e.length;t++)r.push(e[t]);let t=this.fileTypes.reduce((e,r)=>e+=r.replace(".","")+"|","^.*.(").replace(/.$/,")$"),n=new RegExp(t,"i"),o=r.filter(e=>n.test(e.name));o.forEach((e,r)=>this.uploadFile(e,r)),0===o.length&&(this.lockClose=!1,this.errorHandler(),this.eventShowWidgetClose(3e3))}uploadFile(e,r){const t=this,n=this.destination,o=new XMLHttpRequest,s=new FormData;o.open("POST",n,!0),Object.keys(this.headers).forEach(e=>{o.setRequestHeader(e,this.headers[e])}),Object.keys(this.form).forEach(r=>{let t=this.form[r];"<FILENAME>"===t&&(t=e.name),"object"==typeof t&&(t=JSON.stringify(t)),s.append(r,t)}),o.upload.addEventListener("progress",function(e){t.changeProgress(100*e.loaded/e.total||100)}),o.addEventListener("readystatechange",function(e){if(4===o.readyState)if(t.lockClose=!1,t.eventShowWidgetClose(1),t.changeProgress(0),t.toggleStatus(),t.httpCode=o.status,t.statusText=o.statusText,o.status>=200&&o.status<300){switch(this.responseType){case"json":t.response=JSON.parse(this.response);break;default:t.response=this.response}t._onSuccess()}else t.errorResponse=this.response,t._onError()}),s.append(this.fileFormName,e),o.send(s),this.toggleStatus()}toggleStatus(){this.$["progress-bar"].classList.toggle("hidden"),this.$.form.classList.toggle("hidden")}changeProgress(e){e=Math.floor(e),this.$["progress-bar__percent"].innerHTML=e+"%",this.$["progress-bar__indicator"].setAttribute("style","width:"+e+"%;")}eventShowWidgetClose(e){this.lockClose||(this.timeout=setTimeout(()=>{this.publishData({},a.a.CLOSE_DISPLAYED_WIDGET),this.cleanState()},e))}};n.b([Object(i.c)(),n.d("design:type",Object)],p.prototype,"params",void 0),n.b([Object(i.c)({notify:!0}),n.d("design:type",String)],p.prototype,"text",void 0),n.b([Object(i.c)(),n.d("design:type",String)],p.prototype,"supportedText",void 0),n.b([Object(i.c)(),n.d("design:type",String)],p.prototype,"buttonText",void 0),n.b([Object(i.c)(),n.d("design:type",Boolean)],p.prototype,"multiple",void 0),n.b([Object(i.c)(),n.d("design:type",Array)],p.prototype,"fileTypes",void 0),n.b([Object(i.c)(),n.d("design:type",String)],p.prototype,"destination",void 0),n.b([Object(i.c)(),n.d("design:type",Object)],p.prototype,"headers",void 0),n.b([Object(i.c)(),n.d("design:type",String)],p.prototype,"fileFormName",void 0),n.b([Object(i.c)(),n.d("design:type",Object)],p.prototype,"form",void 0),n.b([Object(i.c)(),n.d("design:type",Function)],p.prototype,"_onSuccess",void 0),n.b([Object(i.c)(),n.d("design:type",Function)],p.prototype,"_onError",void 0),n.b([Object(i.c)(),n.d("design:type",Object)],p.prototype,"response",void 0),n.b([Object(i.c)(),n.d("design:type",Number)],p.prototype,"httpCode",void 0),n.b([Object(i.c)(),n.d("design:type",String)],p.prototype,"statusText",void 0),n.b([Object(i.c)(),n.d("design:type",String)],p.prototype,"responseType",void 0),n.b([Object(i.c)(),n.d("design:type",Object)],p.prototype,"errorResponse",void 0),n.b([Object(i.b)("response"),n.d("design:type",Function),n.d("design:paramtypes",[]),n.d("design:returntype",void 0)],p.prototype,"responseChanged",null),p=n.b([Object(i.a)("au-widget-uploader",o)],p)}}]);