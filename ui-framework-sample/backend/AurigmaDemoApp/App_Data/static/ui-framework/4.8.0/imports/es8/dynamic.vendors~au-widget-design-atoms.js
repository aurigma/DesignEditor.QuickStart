(window.multistep_editor_jsonpFunction=window.multistep_editor_jsonpFunction||[]).push([[44],{537:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e[e.ready=0]="ready",e[e.refresh=1]="refresh",e[e.busy=2]="busy"}(i||(i={}))},707:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(383),o=n(472),r=n(430),a=function(){function e(e,t){if(this.N="",this.V=!0,this.L=!1,this.ID="l"+(new Date).getTime()+Math.round(1e3*Math.random()),this.VO=[],this.RenderingType=r.a.Normal,e){if(this.RenderingType=e.renderingType,t)return;this.N=e.get_name(),this.V=e.get_visible(),this.L=e.get_locked(),this.R=e.get_region(),this.ID=e.get_uniqueId(),this.VO=[];for(var n=e.itemHandlers,i=0;i<n.get_count();i++){var o=n.get_item(i);this.VO.push({T:o.getTypeName(),D:o.getData("asObject")})}this.TextureStorageId=e.textureStorageId,this.TextureSourceWidth=e.textureSourceWidth,this.TextureSourceHeight=e.textureSourceHeight,this.PreviewColor=e.previewColor}}return e.applyState=function(e,t,n){if(n||(n={}),t){t.set_name(e.N),t.set_visible(e.V),t.set_locked(e.L),t.set_uniqueId(e.ID),t.textureStorageId=e.TextureStorageId,t.textureSourceWidth=e.TextureSourceWidth,t.textureSourceHeight=e.TextureSourceHeight,t.previewColor=e.PreviewColor,t.renderingType=e.RenderingType,e.R&&t.set_region(i.a.FromObject(e.R));for(var r=t.itemHandlers,a=0;a<e.VO.length;a++){var s=e.VO[a].D,l=n[s.ID];l?(n[s.ID]=null,l.setData(s)):((l=(new o.a).create(e.VO[a].T)).setData(s),l.initialize()),r.add(l)}}},e}()},708:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n(707),o=n(536),r=n(395),a=n(401),s=n(370),l=n(375),c=n(530),h=function(){function e(e,t){var n=this;if(this._container=e,this._uniqueId="l"+(new Date).getTime()+Math.round(1e3*Math.random()),this._textureSizeMultiplier=null,this._textureUrl=null,this._isTextureLoaded=!1,this._createItemHandlersCollection=function(){n.itemHandlers.setRange(n._container.items.ofType(a.a).select(n._canvas.handlerFactory.get).toArray()),n._canvas.redraw()},this._onContainerPropertyChanged=function(e,t){switch(t){case"visible":n.set_visible(e.visible);break;case"previewTextureSource":n._updateTexture(!0)}},this._canvas=null,this._itemHandlers=new o.a(this),this._visible=!0,this._updateTexture=function(e){if(null!=n._canvas&&!n.locked&&(null!=n.textureStorageId&&null!=n.textureSourceWidth&&null!=n.textureSourceHeight||null!=n.previewColor)){var t=n._canvas.get_width(),i=n._canvas.get_height();if(null==n.previewColor){var o=Math.max(t/n.textureSourceWidth,i/n.textureSourceHeight);if(o=Math.min(1,o),e||null==n._textureSizeMultiplier||!(n._textureSizeMultiplier>o)){n._textureSizeMultiplier=o;var r=n._textureUrl,a=parseInt((n.textureSourceWidth*o).toString()),s=parseInt((n.textureSourceHeight*o).toString());if(n._textureUrl=c.a.getImageUrl(n._canvas,n.textureStorageId,a,s,!1,null,!0),r!==n._textureUrl){var h=new Image(a,s);h.src=n._textureUrl;var u=n;h.onload=function(){u.textureImage=h,u._isTextureLoaded=!0,u._canvas.onLayerTextureLoaded()}}}}else if(null==n.textureImage){n.textureImage=document.createElement("canvas"),n.textureImage.width=10,n.textureImage.height=10;var d=n.textureImage.getContext("2d");d.fillStyle=new l.RgbColor(n.previewColor).preview,d.fillRect(0,0,10,10)}}},this._disposeEvent=new s.a,this.textureImage=null,null!=t&&(this._canvas=t),null!=this._container){this._container.addPropertyChanged(this._onContainerPropertyChanged);var i=function(e){null!=e&&(n.itemHandlers.insertAt(e.index,n._canvas.handlerFactory.get(e.item)),n._canvas.updateTexts())},r=function(e){null!=e&&n.itemHandlers.removeAt(e.index)},h=function(e){null!=e&&n.itemHandlers.move(e.oldIndex,e.newIndex)};this._container.items.add_itemAdded(i),this._container.items.add_itemRemoved(r),this._container.items.add_itemMoved(h),this._disposeEvent.add(function(){n._container.items.remove_itemAdded(i),n._container.items.remove_itemRemoved(r),n._container.items.remove_itemMoved(h)}),this._createItemHandlersCollection(),this._visible=this._container.visible}}return e.prototype.get_uniqueId=function(){return this._uniqueId},e.prototype.set_uniqueId=function(e){this._uniqueId=e},e.prototype.get_canvas=function(){return this._canvas},e.prototype.set_canvas=function(e){this._canvas=e},e.prototype.get_index=function(){var e=this.get_canvas();return e?e.get_layers().indexOf(this):-1},e.prototype.get_data=function(){var e=new i.a(this);return JSON.stringify(e)},e.prototype.set_data=function(e){if(e&&""!=e){var t=JSON.parse(e);i.a.applyState(t,this)}},Object.defineProperty(e.prototype,"region",{get:function(){return this._container.region},set:function(e){this._container.region=e},enumerable:!0,configurable:!0}),e.prototype.get_region=function(){return this.region},e.prototype.set_region=function(e){this.region=e},Object.defineProperty(e.prototype,"itemHandlers",{get:function(){return this._itemHandlers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._container.name},set:function(e){this.container.name=e},enumerable:!0,configurable:!0}),e.prototype.get_name=function(){return this.name},e.prototype.set_name=function(e){this.name=e},e.prototype.get_visible=function(){return this._visible},e.prototype.set_visible=function(e,t){this._visible!==e&&(this._visible=e,(t=null==t||t)&&null!=this._canvas&&(this._canvas.updatePlaceholderButtonGroups(),this._canvas.updateViolationContainers()))},Object.defineProperty(e.prototype,"locked",{get:function(){return this._container.locked},set:function(e){this.locked!==e&&(this.container.locked=e,null!=this._canvas&&this._canvas.updatePlaceholderButtonGroups())},enumerable:!0,configurable:!0}),e.prototype.get_locked=function(){return this.locked},e.prototype.set_locked=function(e){this.locked=e},e.prototype._onRemovedFromCanvas=function(e){for(var t=this.itemHandlers,n=t.get_count(),i=0;i<n;i++)t.get_item(i).canvas=null;this._canvas.remove_zoomChanged(this._updateTexture)},e.prototype.onLayerAdded=function(){this._updateTexture(),this._canvas.add_zoomChanged(this._updateTexture)},e.prototype.isTextureLoadedOrNotExists=function(){return null==this.textureStorageId||this._isTextureLoaded},e.prototype.dispose=function(){this._disposeEvent.notify()},Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureStorageId",{get:function(){return this._container instanceof r.e?this._container.previewTextureSource.id:null},set:function(e){this._container instanceof r.e&&(this._container.previewTextureSource.id=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureSourceWidth",{get:function(){return this._container instanceof r.e?this._container.previewTextureSource.width:null},set:function(e){this._container instanceof r.e&&(this._container.previewTextureSource.width=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureSourceHeight",{get:function(){return this._container instanceof r.e?this._container.previewTextureSource.height:null},set:function(e){this._container instanceof r.e&&(this._container.previewTextureSource.height=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previewColor",{get:function(){return this._container instanceof r.c?this._container.previewColor:null},set:function(e){this._container instanceof r.c&&(this._container.previewColor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderingType",{get:function(){return this._container.renderingType},set:function(e){this.container.renderingType=e},enumerable:!0,configurable:!0}),e}()},709:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e[e.always=0]="always",e[e.auto=1]="auto"}(i||(i={}))},710:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e[e.centerBottom=5]="centerBottom",e[e.centerCenter=4]="centerCenter",e[e.centerTop=3]="centerTop",e[e.leftBottom=2]="leftBottom",e[e.leftCenter=1]="leftCenter",e[e.leftTop=0]="leftTop",e[e.rightBottom=8]="rightBottom",e[e.rightCenter=7]="rightCenter",e[e.rightTop=6]="rightTop"}(i||(i={}))},711:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e[e.none=0]="none",e[e.bestFit=1]="bestFit",e[e.bestFitShrinkOnly=2]="bestFitShrinkOnly",e[e.fitToWidth=3]="fitToWidth",e[e.fitToHeight=4]="fitToHeight",e[e.fitToWidthShrinkOnly=6]="fitToWidthShrinkOnly",e[e.fitToHeightShrinkOnly=7]="fitToHeightShrinkOnly"}(i||(i={}))},712:function(e,t){
/*! Hammer.JS - v1.1.3 - 2014-05-20
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
!function(t,n){"use strict";var i=function e(t,n){return new e.Instance(t,n||{})};i.VERSION="1.1.3",i.defaults={behavior:{userSelect:"none",touchAction:"pan-y",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},i.DOCUMENT=document,i.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,i.HAS_TOUCHEVENTS="ontouchstart"in t,i.IS_MOBILE=/mobile|tablet|ip(ad|hone|od)|android|silk/i.test(navigator.userAgent),i.NO_MOUSEEVENTS=i.HAS_TOUCHEVENTS&&i.IS_MOBILE||i.HAS_POINTEREVENTS,i.CALCULATE_INTERVAL=25;var o={},r=i.DIRECTION_DOWN="down",a=i.DIRECTION_LEFT="left",s=i.DIRECTION_UP="up",l=i.DIRECTION_RIGHT="right",c=i.POINTER_MOUSE="mouse",h=i.POINTER_TOUCH="touch",u=i.POINTER_PEN="pen",d=i.EVENT_START="start",_=i.EVENT_MOVE="move",p=i.EVENT_END="end",g=i.EVENT_RELEASE="release",f=i.EVENT_TOUCH="touch";i.READY=!1,i.plugins=i.plugins||{},i.gestures=i.gestures||{};var v=i.utils={extend:function(e,t,n){for(var i in t)!t.hasOwnProperty(i)||void 0!==e[i]&&n||(e[i]=t[i]);return e},on:function(e,t,n){e.addEventListener(t,n,!1)},off:function(e,t,n){e.removeEventListener(t,n,!1)},each:function(e,t,n){var i,o;if("forEach"in e)e.forEach(t,n);else if(void 0!==e.length){for(i=0,o=e.length;i<o;i++)if(!1===t.call(n,e[i],i,e))return}else for(i in e)if(e.hasOwnProperty(i)&&!1===t.call(n,e[i],i,e))return},inStr:function(e,t){return e.indexOf(t)>-1},inArray:function(e,t){if(e.indexOf){var n=e.indexOf(t);return-1!==n&&n}for(var i=0,o=e.length;i<o;i++)if(e[i]===t)return i;return!1},toArray:function(e){return Array.prototype.slice.call(e,0)},hasParent:function(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(e){var t=[],n=[],i=[],o=[],r=Math.min,a=Math.max;return 1===e.length?{pageX:e[0].pageX,pageY:e[0].pageY,clientX:e[0].clientX,clientY:e[0].clientY}:(v.each(e,function(e){t.push(e.pageX),n.push(e.pageY),i.push(e.clientX),o.push(e.clientY)}),{pageX:(r.apply(Math,t)+a.apply(Math,t))/2,pageY:(r.apply(Math,n)+a.apply(Math,n))/2,clientX:(r.apply(Math,i)+a.apply(Math,i))/2,clientY:(r.apply(Math,o)+a.apply(Math,o))/2})},getVelocity:function(e,t,n){return{x:Math.abs(t/e)||0,y:Math.abs(n/e)||0}},getAngle:function(e,t){var n=t.clientX-e.clientX,i=t.clientY-e.clientY;return 180*Math.atan2(i,n)/Math.PI},getDirection:function(e,t){return Math.abs(e.clientX-t.clientX)>=Math.abs(e.clientY-t.clientY)?e.clientX-t.clientX>0?a:l:e.clientY-t.clientY>0?s:r},getDistance:function(e,t){var n=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(n*n+i*i)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return e.length>=2&&t.length>=2?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},isVertical:function(e){return e==s||e==r},setPrefixedCss:function(e,t,n,i){var o=["","Webkit","Moz","O","ms"];t=v.toCamelCase(t);for(var r=0;r<o.length;r++){var a=t;if(o[r]&&(a=o[r]+a.slice(0,1).toUpperCase()+a.slice(1)),a in e.style){e.style[a]=(null==i||i)&&n||"";break}}},toggleBehavior:function(e,t,n){if(t&&e&&e.style){v.each(t,function(t,i){v.setPrefixedCss(e,i,t,n)});var i=n&&function(){return!1};"none"==t.userSelect&&(e.onselectstart=i),"none"==t.userDrag&&(e.ondragstart=i)}},toCamelCase:function(e){return e.replace(/[_-]([a-z])/g,function(e){return e[1].toUpperCase()})}};i.Instance=function(e,t){var n=this;i.READY||(m.determineEventTypes(),v.each(i.gestures,function(e){C.register(e)}),m.onTouch(i.DOCUMENT,_,C.detect),m.onTouch(i.DOCUMENT,p,C.detect),i.READY=!0),this.element=e,this.enabled=!0,v.each(t,function(e,n){delete t[n],t[v.toCamelCase(n)]=e}),this.options=v.extend(v.extend({},i.defaults),t||{}),this.options.behavior&&v.toggleBehavior(this.element,this.options.behavior,!0),this.eventStartHandler=m.onTouch(e,d,function(e){n.enabled&&e.eventType==d?C.startDetect(n,e):e.eventType==f&&C.detect(e)}),this.eventHandlers=[]},i.Instance.prototype={on:function(e,t){var n=this;return m.on(n.element,e,t,function(e){n.eventHandlers.push({gesture:e,handler:t})}),n},off:function(e,t){var n=this;return m.off(n.element,e,t,function(e){var i=v.inArray({gesture:e,handler:t});!1!==i&&n.eventHandlers.splice(i,1)}),n},trigger:function(e,t){t||(t={});var n=i.DOCUMENT.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t;var o=this.element;return v.hasParent(t.target,o)&&(o=t.target),o.dispatchEvent(n),this},enable:function(e){return this.enabled=e,this},dispose:function(){var e,t;for(v.toggleBehavior(this.element,this.options.behavior,!1),e=-1;t=this.eventHandlers[++e];)v.off(this.element,t.gesture,t.handler);return this.eventHandlers=[],m.off(this.element,o[d],this.eventStartHandler),null}};var m=i.event={preventMouseEvents:!1,started:!1,shouldDetect:!1,on:function(e,t,n,i){var o=t.split(" ");v.each(o,function(t){v.on(e,t,n),i&&i(t)})},off:function(e,t,n,i){var o=t.split(" ");v.each(o,function(t){v.off(e,t,n),i&&i(t)})},onTouch:function(e,t,n){var r=this,a=function(o){var a,s=o.type.toLowerCase(),l=i.HAS_POINTEREVENTS,c=v.inStr(s,"mouse");c&&r.preventMouseEvents||(c&&t==d&&0===o.button?(r.preventMouseEvents=!1,r.shouldDetect=!0):l&&t==d?r.shouldDetect=1===o.buttons||y.matchType(h,o):c||t!=d||(r.preventMouseEvents=!0,r.shouldDetect=!0),l&&t!=p&&y.updatePointer(t,o),r.shouldDetect&&(a=r.doDetect.call(r,o,t,e,n)),a==p&&(r.preventMouseEvents=!1,r.shouldDetect=!1,y.reset()),l&&t==p&&y.updatePointer(t,o))};return this.on(e,o[t],a),a},doDetect:function(e,t,n,i){var o=this.getTouchList(e,t),r=o.length,a=t,s=o.trigger,l=r;t==d?s=f:t==p&&(s=g,l=o.length-(e.changedTouches?e.changedTouches.length:1)),l>0&&this.started&&(a=_),this.started=!0;var c=this.collectEventData(n,a,o,e);return t!=p&&i.call(C,c),s&&(c.changedLength=l,c.eventType=s,i.call(C,c),c.eventType=a,delete c.changedLength),a==p&&(i.call(C,c),this.started=!1),a},determineEventTypes:function(){var e;return e=i.HAS_POINTEREVENTS?t.PointerEvent?["pointerdown","pointermove","pointerup pointercancel lostpointercapture"]:["MSPointerDown","MSPointerMove","MSPointerUp MSPointerCancel MSLostPointerCapture"]:i.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],o[d]=e[0],o[_]=e[1],o[p]=e[2],o},getTouchList:function(e,t){if(i.HAS_POINTEREVENTS)return y.getTouchList();if(e.touches){if(t==_)return e.touches;var n=[],o=[].concat(v.toArray(e.touches),v.toArray(e.changedTouches)),r=[];return v.each(o,function(e){!1===v.inArray(n,e.identifier)&&r.push(e),n.push(e.identifier)}),r}return e.identifier=1,[e]},collectEventData:function(e,t,n,i){var o=h;return v.inStr(i.type,"mouse")||y.matchType(c,i)?o=c:y.matchType(u,i)&&(o=u),{center:v.getCenter(n),timeStamp:Date.now(),target:i.target,touches:n,eventType:t,pointerType:o,srcEvent:i,preventDefault:function(){var e=this.srcEvent;e.preventManipulation&&e.preventManipulation(),e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return C.stopDetect()}}}},y=i.PointerEvent={pointers:{},getTouchList:function(){var e=[];return v.each(this.pointers,function(t){e.push(t)}),e},updatePointer:function(e,t){e==p||e!=p&&1!==t.buttons?delete this.pointers[t.pointerId]:(t.identifier=t.pointerId,this.pointers[t.pointerId]=t)},matchType:function(e,t){if(!t.pointerType)return!1;var n=t.pointerType,i={};return i[c]=n===(t.MSPOINTER_TYPE_MOUSE||c),i[h]=n===(t.MSPOINTER_TYPE_TOUCH||h),i[u]=n===(t.MSPOINTER_TYPE_PEN||u),i[e]},reset:function(){this.pointers={}}},C=i.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(e,t){this.current||(this.stopped=!1,this.current={inst:e,startEvent:v.extend({},t),lastEvent:!1,lastCalcEvent:!1,futureCalcEvent:!1,lastCalcData:{},name:""},this.detect(t))},detect:function(e){if(this.current&&!this.stopped){e=this.extendEventData(e);var t=this.current.inst,n=t.options;return v.each(this.gestures,function(i){!this.stopped&&t.enabled&&n[i.name]&&i.handler.call(i,e,t)},this),this.current&&(this.current.lastEvent=e),e.eventType==p&&this.stopDetect(),e}},stopDetect:function(){this.previous=v.extend({},this.current),this.current=null,this.stopped=!0},getCalculatedData:function(e,t,n,o,r){var a=this.current,s=!1,l=a.lastCalcEvent,c=a.lastCalcData;l&&e.timeStamp-l.timeStamp>i.CALCULATE_INTERVAL&&(t=l.center,n=e.timeStamp-l.timeStamp,o=e.center.clientX-l.center.clientX,r=e.center.clientY-l.center.clientY,s=!0),e.eventType!=f&&e.eventType!=g||(a.futureCalcEvent=e),a.lastCalcEvent&&!s||(c.velocity=v.getVelocity(n,o,r),c.angle=v.getAngle(t,e.center),c.direction=v.getDirection(t,e.center),a.lastCalcEvent=a.futureCalcEvent||e,a.futureCalcEvent=e),e.velocityX=c.velocity.x,e.velocityY=c.velocity.y,e.interimAngle=c.angle,e.interimDirection=c.direction},extendEventData:function(e){var t=this.current,n=t.startEvent,i=t.lastEvent||n;e.eventType!=f&&e.eventType!=g||(n.touches=[],v.each(e.touches,function(e){n.touches.push({clientX:e.clientX,clientY:e.clientY})}));var o=e.timeStamp-n.timeStamp,r=e.center.clientX-n.center.clientX,a=e.center.clientY-n.center.clientY;return this.getCalculatedData(e,i.center,o,r,a),v.extend(e,{startEvent:n,deltaTime:o,deltaX:r,deltaY:a,distance:v.getDistance(n.center,e.center),angle:v.getAngle(n.center,e.center),direction:v.getDirection(n.center,e.center),scale:v.getScale(n.touches,e.touches),rotation:v.getRotation(n.touches,e.touches)}),e},register:function(e){var t=e.defaults||{};return void 0===t[e.name]&&(t[e.name]=!0),v.extend(i.defaults,t,!0),e.index=e.index||1e3,this.gestures.push(e),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),this.gestures}};!function(e){var t=!1;i.gestures.Drag={name:e,index:50,handler:function(n,i){var o=C.current;if(!(i.options.dragMaxTouches>0&&n.touches.length>i.options.dragMaxTouches))switch(n.eventType){case d:t=!1;break;case _:if(n.distance<i.options.dragMinDistance&&o.name!=e)return;var c=o.startEvent.center;if(o.name!=e&&(o.name=e,i.options.dragDistanceCorrection&&n.distance>0)){var h=Math.abs(i.options.dragMinDistance/n.distance);c.pageX+=n.deltaX*h,c.pageY+=n.deltaY*h,c.clientX+=n.deltaX*h,c.clientY+=n.deltaY*h,n=C.extendEventData(n)}(o.lastEvent.dragLockToAxis||i.options.dragLockToAxis&&i.options.dragLockMinDistance<=n.distance)&&(n.dragLockToAxis=!0);var u=o.lastEvent.direction;n.dragLockToAxis&&u!==n.direction&&(v.isVertical(u)?n.direction=n.deltaY<0?s:r:n.direction=n.deltaX<0?a:l),t||(i.trigger(e+"start",n),t=!0),i.trigger(e,n),i.trigger(e+n.direction,n);var f=v.isVertical(n.direction);(i.options.dragBlockVertical&&f||i.options.dragBlockHorizontal&&!f)&&n.preventDefault();break;case g:t&&n.changedLength<=i.options.dragMaxTouches&&(i.trigger(e+"end",n),t=!1);break;case p:t=!1}},defaults:{dragMinDistance:10,dragDistanceCorrection:!0,dragMaxTouches:1,dragBlockHorizontal:!1,dragBlockVertical:!1,dragLockToAxis:!1,dragLockMinDistance:25}}}("drag"),i.gestures.Gesture={name:"gesture",index:1337,handler:function(e,t){t.trigger(this.name,e)}},function(e){var t;i.gestures.Hold={name:e,index:10,defaults:{holdTimeout:500,holdThreshold:2},handler:function(n,i){var o=i.options,r=C.current;switch(n.eventType){case d:clearTimeout(t),r.name=e,t=setTimeout(function(){r&&r.name==e&&i.trigger(e,n)},o.holdTimeout);break;case _:n.distance>o.holdThreshold&&clearTimeout(t);break;case g:clearTimeout(t)}}}}("hold"),i.gestures.Release={name:"release",index:1/0,handler:function(e,t){e.eventType==g&&t.trigger(this.name,e)}},i.gestures.Swipe={name:"swipe",index:40,defaults:{swipeMinTouches:1,swipeMaxTouches:1,swipeVelocityX:.6,swipeVelocityY:.6},handler:function(e,t){if(e.eventType==g){var n=e.touches.length,i=t.options;if(n<i.swipeMinTouches||n>i.swipeMaxTouches)return;(e.velocityX>i.swipeVelocityX||e.velocityY>i.swipeVelocityY)&&(t.trigger(this.name,e),t.trigger(this.name+e.direction,e))}}},function(e){var t=!1;i.gestures.Tap={name:e,index:100,handler:function(n,i){var o,r,a=i.options,s=C.current,l=C.previous;switch(n.eventType){case d:t=!1;break;case _:t=t||n.distance>a.tapMaxDistance;break;case p:!v.inStr(n.srcEvent.type,"cancel")&&n.deltaTime<a.tapMaxTime&&!t&&(o=l&&l.lastEvent&&function(e,t){return c(e)&&c(t)?c(t)-c(e):t.timeStamp-e.timeStamp}(l.lastEvent,n),r=!1,l&&l.name==e&&o&&o<a.doubleTapInterval&&n.distance<a.doubleTapDistance&&(i.trigger("doubletap",n),r=!0),r&&!a.tapAlways||(s.name=e,i.trigger(s.name,n)))}function c(e){return e.srcEvent&&e.srcEvent.timeStamp?e.srcEvent.timeStamp:null}},defaults:{tapMaxTime:250,tapMaxDistance:10,tapAlways:!0,doubleTapDistance:20,doubleTapInterval:300}}}("tap"),i.gestures.Touch={name:"touch",index:-1/0,defaults:{preventDefault:!1,preventMouse:!1},handler:function(e,t){t.options.preventMouse&&e.pointerType==c?e.stopDetect():(t.options.preventDefault&&e.preventDefault(),e.eventType==f&&t.trigger("touch",e))}},function(e){var t=!1;i.gestures.Transform={name:e,index:45,defaults:{transformMinScale:.01,transformMinRotation:1},handler:function(n,i){switch(n.eventType){case d:t=!1;break;case _:if(n.touches.length<2)return;var o=Math.abs(1-n.scale),r=Math.abs(n.rotation);if(o<i.options.transformMinScale&&r<i.options.transformMinRotation)return;C.current.name=e,t||(i.trigger(e+"start",n),t=!0),i.trigger(e,n),r>i.options.transformMinRotation&&i.trigger("rotate",n),o>i.options.transformMinScale&&(i.trigger("pinch",n),i.trigger("pinch"+(n.scale<1?"in":"out"),n));break;case g:t&&n.changedLength<2&&(i.trigger(e+"end",n),t=!1)}}}}("transform"),t.Hammer=i,void 0!==e&&e.exports&&(e.exports=i)}(window)},715:function(e,t,n){"use strict";var i,o=n(370),r=n(709),a=n(710),s=n(711);!function(e){e[e.low=0]="low",e[e.medium=1]="medium",e[e.high=2]="high",e[e.shrinkHighStretchLow=3]="shrinkHighStretchLow"}(i||(i={}));var l=n(537),c=function(){function e(e){this._v=e}return e.prototype.get_postBackOnWorkspaceChanged=function(){return this._v._clientSideOptions$postBackOnWorkspaceChanged},e.prototype.set_postBackOnWorkspaceChanged=function(e){this._v._clientSideOptions$postBackOnWorkspaceChanged=e},e.prototype.get_postBackOnWorkspaceClick=function(){return this._v._clientSideOptions$postBackOnWorkspaceClick},e.prototype.set_postBackOnWorkspaceClick=function(e){this._v._clientSideOptions$postBackOnWorkspaceClick=e},e}(),h=n(423),u=n(368),d=n(712),_={start:function(e){var t=e.checkFunction,n=e.onChange;e.delayMs;return setInterval(function(){t()&&n()},500)},stop:function(e){clearInterval(e)}},p=n(393);n.d(t,"b",function(){return f}),n.d(t,"a",function(){return y});var g=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},f=function(){return function(e){var t=this;function n(e){var n;n=e.touches?e.touches.length>0?e.touches[0]:e.changedTouches[0]:e.pointers.length>0?e.pointers[0]:e.changedPointers[0],t.pageX=n.pageX,t.pageY=n.pageY,t.clientX=n.clientX,t.clientY=n.clientY}t.originalEvent=e,t.type=e.type,t.x=e.x,t.y=e.y,"string"==typeof e.type&&-1!==e.type.indexOf("touch")?n(e):null!=e.gesture?n(e.gesture):e&&function(e){t.pageX=e.pageX,t.pageY=e.pageY,t.clientX=e.clientX,t.clientY=e.clientY}(e)}}(),v=function(){return function(){}}(),m=function(){return function(){}}(),y=function(){function e(e){void 0===e&&(e=null),this._zone=e,this._contentElements=[],this._rulerBorderWidth=1,this._contentCtxLocation=null,this._ignoreDocumentClickOnce=!1,this._documentClickEvent=new o.b,this._clickEvent=new o.b,this._mouseDownEvent=new o.b,this._mouseMoveEvent=new o.b,this._mouseUpEvent=new o.b,this._workspaceDoubleClickEvent=new o.b,this._workspaceClickEvent=new o.b,this._workspaceChangedEvent=new o.b,this._workspaceMouseDownEvent=new o.b,this._workspaceMouseUpEvent=new o.b,this._workspaceMouseMoveEvent=new o.b,this._statusChangedEvent=new o.b,this._pinchStartEvent=new o.b,this._pinchStopEvent=new o.b,this._scrolledEvent=new o.b,this._onresizeEvent=new o.b,this._zoomedEvent=new o.b,this._invokingCallbackRequestEvent=new o.b,this._intervalCheckLoop=_,this._contentAngle=0,this._backColor="#FFFFFF",this._maxZoom=16,this._minZoom=.05,this._screenXDpi=72,this._screenYDpi=72,this._scrollBarsStyle=r.a.auto,this._scrollBarWidth=17,this._scrollingPosition=new u.PointF(0,0),this._viewportAlignment=a.a.leftTop,this._zoom=1,this._zoomMode=s.a.none,this._zoomQuality=i.shrinkHighStretchLow,this._bestFitWhiteSpacePc=0,this._stateFieldId="",this._needUpdateViewport=!1,this._msTouchActionInitialValue="",this._toolTip="",this._accessKey="",this._tabIndex="",this._callbackArgs="",this._callbackContext=0,this._status=l.a.ready,this._exceptionDescription="",this._returnValue="",this._clientSideOptions=new c(this),this._delayedRefreshTimeout=1e3,this._refreshTimer=null,this._contentElements=[],this._needToRefresh=!1,this._rulerEnabled=!1,this._rulerWidth=13,this._rulerScale=1,this._rulerOffsetX=0,this._rulerOffsetY=0,this._rulersOnScrollDelegate=null,this._rulersOnZoomDelegate=null,this._activeAjax=0,this._pinchZoomEnabled=!0,this._holderBounds=null,this._contentCtxDimension={},this._viewportLocation={},this._holderElement=null,this._touchFlags=new m,this._rulers={},this._bodyCursor=null}return e.prototype.get_element=function(){return this._viewerElement},e.prototype.get_id=function(){return this._viewerElement.id},e.prototype.rotateContent=function(e){if(null!=e&&0!==e){this._contentAngle=Object(u.normalizeAngle)(e+this._contentAngle);var t="(0, 0)";90===this._contentAngle?t="(0px, -100%)":180===this._contentAngle?t="(-100%, -100%)":270===this._contentAngle&&(t="(-100%, 0px)"),this._contentCtx.style.transform="rotate("+this._contentAngle+"deg) translate"+t,this._contentCtx.style.transformOrigin="left top",this._updateViewport(),this._canvas.set_zoom(this.zoom,void 0,{force:!0}),this._canvas.updateSelection(),this._canvas.redraw()}},e.prototype.get_contentAngle=function(){return this._contentAngle},e.prototype.get_contentWidth=function(){return this._holderBounds.width},e.prototype.get_width=function(){return this._holderBounds.offsetWidth},e.prototype.get_contentHeight=function(){return this._holderBounds.height},e.prototype.get_height=function(){return this._holderBounds.offsetHeight},e.prototype.notifySizeChanged=function(){this._onResize(null,!1)},e.prototype._renderContent=function(e){return e},e.prototype.get_hasContent=function(){return!0},e.prototype._render=function(){var e="width:"+this.get_contentWidth()+"px;height:"+this.get_contentHeight()+"px;",t="";t+='<div id="cvContent" style="position:absolute; overflow: hidden; box-sizing: content-box; -webkit-box-sizing: content-box; -moz-box-sizing: content-box;',!this.get_hasContent||this.get_hasContent()?t+=e:t+="display:none;";var n=this._getViewportLocation();return t+="left:"+n.x+"px;top:"+n.y+"px",t+='">',t=this._renderContent(t),t+="</div>",t+="</div>"},e.prototype._clearElement=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},e.prototype._rulersOnScroll=function(){this._touchFlags.pinchStarted||this._updateRulersStyle()},e.prototype._rulersOnZoom=function(){this._touchFlags.pinchStarted||(this._drawRulers(),this._updateRulersStyle())},e.prototype._rulersOnMouseMove=function(e,t){if(this.rulerEnabled){var n=this._rulers.topSlideBar,i=this._rulers.leftSlideBar;if(p.a.IsTouchDevice()){if(!p.a.IsTouchIE())return;if(t.originalEvent.pointerType!=t.originalEvent.MSPOINTER_TYPE_MOUSE)return n.style.left="0px",void(i.style.top="0px")}var o=this._getViewportLocation(),r=this._contentCtxLocation,a=-1,s=-1;isNaN(t.pageX)||isNaN(t.pageY)?t.originalEvent&&(t.originalEvent.touches?(a=t.originalEvent.touches[0].pageX,s=t.originalEvent.touches[0].pageY):(a=t.originalEvent.pageX,s=t.originalEvent.pageY)):(a=t.pageX,s=t.pageY);var l=o.x+a-r.left-this._scrollingPosition.x,c=o.y+s-r.top-this._scrollingPosition.y;n.style.left=l+"px",i.style.top=c+"px"}},e.prototype._initializeRulers=function(){var e=this.get_element().parentNode,t=e.ownerDocument,n="z-index: 2; -webkit-transform: translate3d(0px, 0px, 0px); -moz-transform: translate3d(0px, 0px, 0px)",i=t.createElement("div");i.setAttribute("style",n);var o=t.createElement("div"),r=t.createElement("div");r.setAttribute("style",n);var a=t.createElement("div"),s=t.createElement("div");s.style.zIndex="2";var l=t.createElement("div"),c=t.createElement("div");this._rulers.topRuller=i,this._rulers.leftRuller=r,this._rulers.fullTopRuller=o,this._rulers.fullLeftRuller=a,this._rulers.whiteRect=s,this._rulers.topSlideBar=l,this._rulers.leftSlideBar=c;var u=this.get_element().id;i.id=u+"_TopRuler",o.id=u+"_FullTopRuler",r.id=u+"_LeftRuler",a.id=u+"_FullLeftRuler",s.id=u+"_WhiteRect",l.id=u+"_TopSlideBar",c.id=u+"_LeftSlideBar",o=i.appendChild(o),a=r.appendChild(a),l=i.appendChild(l),c=r.appendChild(c),i=e.appendChild(i),r=e.appendChild(r),s=e.appendChild(s),i.style.position=o.style.position=r.style.position=a.style.position=s.style.position=l.style.position=c.style.position="absolute",c.style.width=l.style.height=this.rulerWidth+"px",c.style.height=l.style.width="1px",c.style.backgroundColor=l.style.backgroundColor="#ff0000",c.style.overflow=l.style.overflow="hidden",c.style.webkitTransform=l.style.webkitTransform="translate3d(0, 0, 0)",i.style.overflow=r.style.overflow=s.style.overflow="hidden",i.style.visibility=r.style.visibility=s.style.visibility="hidden",s.style.backgroundColor="#909090",e.style.position="relative",this._drawRulers(),this._updateRulersStyle(),this._rulersOnScrollDelegate||(this._rulersOnScrollDelegate=this._rulersOnScroll.bind(this),this.add_scrolled(this._rulersOnScrollDelegate)),this._rulersOnZoomDelegate||(this._rulersOnZoomDelegate=this._rulersOnZoom.bind(this),this.add_zoomed(this._rulersOnZoomDelegate)),this.add_mouseMove(h.c.createBoundedWrapper(this,this._rulersOnMouseMove))},e.prototype._disposeRulers=function(){this._rulersOnScrollDelegate&&(this.remove_scrolled(this._rulersOnScrollDelegate),this._rulersOnScrollDelegate=null),this._rulersOnZoomDelegate&&(this.remove_zoomed(this._rulersOnZoomDelegate),this._rulersOnZoomDelegate=null)},e.prototype._updateRulersStyle=function(){var e=this._rulers.leftRuller,t=this._rulers.topRuller,n=this._rulers.fullLeftRuller,i=this._rulers.fullTopRuller,o=this._rulers.whiteRect,a=this.get_width(),s=this.get_height(),l=this.get_contentWidth(),c=this.get_contentHeight(),h=this.get_scrollBarWidth(),u=e.style,d=t.style,_=i.style,p=n.style,g=o.style;if(this._rulerEnabled){u.visibility=d.visibility=g.visibility="inherit",u.backgroundColor=d.backgroundColor="#ffffff",u.borderRight=d.borderBottom=this._rulerBorderWidth+"px solid black";var f=this.get_scrollBarsStyle()==r.a.always,v=this.get_scrollBarsStyle()==r.a.auto,m=f||v&&c>s-this.rulerWidth,y=f||v&&l>a-this.rulerWidth;m=m||y&&v&&c>s-this.rulerWidth-h,y=y||m&&v&&l>a-this.rulerWidth-h;var C=m?a-h:a,b=y?s-h:s;d.width=C+"px",u.height=b+"px",_.height=d.height=o.style.height=this._rulerWidth+"px",p.width=u.width=o.style.width=this._rulerWidth+"px",d.top=u.top=d.left=u.left=o.style.top=o.style.left="0px";var E=this.get_scrollingPosition();_.left=-E.x+"px",p.top=-E.y+"px"}else d.width=d.height=u.width=u.height=d.borderWidth=u.borderWidth=g.width=g.height="0px",u.visibility=d.visibility=g.visibility="hidden"},e.prototype._drawRulers=function(){if(this._rulerEnabled)for(var e=this.get_element().parentNode.ownerDocument,t=this._rulers.fullLeftRuller,n=this._rulers.fullTopRuller,i=[{controlLength:this.get_width(),contentLength:this.get_contentWidth(),viewportLocation:this._getViewportLocation().x,factor:this.zoom*this.get_actualSizeHorizontalScale(),ruler:n,startWorkspaceLocation:null,endWorkspaceLocation:null,rulerPixelLength:null,origin:null},{controlLength:this.get_height(),contentLength:this.get_contentHeight(),viewportLocation:this._getViewportLocation().y,factor:this.zoom*this.get_actualSizeHorizontalScale(),ruler:t,startWorkspaceLocation:null,endWorkspaceLocation:null,rulerPixelLength:null,origin:null}],o=[this.rulerOffsetX,this.rulerOffsetY],a=this.get_scrollBarWidth(),s=this.get_scrollBarsStyle()==r.a.always,l=this.get_scrollBarsStyle()==r.a.auto,c=this.rulerScale,h=0;h<i.length;h++){i[h].origin=i[h].viewportLocation+o[h]*i[h].factor;var u=s||l&&i[1-h].contentLength>i[1-h].controlLength-this.rulerWidth,d=s||l&&i[h].contentLength>i[h].controlLength-this.rulerWidth;u=u||d&&l&&i[1-h].contentLength>i[1-h].controlLength-this.rulerWidth-a,d=d||u&&l&&i[h].contentLength>i[h].controlLength-this.rulerWidth-a,i[h].rulerPixelLength=d?Math.max(i[h].contentLength+this.rulerWidth,i[h].controlLength-(u?a:0)):u?i[h].controlLength-a:i[h].controlLength,i[h].startWorkspaceLocation=-i[h].origin,i[h].endWorkspaceLocation=i[h].startWorkspaceLocation+i[h].rulerPixelLength,i[h].startWorkspaceLocation/=i[h].factor,i[h].endWorkspaceLocation/=i[h].factor,i[h].startWorkspaceLocation*=c,i[h].endWorkspaceLocation*=c;for(var _=1,p=80/i[h].factor*c,g=1;p>10;)p/=10,g*=10;p>5?(g*=5,_=5):p>2&&(g*=2,_=2);for(var f=[{location:0,index:0}],v=0;v<i[h].endWorkspaceLocation;)v+=g,f.push({location:v,index:0});for(v=0;v>i[h].startWorkspaceLocation;)v-=g,f.push({location:v,index:0});for(this._clearElement(i[h].ruler),b=0;b<f.length;b++){var m=e.createElement("span"),y=Math.abs(Math.round(f[b].location)).toString();m.innerHTML=1==h?y.split("").join("<br/>"):y,m.style.position="absolute",m.style.fontSize="9px",m.style.margin="0px",m.style.padding="0px",m.style.fontFamily="Tahoma, Verdana, Arial;",m.style.backgroundColor="#ffffff";var C=Math.round(f[b].location*i[h].factor/c+i[h].origin);m.style.top=0==h?"-1px":C+2+"px",m.style.left=1==h?"2px":C+2+"px",i[h].ruler.appendChild(m)}for(var b,E=1,w={1:{newDiv:5,fractions:2},2:{newDiv:1,fractions:2},5:{newDiv:1,fractions:5}},D=w[_],P=g/D.fractions;P*i[h].factor/c>4;){for(var M=f.length-1;M>=0;){for(var I=0;I<D.fractions-1;I++)f.push({index:E,location:f[M].location+P*(I+1)});M--}E++,P/=(D=w[D.newDiv]).fractions}for(b=0;b<f.length;b++){var T=e.createElement("div");T.style.position="absolute",T.style.overflow="hidden",T.style.backgroundColor="#000000",T.style.padding="0px",T.style.margin="0px";C=Math.round(f[b].location*i[h].factor/c+i[h].origin);var x=this.rulerWidth,S=Math.max(Math.ceil(x/Math.pow(2,f[b].index)),2);T.style.width=0==h?"1px":S+"px",T.style.height=1==h?"1px":S+"px",T.style.top=0==h?x-S+"px":C+"px",T.style.left=1==h?x-S+"px":C+"px",T.style.webkitTransform="translate3d(0, 0, 0)",i[h].ruler.appendChild(T)}}},e.prototype._generateCssWithPrefixes=function(e,t){var n={};for(var i in e)n[e[i]+"transition"]=t;return n},e.prototype._getPageZoom=function(){return screen.deviceXDPI/screen.logicalXDPI},e.prototype._getActualScrollPosition=function(){var e=this.get_element(),t=e.scrollLeft,n=e.scrollTop;return new u.PointF(t,n)},e.prototype._getViewportLocation=function(){var e,t,n=this.rulerEnabled?this.rulerWidth:0,i=this._holderBounds,o=i.width-n,r=i.height-n,s=90===this._contentAngle||270===this._contentAngle,l=s?this.get_contentHeight():this.get_contentWidth(),c=s?this.get_contentWidth():this.get_contentHeight();switch(this._viewportAlignment){case a.a.centerBottom:case a.a.centerCenter:case a.a.centerTop:e=Math.floor((o-l)/2);break;case a.a.leftBottom:case a.a.leftCenter:case a.a.leftTop:e=0;break;case a.a.rightBottom:case a.a.rightCenter:case a.a.rightTop:e=o-l}switch(this._viewportAlignment){case a.a.centerCenter:case a.a.leftCenter:case a.a.rightCenter:t=Math.floor((r-c)/2);break;case a.a.centerTop:case a.a.leftTop:case a.a.rightTop:t=0;break;case a.a.centerBottom:case a.a.leftBottom:case a.a.rightBottom:t=r-c}return new u.PointF(Math.max(n,e+n),Math.max(n,t+n))},e.prototype.ignoreDocumentClickOnce=function(){this._ignoreDocumentClickOnce=!0},e.prototype._onDocumentClick=function(e){!0!==this._ignoreDocumentClickOnce?this._documentClickEvent.notify(this,e):this._ignoreDocumentClickOnce=!1},e.prototype._onClick=function(e){this._clickEvent.notify(this,e)},e.prototype._onMouseDown=function(e){this._mouseDownEvent.notify(this,e)},e.prototype._onMouseMove=function(e){this._mouseMoveEvent.notify(this,e)},e.prototype._onMouseUp=function(e){this._mouseUpEvent.notify(this,e)},e.prototype._useWorkspaceCoords=function(e){var t=new f(e),n=this.pageToWorkspacePoint(t.pageX,t.pageY);return t.x=n.x,t.y=n.y,t},e.prototype._onWorkspaceDoubleClick=function(e){var t=this._useWorkspaceCoords(e),n={x:t.x,y:t.y};this._workspaceDoubleClickEvent.notify(this,n)},e.prototype._onWorkspaceClick=function(e){var t=this._useWorkspaceCoords(e),n={x:t.x,y:t.y};this._workspaceClickEvent.notify(this,n)},e.prototype._onWorkspaceMouseDown=function(e){if(!this._isManyTouches(e)){var t=this._useWorkspaceCoords(e);this._workspaceMouseDownEvent.notify(this,t),p.a.IsTouchIE()||this._contentCtx.setCapture()}},e.prototype._onWorkspaceMouseUp=function(e){if(!this._isManyTouches(e)){var t=this._useWorkspaceCoords(e);this._workspaceMouseUpEvent.notify(this,t),this._contentCtx.releaseCapture()}},e.prototype._onWorkspaceMouseMove=function(e){if(this._isManyTouches(e))e.preventDefault();else{var t=this._useWorkspaceCoords(e);this._workspaceMouseMoveEvent.notify(this,t)}},e.prototype._makeInactive=function(e){e.ondrag=function(){return!1},e.unselectable="on"},e.prototype._makeInactiveAll=function(){for(var e=this._contentElements,t=0;t<e.length;t++)this._makeInactive(e[t])},e.prototype._resizeContentElements=function(){for(var e=this.get_contentWidth(),t=this.get_contentHeight(),n=this._contentElements,i=0;i<n.length;i++)n[i].style.width=e+"px",n[i].style.height=t+"px","IMG"==n[i].tagName&&(n[i].width=e,n[i].height=t);this._contentCtxDimension.width=e,this._contentCtxDimension.height=t,this._contentCtxLocation=this._getElementPageCoord(this._contentCtx),this._holderBounds=this._getElementBounds(this.get_element())},e.prototype._getElementBounds=function(e){for(var t=[];e.length>0&&e!=document;)"none"==e.style.display&&(t.push({element:e,display:e.style.display,visibility:e.style.visibility}),e.style.visibility="hidden",e.style.display="block"),e=e.parent();for(var n=e.clientWidth,i=e.clientHeight,o=e.offsetHeight,r=e.offsetWidth,a=e.offsetTop,s=e.offsetLeft,l=0;l<t.length;l++){var c=t[l];c.element[0].style.visibility=c.visibility,c.element[0].style.display=c.display}return{width:n,height:i,offsetWidth:r,offsetHeight:o,offsetTop:a,offsetLeft:s}},e.prototype._isManyTouches=function(e){if(p.a.IsTouchDevice()){var t=e.originalEvent||e;if(window.navigator.pointerEnabled){if(this._touchFlags.multiTouch||!1!==t.isPrimary||(this._touchFlags.multiTouch=!0),this._touchFlags.multiTouch)return!0}else if("object"==typeof t.touches&&null!==t.touches&&"number"==typeof t.touches.length&&t.touches.length>1)return!0}return!1},e.prototype._onTouch=function(e){this._touchFlags.startZoom=this.zoom,this._touchFlags.multiTouch=e.gesture.touches.length>1},e.prototype._onPinch=function(e,t){if(e.gesture.preventDefault(),e.preventDefault(),this._touchFlags.multiTouch=e.gesture.touches.length>1,this._touchFlags.pinchStarted||(this._touchFlags.pinchStarted=!0,this._pinchStartEvent.notify(this)),this.pinchZoomEnabled){var n=this._touchFlags.startZoom*e.gesture.scale,i=new v;t?i.skipZoomToCenter=!0:(i.centerPageX=e.gesture.center.pageX,i.centerPageY=e.gesture.center.pageY),this.setZoom(n,i)}},e.prototype._onRelease=function(e){this._touchFlags.multiTouch=!1,this._touchFlags.pinchStarted&&(this._touchFlags.pinchStarted=!1,this._pinchStopEvent.notify(this))},e.prototype.initialize=function(e){var t=this;void 0===e&&(e=null),null!=e&&(this._intervalCheckLoop=e);var n=document.createElement("style");n.id="aurigmaStyles",n.type="text/css",n.innerHTML=".aurigmaNoSelect {-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}",document.getElementsByTagName("head")[0].appendChild(n);var i=this.get_element();this._holderBounds=this._getElementBounds(i),this._holderElement=i,i.innerHTML=this._render(),this._makeInactive(i);var o=i.querySelectorAll("#cvContent");this._contentElements.push(this._contentCtx=o[0]),this._addSetCapture(i);var r=this._scrollingPosition;this._scrollInitialized=!0,i.scrollLeft=r.x,i.scrollTop=r.y,this._initializeRulers();var a=this._get_pointerEvents();p.a.IsTouchDevice()&&(d(this._holderElement).on("touch",h.c.createBoundedWrapper(this,this._onTouch)).on("pinch",h.c.createBoundedWrapper(this,this._onPinch)).on("release",h.c.createBoundedWrapper(this,this._onRelease)),window.navigator.pointerEnabled&&(this._holderElement.style.touchAction=this._msTouchActionInitialValue)),document.addEventListener("click",h.c.createBoundedWrapper(this,this._onDocumentClick)),this._holderElement.addEventListener("contextmenu",function(e){e.preventDefault()}),this._holderElement.addEventListener("click",h.c.createBoundedWrapper(this,this._onClick)),this._holderElement.addEventListener("scroll",h.c.createBoundedWrapper(this,this._onScroll)),this._contentCtx.addEventListener("click",h.c.createBoundedWrapper(this,this._onWorkspaceClick)),a.start.split(" ").forEach(function(e){t._holderElement.addEventListener(e,h.c.createBoundedWrapper(t,t._onMouseDown)),t._contentCtx.addEventListener(e,h.c.createBoundedWrapper(t,t._onWorkspaceMouseDown))}),a.move.split(" ").forEach(function(e){t._holderElement.addEventListener(e,h.c.createBoundedWrapper(t,t._onMouseMove)),t._contentCtx.addEventListener(e,h.c.createBoundedWrapper(t,t._onWorkspaceMouseMove))}),a.up.split(" ").forEach(function(e){t._holderElement.addEventListener(e,h.c.createBoundedWrapper(t,t._onMouseUp)),t._contentCtx.addEventListener(e,h.c.createBoundedWrapper(t,t._onWorkspaceMouseUp))}),a.cancel.split(" ").forEach(function(e){t._holderElement.addEventListener(e,h.c.createBoundedWrapper(t,t._onMouseUp)),t._contentCtx.addEventListener(e,h.c.createBoundedWrapper(t,t._onWorkspaceMouseUp))}),d(this._contentCtx).on("doubletap",this._onWorkspaceDoubleClick.bind(this)),this._contentCtxDimension={width:this.get_contentWidth(),height:this.get_contentHeight()},this._contentCtxLocation=this._getElementPageCoord(this._contentCtx),this._updateViewport(),this._updateViewportAlignment(),this._updateRulersStyle(),this.add_pinchStart(h.c.createBoundedWrapper(this,function(){this._rulers.topRuller.style.opacity=this._rulers.leftRuller.style.opacity=.1})),this.add_pinchStop(h.c.createBoundedWrapper(this,function(){this._rulersOnZoom(),this._rulers.topRuller.style.opacity=this._rulers.leftRuller.style.opacity=1})),this._startIntervalCheckLoop()},e.prototype._startIntervalCheckLoop=function(){var e=this;this._intervalCheckLoop.start({checkFunction:function(){var t=e._getElementBounds(e.get_element());return e._contentCtxLocation=e._getElementPageCoord(e._contentCtx),t.width>0&&t.width!==e._holderBounds.width||t.height>0&&t.height!==e._holderBounds.height},onChange:function(){var t=e._getElementBounds(e.get_element());e._holderBounds=t,e._onResize(e,!1)}})},e.prototype.setIntervalCheckLoop=function(e){null!=e&&(this._intervalCheckLoop=e,this._startIntervalCheckLoop())},e.prototype._get_pointerEvents=function(){var e="mousedown",t="mousemove",n="mouseup",i="";return p.a.IsTouchDevice()&&(window.navigator.pointerEnabled?(e="pointerdown",t="pointermove",n="pointerup",i="pointerCancel"):(e="mousedown touchstart",t="mousemove touchmove",n="mouseup touchend",i="touchcancel")),{start:e,move:t,up:n,cancel:i}},e.prototype._onScroll=function(e){this._scrollInitialized?this._scrollInitialized=!1:(this._scrollingPosition=this._getActualScrollPosition(),this._contentCtxLocation=this._getElementPageCoord(this._contentCtx),this._scrolledEvent.notify(this))},e.prototype._onResize=function(e,t){this._updateViewport(),this._updateViewportAlignment(),this._updateRulersStyle(),this._scrollingPosition=this._getActualScrollPosition(),this._onresizeEvent.notify(this),this._contentCtxLocation=this._getElementPageCoord(this._contentCtx)},e.prototype._updateViewport=function(){if(!this.get_hasContent||this.get_hasContent()){var e=this.zoomMode,t=this.calculateZoomByZoomMode(e);if(!(t<0)){this._zoom=Math.min(Math.max(t,this.get_minZoom()),this.get_maxZoom()),this._resizeContentElements();var n=this._getViewportLocation();this._contentCtx.style.left=n.x+"px",this._contentCtx.style.top=n.y+"px",this._viewportLocation=n,this._zoomedEvent.notify(this)}}},e.prototype._addSetCapture=function(e){if(HTMLElement){var t=HTMLElement.prototype,n=["click","mousedown","mouseup","mousemove","mouseover","mouseout"],i=null;t.setCapture=function(){var e,t;document.querySelector("body").classList.add("aurigmaNoSelect"),i=this;try{for(var o=g(n),a=o.next();!a.done;a=o.next()){var s=a.value;window.addEventListener(s,r,!0)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}};var o=t.releaseCapture;t.releaseCapture=function(){var e,t;document.querySelector("body").classList.remove("aurigmaNoSelect"),null!=o&&o.call(this);try{for(var a=g(n),s=a.next();!s.done;s=a.next()){var l=s.value;window.removeEventListener(l,r,!0)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}i=null};var r=function(e){window.removeEventListener(e.type,r,!0),null!=i&&i.dispatchEvent(a(e)),window.addEventListener(e.type,r,!0)},a=function(e){var t;document.createEvent?(t=document.createEvent("MouseEvent")).initMouseEvent(e.type,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget):t=new MouseEvent(e.type,e);var n=e.buttons;return t.buttons!==n&&Object.defineProperty(t,"buttons",{get:function(){return n}}),t}}},e.prototype._getElementPageCoord=function(e){var t=e.getBoundingClientRect();return{left:t.left,top:t.top}},e.prototype._zoomToPagePoint=function(e,t,n){var i=this.pageToControlPoint(t,n),o=this.pageToWorkspacePoint(t,n,!0);this._setZoom(e);var r=this.workspaceToContentPoint(o),a=this.rulerEnabled?this._rulerWidth:0,s=new u.PointF(Math.round(r.x-i.x+a),Math.round(r.y-i.y+a));this.set_scrollingPosition(s)},e.prototype._updateViewportAlignment=function(){var e=this._getViewportLocation();this._contentCtx.style.left=e.x+"px",this._contentCtx.style.top=e.y+"px"},e.prototype.get_scrollingSize=function(){var e=this.get_element(),t=e.scrollWidth-e.clientWidth,n=e.scrollHeight-e.clientHeight;return t<0&&(t=0),n<0&&(n=0),new u.PointF(Math.round(t),Math.round(n))},e.prototype.get_contentCtx=function(){return this._contentCtx},e.prototype.get_clientSideOptions=function(){return this._clientSideOptions},Object.defineProperty(e.prototype,"zoomConfig",{get:function(){return console.log("not implemented"),null},enumerable:!0,configurable:!0}),e.prototype.set_cursor=function(e,t){if(void 0===t&&(t=!1),this._get_elementForCursor().style.cursor=h.c.cursorToCss(e),null!=window){if((e=!0===t?e:h.a.defaultCursor)===this._bodyCursor)return;window.document.querySelector("body").style.cursor=h.c.cursorToCss(e),this._bodyCursor=e}},e.prototype._get_elementForCursor=function(){return this._contentCtx},e.prototype.get_delayedRefreshTimeout=function(){return this._delayedRefreshTimeout},e.prototype.set_delayedRefreshTimeout=function(e){this._delayedRefreshTimeout=e},e.prototype.get_maxZoom=function(){return this._maxZoom>0?this._maxZoom:2.5},e.prototype.set_maxZoom=function(e){this._maxZoom=e,this.zoom>this.get_maxZoom()&&this.setZoom(this.get_maxZoom(),null)},e.prototype.get_minZoom=function(){return this.zoomConfig?this.zoomConfig.min:this._minZoom>0?this._minZoom:.001},e.prototype.set_minZoom=function(e){this._minZoom=e,this.zoom<this.get_minZoom()&&this.setZoom(this.get_minZoom(),null)},e.prototype.set_screenXDpi=function(e){this._screenXDpi=e},e.prototype.get_screenXDpi=function(){return this._screenXDpi},e.prototype.set_screenYDpi=function(e){this._screenYDpi=e},e.prototype.get_screenYDpi=function(){return this._screenYDpi},e.prototype.get_scrollBarsStyle=function(){return this._scrollBarsStyle},e.prototype.set_scrollBarsStyle=function(e){this._scrollBarsStyle=e},e.prototype.get_scrollBarWidth=function(){if(null==this._actualScrollbarWidth){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.overflow="scroll",document.body.appendChild(e);var t=document.createElement("div");t.style.width="100%",e.appendChild(t),this._actualScrollbarWidth=100-t.offsetWidth,e.remove()}return this._actualScrollbarWidth},e.prototype.get_scrollingPosition=function(){return this._scrollingPosition=this._getActualScrollPosition(),this._scrollingPosition.round()},e.prototype.set_scrollingPosition=function(e){var t=this.get_element();t.scrollLeft=e.x,t.scrollTop=e.y;var n=this.get_scrollingPosition();this._scrollingPosition=new u.PointF(n.x,n.y),this._scrolledEvent.notify(this)},e.prototype.get_viewportAlignment=function(){return this._viewportAlignment},e.prototype.set_viewportAlignment=function(e){this._viewportAlignment=e,this._updateViewportAlignment(),this._drawRulers(),this._updateRulersStyle()},Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),e.prototype.setZoom=function(e,t){var n,i;if(t){if(t.skipZoomToCenter)return this._setZoom(e),this._zoom;n=t.centerPageX,i=t.centerPageY}else{var o=this._getElementPageCoord(this.get_element()),r=this.rulerEnabled?this._rulerWidth:0,a=this._holderBounds.width-r,s=this._holderBounds.height-r;n=Math.round(o.left+r+a/2),i=Math.round(o.top+r+s/2)}return this._zoomToPagePoint(e,n,i),this._zoom},e.prototype._setZoom=function(e){this._zoom==e&&this._zoomMode==s.a.none||(this._zoom=Math.min(Math.max(e,this.get_minZoom()),this.get_maxZoom()),this._zoomMode=s.a.none,this._updateViewport())},Object.defineProperty(e.prototype,"pinchZoomEnabled",{get:function(){return this._pinchZoomEnabled},set:function(e){this._pinchZoomEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rulerEnabled",{get:function(){return this._rulerEnabled},set:function(e){var t=e?"block":"none";this._rulers.fullLeftRuller.style.display=t,this._rulers.fullTopRuller.style.display=t,this._rulers.leftRuller.style.display=t,this._rulers.topRuller.style.display=t,this._rulers.whiteRect.style.display=t,this._rulerEnabled=e,this.zoomMode=this.zoomMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rulerScale",{get:function(){return this._rulerScale},set:function(e){if(e<=0)throw new Error("Ruler scale should be greater 0.");this._rulerScale=e,this._updateViewport()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rulerOffsetX",{get:function(){return this._rulerOffsetX},set:function(e){this._rulerOffsetX=e,this._updateViewport()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rulerOffsetY",{get:function(){return this._rulerOffsetY},set:function(e){this._rulerOffsetY=e,this._updateViewport()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rulerWidth",{get:function(){return this._rulerWidth},set:function(e){this._rulerWidth=e,this._updateViewport()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomMode",{get:function(){return this._zoomMode},set:function(e){this._setZoomMode(e)},enumerable:!0,configurable:!0}),e.prototype._setZoomMode=function(e){this._zoomMode=e,this._updateViewport()},e.prototype.get_bestFitWhiteSpacePc=function(){return 100*this._bestFitWhiteSpacePc},e.prototype.set_bestFitWhiteSpacePc=function(e){"number"==typeof e&&!isNaN(e)&&e>=0&&e<99&&(this._bestFitWhiteSpacePc=e/100),this.zoomMode=this.zoomMode},e.prototype.get_zoomQuality=function(){return this._zoomQuality},e.prototype.get_status=function(){return this._status},e.prototype.get_exceptionDescription=function(){return this._exceptionDescription},e.prototype.get_returnValue=function(){return this._returnValue},e.prototype.get_workspaceWidth=function(){throw new Error("Not implemented")},e.prototype.get_workspaceHeight=function(){throw new Error("Not implemented")},e.prototype.get_actualSizeHorizontalScale=function(){throw new Error("Not implemented")},e.prototype.calculateZoomByZoomMode=function(e){var t=this.get_workspaceWidth()*this.get_screenXDpi()/72,n=this.get_workspaceHeight()*this.get_screenYDpi()/72,i=this.rulerEnabled?this.rulerWidth+this._rulerBorderWidth:0,o=this._holderBounds,a=o.offsetWidth-i,l=o.offsetHeight-i,c=90===this._contentAngle||270===this._contentAngle,h=c?n:t,u=c?t:n,d=a/h,_=l/u,p=this.get_scrollBarWidth(),g=(a-p)/h,f=(l-p)/u,v=this._scrollBarsStyle===r.a.always,m=this.zoom;switch(e){case s.a.bestFit:this._bestFitWhiteSpacePc>0&&(d=(a-a*this._bestFitWhiteSpacePc)/h,_=(l-l*this._bestFitWhiteSpacePc)/u,g=(a-p-(a-p)*this._bestFitWhiteSpacePc)/h,f=(l-p-(l-p)*this._bestFitWhiteSpacePc)/u),m=v?Math.min(g,f):Math.min(d,_);break;case s.a.bestFitShrinkOnly:m=v?Math.min(g,f):Math.min(d,_),m=Math.min(1,m);break;case s.a.fitToHeight:m=v?f:Math.round(_*h)<=a?_:f;break;case s.a.fitToHeightShrinkOnly:m=v?Math.min(1,f):Math.round(Math.min(1,_)*h)<=a?Math.min(1,_):Math.min(1,f);break;case s.a.fitToWidth:m=v?g:Math.round(d*u)<=l?d:g;break;case s.a.fitToWidthShrinkOnly:m=v?Math.min(1,g):Math.round(Math.min(1,d)*u)<=l?Math.min(1,d):Math.min(1,g)}return m},e.prototype.clearRenderCtx=function(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])},e.prototype.workspaceToContentPoint=function(e){return this.controlToContentPoint(this.workspaceToControlPoint(e))},e.prototype.controlToContentPoint=function(e){var t=this._getViewportLocation(),n=this._getActualScrollPosition(),i=new u.PointF(0,0),o=e.x,r=e.y;return i.x=o-t.x+n.x,i.y=r-t.y+n.y,i.round()},e.prototype.controlToPagePoint=function(e){var t=this._getElementPageCoord(this.get_element()),n=e.x,i=e.y,o=n+t.left,r=i+t.top;return new u.PointF(Math.round(o),Math.round(r))},e.prototype.contentToControlPoint=function(e){var t=this._getViewportLocation(),n=this._getActualScrollPosition(),i=new u.PointF(0,0);return i.x=e.x+t.x-n.x,i.y=e.y+t.y-n.y,i.round()},e.prototype.controlToContentRectangle=function(e){var t=new u.PointF(e.x,e.y),n=new u.PointF(e.x+e.width,e.y+e.height);return t=this.controlToContentPoint(t),n=this.controlToContentPoint(n),new h.b(t.x,t.y,n.x-t.x,n.y-t.y)},e.prototype.contentToControlRectangle=function(e){var t=new u.PointF(e.x,e.y),n=new u.PointF(e.x+e.width,e.y+e.height);return t=this.contentToControlPoint(t),n=this.contentToControlPoint(n),new h.b(t.x,t.y,n.x-t.x,n.y-t.y)},e.prototype.workspaceToControlPoint=function(e){var t=this.zoom,n=e.x,i=e.y,o=new u.PointF(Math.round(n*t*this._screenXDpi/72),Math.round(i*t*this._screenYDpi/72));return this.contentToControlPoint(o).round()},e.prototype.controlToWorkspacePoint=function(e){var t=this.zoom,n=this.controlToContentPoint(e);return new u.PointF(n.x/(t*this._screenXDpi/72),n.y/(t*this._screenYDpi/72)).round()},e.prototype.workspaceToControlRectangle=function(e){var t=this.zoom,n=this._screenXDpi/72*t,i=this._screenYDpi/72*t,o=new h.b(Math.round(e.x*n),Math.round(e.y*i),Math.round(e.width*n),Math.round(e.height*i));return this.contentToControlRectangle(o)},e.prototype.pageToControlPoint=function(e,t){var n=this._getElementPageCoord(this.get_element()),i=e-n.left,o=t-n.top;return new u.PointF(Math.round(i),Math.round(o))},e.prototype.pageToWorkspacePoint=function(e,t,n){void 0===n&&(n=!1);var i=this.controlToWorkspacePoint(this.pageToControlPoint(e,t)),o=new u.PointF(i.x,i.y),r=this.get_contentAngle();return r>0&&!0!==n&&(o.rotate(-r),90===r?o.translate(0,this._canvas.get_workspaceHeight()):180===r?o.translate(this._canvas.get_workspaceWidth(),this._canvas.get_workspaceHeight()):270===r&&o.translate(this._canvas.get_workspaceWidth(),0)),new u.PointF(o.x,o.y)},e.prototype.controlToWorkspaceRectangle=function(e){var t=this.zoom,n=1/(t*this._screenXDpi/72),i=1/(t*this._screenYDpi/72),o=this.controlToContentRectangle(e);return new h.b(o.x*n,o.y*i,o.width*n,o.height*i)},e.prototype.abort=function(){this._status==l.a.busy&&(this._callbackContext++,this._exceptionDescription="",this._status=l.a.ready)},e.prototype.dispose=function(){this._disposeRulers()},e.prototype.delayedRefresh=function(){this._refreshTimer&&window.clearTimeout(this._refreshTimer);var e=h.c.createBoundedWrapper(this,function(){this._refreshTimer=null,this.refresh()});this._refreshTimer=window.setTimeout(e,this._delayedRefreshTimeout)},e.prototype._refresh=function(){},e.prototype.refresh=function(){this._status==l.a.busy?this._needToRefresh=!0:(this._needToRefresh=!1,this._refresh())},e.prototype._raiseInvokingCallbackRequest=function(){this._invokingCallbackRequestEvent.notify(this)},e.prototype.add_onResize=function(e){this._onresizeEvent.add(e)},e.prototype.remove_onResize=function(e){this._onresizeEvent.remove(e)},e.prototype.add_invokingCallbackRequest=function(e){this._invokingCallbackRequestEvent.add(e)},e.prototype.remove_invokingCallbackRequest=function(e){this._invokingCallbackRequestEvent.remove(e)},e.prototype.add_workspaceChanged=function(e){this._workspaceChangedEvent.add(e)},e.prototype.remove_workspaceChanged=function(e){this._workspaceChangedEvent.remove(e)},e.prototype.add_scrolled=function(e){this._scrolledEvent.add(e)},e.prototype.remove_scrolled=function(e){this._scrolledEvent.remove(e)},e.prototype.add_statusChanged=function(e){this._statusChangedEvent.add(e)},e.prototype.remove_statusChanged=function(e){this._statusChangedEvent.remove(e)},e.prototype.add_pinchStart=function(e){this._pinchStartEvent.add(e)},e.prototype.remove_pinchStart=function(e){this._pinchStartEvent.remove(e)},e.prototype.add_pinchStop=function(e){this._pinchStopEvent.add(e)},e.prototype.remove_pinchStop=function(e){this._pinchStopEvent.remove(e)},e.prototype.add_zoomed=function(e){this._zoomedEvent.add(e)},e.prototype.remove_zoomed=function(e){this._zoomedEvent.remove(e)},e.prototype.add_click=function(e){this._clickEvent.add(e)},e.prototype.remove_click=function(e){this._clickEvent.remove(e)},e.prototype.add_mouseDown=function(e){this._mouseDownEvent.add(e)},e.prototype.remove_mouseDown=function(e,t){this._mouseDownEvent.remove(e)},e.prototype.add_mouseMove=function(e){this._mouseMoveEvent.add(e)},e.prototype.remove_mouseMove=function(e){this._mouseMoveEvent.remove(e)},e.prototype.add_mouseUp=function(e){this._mouseUpEvent.add(e)},e.prototype.remove_mouseUp=function(e){this._mouseUpEvent.remove(e)},e.prototype.add_workspaceClick=function(e){this._workspaceClickEvent.add(e)},e.prototype.remove_workspaceClick=function(e){this._workspaceClickEvent.remove(e)},e.prototype.add_workspaceDoubleClick=function(e){this._workspaceDoubleClickEvent.add(e)},e.prototype.remove_workspaceDoubleClick=function(e){this._workspaceDoubleClickEvent.remove(e)},e.prototype.add_workspaceMouseDown=function(e){this._workspaceMouseDownEvent.add(e)},e.prototype.remove_workspaceMouseDown=function(e){this._workspaceMouseDownEvent.remove(e)},e.prototype.add_workspaceMouseMove=function(e){this._workspaceMouseMoveEvent.add(e)},e.prototype.remove_workspaceMouseMove=function(e){this._workspaceMouseMoveEvent.remove(e)},e.prototype.add_workspaceMouseUp=function(e){this._workspaceMouseUpEvent.add(e)},e.prototype.remove_workspaceMouseUp=function(e){this._workspaceMouseUpEvent.remove(e)},e}()},722:function(e,t,n){"use strict";var i,o=n(368),r=n(439),a=n(396),s=n(415),l=n(380),c=n(392);!function(e){e[e.Shift=16]="Shift",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.Delete=127]="Delete"}(i||(i={}));var h=n(423),u=n(521),d=n(370),_=n(393);n.d(t,"a",function(){return p});var p=function(){function e(e,t){this._snapLinesHandler=t,this._selectedItemHandlersChangedEvent=new d.b,this._skipUpdate=!1,this._canvas=e,this._multipleSelectionEnabled=!1,this._currentItemHandler=null,this._itemHandlers=new l.a,this._rectangle=null,this._rectangleWithFrames=null,this._border=null,this._rubberband=null,this._region=null,this._needRedraw=!1,this._shiftState=!1,this._resizeLastPoint=null}return e.setIsSafetyLineItemHandlerFunc=function(e){this._isSafetyLineItemHandlersFunc=e},e.isSafetyLineItemHandler=function(t){if(e._isSafetyLineItemHandlersFunc)return e._isSafetyLineItemHandlersFunc(t)},Object.defineProperty(e.prototype,"history",{get:function(){return this._history},set:function(e){this._history=e},enumerable:!0,configurable:!0}),e.prototype.get_multipleSelectionEnabled=function(){return this._multipleSelectionEnabled&&!_.a.IsTouchDevice()},e.prototype.set_multipleSelectionEnabled=function(e){this._multipleSelectionEnabled=e},e.prototype.get_currentItemHandler=function(){return null!=this._currentItemHandler&&null==this._currentItemHandler.canvas&&this.clearSelectedItemHandlers(),this._currentItemHandler},e.prototype.set_currentItemHandler=function(e){e!==this._currentItemHandler&&(this._currentItemHandler=e,this._canvas.onCurrentItemHandlerChanged(e))},e.prototype.get_selectedItemHandlers=function(){return this._itemHandlers},e.prototype.set_selectedItemHandlers=function(e,t){if(void 0===t&&(t=!1),"[object Array]"===Object.prototype.toString.call(e)){t||this.clearSelectedItemHandlers();for(var n=0;n<this._itemHandlers.get_count();n++){var i=this._itemHandlers.get(n);this._canvas._isPlaceholder(i)&&(i.editing=!1)}this.get_multipleSelectionEnabled()||e.splice(1,e.length-1);for(n=0;n<e.length;n++)this._itemHandlers.push(e[n]);this._onSelectedItemHandlersChanged();var o=this._itemHandlers.get_count()>=1?this._itemHandlers.get(this._itemHandlers.get_count()-1):null;this.set_currentItemHandler(o)}},e.prototype.isItemHandlerSelected=function(e){return this._itemHandlers.contains(e)},e.prototype.isOnlyThisItemHandlerSelected=function(e){return this.isItemHandlerSelected(e)&&1===this._itemHandlers.get_count()},e.prototype.get_needRedraw=function(){return this._needRedraw},e.prototype.addSelectedItemHandler=function(e){!this.get_multipleSelectionEnabled()&&this._itemHandlers.get_count()>0&&this._itemHandlers.clear(),this.set_selectedItemHandlers([e],!0)},e.prototype.removeSelectedItemHandler=function(e){this._itemHandlers.remove(e),this._onSelectedItemHandlersChanged(),e instanceof a.a&&(e.editing=!1),this._itemHandlers.get_count()>0?this.set_currentItemHandler(this._itemHandlers.get_item(this._itemHandlers.get_count()-1)):this.set_currentItemHandler(null)},e.prototype.clearSelectedItemHandlers=function(){for(var e=0;e<this._itemHandlers.get_count();e++){var t=this._itemHandlers.get_item(e);t instanceof a.a&&(t.editing=!1)}this._itemHandlers.clear(),this._onSelectedItemHandlersChanged(),this.set_currentItemHandler(null),this._canvas.hideSelection()},e.prototype.get_visibleRectangle=function(){if(null==this._rectangle)return null;var e=this._rectangle.clone();if(e.width=Math.abs(e.width),e.height=Math.abs(e.height),null!=this._border){var t=e.toRectangleF(),n=e.angle;(e=o.RotatedRectangleF.FromLTRB(t.left-this._border.left,t.top-this._border.top,t.right+this._border.right,t.bottom+this._border.bottom)).angle=n}return e},e.prototype.hitTest=function(e,t){var n,i,o=this.get_visibleRectangle();if(null==o)return{selection:0===this._canvas.getItemHandlersByHitTest(e).length};n=this._itemHandlers.get_count()>1?this._itemHandlers.toArray().reduce(function(e,t){return Math.min(e,t.getSelectionTolerance())},this._itemHandlers.get_item(0).getSelectionTolerance()):(i=this._itemHandlers.get_item(0)).getSelectionTolerance();var s=1===this._itemHandlers.get_count()&&this._currentItemHandler instanceof r.a,l=this._canvas.hitTestSelection(o,e,s,n),h=!1;if(null!=i&&i instanceof a.a){if(i.isContentUpdating()&&l.body&&!l.resize)return l.drag=!0,l;h=i.editing&&i.isCoverMode()}var u=this._get_permissions();if(l.rotate=l.rotate&&u.get_allowRotate()&&!h&&this._allowManipulation,l.resize){var d=l.resizeIndex,_=(5===d||6===d||7===d||8===d)&&this._getEdgeResize(u,i),p=(1===d||2===d||3===d||4===d)&&this._getCornerResize(u,i,!1,c.a.arbitrary),g=(1===d||2===d||3===d||4===d)&&this._getCornerResize(u,i,!0,c.a.arbitrary),f=(1===d||2===d||3===d||4===d)&&this._getCornerResize(u,i,!1,c.a.proportional),v=(1===d||2===d||3===d||4===d)&&this._getCornerResize(u,i,!0,c.a.proportional);l.arbitraryResize=_||p,l.cornerArbitraryResize=p||g,l.cornerProportionalResize=f||v,l.proportionalResize=f&&!s,l.resize=l.arbitraryResize||l.proportionalResize}return l.dragX=l.body&&u.get_allowMoveHorizontal()&&this._allowManipulation,l.dragY=l.body&&u.get_allowMoveVertical()&&this._allowManipulation,l.drag=l.dragX||l.dragY,l},e.prototype._getEdgeResize=function(e,t){return!(null!=t&&"PlainTextItemHandler"===t.getTypeName()||!this._allowManipulation)&&e.get_resizeGrips().edge},e.prototype._getCornerResize=function(e,t,n,i){if(i===c.a.arbitrary&&null!=t&&"PlainTextItemHandler"===t.getTypeName()||!this._allowManipulation)return!1;var o=e.get_resizeGrips();return null!=o.corner&&0!==o.corner.length&&(n&&o.corner.length>1?o.corner[1]:o.corner[0])===i},e.prototype.get_cursor=function(e){var t=this.hitTest(e,!1),n=h.a,i=this._get_permissions();if(t.resize){var r=this._canvas.viewer.get_contentAngle(),a=Object(o.normalizeAngle)(this._rectangle.angle-r),s=([315,45,135,225,270,0,90,180][t.resizeIndex-1]+a)%360;if(s>337.5||s<=22.5)return n.sizeNS;if(s>22.5&&s<=67.5)return n.sizeNESW;if(s>67.5&&s<=112.5)return n.sizeEW;if(s>112.5&&s<=157.5)return n.sizeNWSE;if(s>157.5&&s<=202.5)return n.sizeNS;if(s>202.5&&s<=247.5)return n.sizeNESW;if(s>247.5&&s<=292.5)return n.sizeEW;if(s>292.5&&s<=337.5)return n.sizeNWSE}else{if(t.rotate)return n.pointer;if(t.body&&(i.get_allowMoveHorizontal()||i.get_allowMoveVertical()&&this._allowManipulation))return n.move}return n.defaultCursor},e.prototype.update=function(){if(!this._skipUpdate)if(this._itemHandlers.get_count()>0){var e=this._itemHandlers.get_item(0),t=e.getBorderMargin();if(1===this._itemHandlers.get_count())this._rectangle=e.getSelectionRectangle(),this._border={left:t,top:t,right:t,bottom:t};else{for(var n=e.getSelectionRectangle().bounds,i=n.left,r=n.top,a=n.right,s=n.bottom,l={left:t,top:t,right:t,bottom:t},c=1;c<this._itemHandlers.get_count();c++)t=(e=this._itemHandlers.get_item(c)).getBorderMargin(),(n=e.getSelectionRectangle().bounds).left-t<i-l.left&&(i=n.left,l.left=t),n.top-t<r-l.top&&(r=n.top,l.top=t),n.right+t>a+l.right&&(a=n.right,l.right=t),n.bottom+t>s+l.bottom&&(s=n.bottom,l.bottom=t);this._rectangle=o.RotatedRectangleF.FromLTRB(i,r,a,s),this._border=l}this._rectangleWithFrames=this._get_rectWithFrames(this._rectangle),this._region=this._get_region()}else this._rectangle=null,this._border=null,this._region=null},e.prototype.draw=function(e,t){null!=this._rubberband?t.drawRubberband(e,this._rubberband):this._needRedraw=!1;var n=this.get_visibleRectangle();if(null!=n&&0!==this._itemHandlers.get_count()){var i=!1,o=!1,s=!1,l=null;if(1===this._itemHandlers.get_count())i=(l=this._itemHandlers.get_item(0))instanceof r.a,s=l instanceof a.a&&l.editing;else for(var h=0;h<this._itemHandlers.get_count();h++){var u=this._itemHandlers.get_item(h);u instanceof r.a&&(o=!0),u instanceof a.a&&u.editing&&(s=!0)}var d=s&&this._itemHandlers.get_item(0).item.isCoverMode,_=this._get_permissions(),p={rotate:_.get_allowRotate()&&!d&&this._allowManipulation,resize:(this._getCornerResize(_,l,!1,c.a.arbitrary)||this._getCornerResize(_,l,!1,c.a.proportional))&&!i,arbitraryWidthResize:this._getEdgeResize(_,l)&&!o&&!d,arbitraryHeightResize:this._getEdgeResize(_,l)&&!i&&!o&&!d};this._canvas.showSelection(n,p),null!==this._canvas.hoverDiv&&(null!==l?this._canvas.updateHoverPosition(l.rectangle,l.item.name):this._canvas.hideHover()),s||this._snapLinesHandler.drawActiveLines(e,t)}else this._canvas.hideSelection()},e.prototype.processKeyEvent=function(e){if(null!=this._rectangle){var t=this._get_permissions();if(((e.keyCode===i.Left||e.keyCode===i.Right)&&t.get_allowMoveHorizontal()||(e.keyCode===i.Up||e.keyCode===i.Down)&&t.get_allowMoveVertical())&&this._allowManipulation)if("keydown"===e.type&&void 0===this._operation){var n=!0===e.shiftKey?5:1;this._keyPushed||this._startTransform(),this._keyPushed=!0,this._keyCode=e.keyCode,this._move(e.keyCode,n)}else"keyup"===e.type&&this._keyPushed&&this._keyCode===e.keyCode&&(this._keyPushed=!1,this._endTransform());if(16===e.keyCode&&this._allowManipulation){var o=e.shiftKey;o!==this._shiftState&&(this._shiftState=o,this._operation&&this._operation.resize&&this._resize(null))}}},e.prototype.processMouseEvent=function(e){var t=new o.PointF(e.x,e.y);if("mousedown"===e.type)this._operation=this.hitTest(t,e.originalEvent.shiftKey),this._startPoint=t,this._startTransform(),this._startRubberbandSelection(),this._fillSnapData();else if("mouseup"===e.type){var n=this._operation&&this._operation.resize;delete this._operation,this._endTransform(n),this._endRubberbandSelection(),this._snapLinesHandler.clearSnapData(),delete this._startPoint}else if("mousemove"===e.type&&null!=this._operation&&null!=this._startPoint)if(this._operation.selection)this._updateRubberband(t);else if(this._operation.resize)this._resize(t);else if(this._operation.rotate)this._rotate(t,!(e.originalEvent.ctrlKey||e.originalEvent.metaKey),e.originalEvent.shiftKey);else if(this._operation.drag){var i=this._get_permissions(),r=i.get_allowMoveHorizontal()&&this._allowManipulation?t.x:this._startPoint.x,a=i.get_allowMoveVertical()&&this._allowManipulation?t.y:this._startPoint.y;this._drag(new o.PointF(r,a),e.originalEvent.ctrlKey||e.originalEvent.metaKey)}},e.prototype._fillSnapData=function(){this._snapLinesHandler.fillSnapData(this._startRectangle,this._startRectangleWithFrames,null!=this._startRectangle?this._getRectangleWithBorder(this._startRectangle).bounds:null,this._region,this._canvas,this._operation)},e.prototype._constrainRectangleToSnapLines=function(e,t){return this._snapLinesHandler.constrainRectangleToSnapLines(e,this._getRectangleWithBorder(this._rectangle),t,this._operation,this._get_rectWithFrames(e),this._getRectangleWithBorder(e),this._canvas)},e.prototype.isResizing=function(){return this._operation&&this._operation.resize},e.prototype.isRotating=function(){return this._operation&&this._operation.rotate},e.prototype.isOperationNotNull=function(){return null!=this._operation},e.prototype.set_angle=function(e){this._startTransform();var t=this._rectangle.clone();t.angle=e,this._updateRectangle(t),this._endTransform(),this._canvas.redraw()},e.prototype._startTransform=function(){if(null!=this._rectangle){this._startRectangle=this._rectangle.clone(),this._startRectangleWithFrames=this._get_rectWithFrames(this._startRectangle);for(var e=0;e<this._itemHandlers.get_count();e++)this._itemHandlers.get_item(e)._startTransform()}},e.prototype._endTransform=function(e){if(void 0===e&&(e=!1),null!=this._rectangle){this._skipUpdate=!0;var t=null!=this._startRectangle&&!this._rectangle.isEqual(this._startRectangle);this.history&&this.history.pause();for(var n=0;n<this._itemHandlers.get_count();n++){var i=this._itemHandlers.get_item(n),o=e;t&&e&&(o=i._onResized()),i._endTransform(t,o)}t&&this._canvas.updateTexts(),this.history&&this.history.resume(),delete this._startRectangle,delete this._startRectangleWithFrames,this._skipUpdate=!1,e&&this.update()}},e.prototype._startRubberbandSelection=function(){null!=this._canvas.viewer&&this._canvas.viewer.ignoreDocumentClickOnce()},e.prototype._endRubberbandSelection=function(){if(null!=this._rubberband){var e=o.RectangleF.FromLTRB(this._rubberband.left,this._rubberband.top,this._rubberband.right,this._rubberband.bottom);if(!Object(o.EqualsOfFloatNumbers)(e.width,0)&&!Object(o.EqualsOfFloatNumbers)(e.height,0)){for(var t=[],n=this._canvas.get_allHandlers({onlyVisible:!0}),i=0;i<n.length;i++){var r=n[i];!this._canvas.isLockedOrDisabled(r)&&e.contains(r.rectangle.center)&&t.push(r)}this.set_selectedItemHandlers(t)}this._rubberband=null}},e.prototype._updateRubberband=function(e){this.get_multipleSelectionEnabled()&&null!=this._startPoint&&(this._rubberband={left:Math.min(this._startPoint.x,e.x),top:Math.min(this._startPoint.y,e.y),right:Math.max(this._startPoint.x,e.x),bottom:Math.max(this._startPoint.y,e.y)},this._needRedraw=!0)},e.prototype._resize=function(t){null==t&&(t=this._resizeLastPoint),this._resizeLastPoint=t;var n=this._operation.arbitraryResize;this._shiftState&&(n&&this._operation.cornerProportionalResize?n=!1:!n&&this._operation.cornerArbitraryResize&&(n=!0));var i,r=this._rectangle.clone(),a=new o.PointF(t.x-this._startRectangle.centerX,t.y-this._startRectangle.centerY);a.rotate(-r.angle);var s=new o.PointF(this._startPoint.x-this._startRectangle.centerX,this._startPoint.y-this._startRectangle.centerY);s.rotate(-r.angle);var l=a.translate(-s.x,-s.y),c=6,h=5,u=1,d=1;if(n)r.width=this._startRectangle.width+l.x*e.cw[this._operation.resizeIndex],r.height=this._startRectangle.height+l.y*e.ch[this._operation.resizeIndex],this._operation.resizeIndex!==c&&this._operation.resizeIndex!==h||(u=-1,d=-1),1===this._operation.resizeIndex&&(u=-1,d=-1),2===this._operation.resizeIndex&&(u=1,d=-1),4===this._operation.resizeIndex&&(u=-1,d=1);else{var _=l.x*e.cw[this._operation.resizeIndex]/this._startRectangle.width,p=l.y*e.ch[this._operation.resizeIndex]/this._startRectangle.height,g=_<p?_:p;l.x=this._startRectangle.width*g,l.y=this._startRectangle.height*g,r.width=this._startRectangle.width+l.x,r.height=this._startRectangle.height+l.y}if(this._get_allowNegativeResize()||r.width>=0&&r.height>=0){if((i=new o.PointF(l.x/2*e.cw[this._operation.resizeIndex],l.y/2*e.ch[this._operation.resizeIndex])).rotate(r.angle),r.centerX=this._startRectangle.centerX+i.x*u,r.centerY=this._startRectangle.centerY+i.y*d,n){var f=i=new o.PointF(this._startRectangle.centerX,this._startRectangle.centerY);f.rotate(-r.angle),f.x=f.x+l.x/2*e.cw[this._operation.resizeIndex]*e.cw[this._operation.resizeIndex],f.y=f.y+l.y/2*e.ch[this._operation.resizeIndex]*e.ch[this._operation.resizeIndex],f.rotate(r.angle),r.centerX=f.x,r.centerY=f.y}}else{var v=new o.PointF(-e.cw[this._operation.resizeIndex]*this._rectangle.width/2,-e.ch[this._operation.resizeIndex]*this._rectangle.height/2);if(v.rotate(this._rectangle.angle),v.translate(this._rectangle.centerX,this._rectangle.centerY),r.center=v,n)r.width=Math.max(r.width,1),r.height=Math.max(r.height,1);else{var m=this._startRectangle.width/this._startRectangle.height;m>=1?(r.width=Math.max(r.width,1*m),r.height=Math.max(r.height,1)):(r.width=Math.max(r.width,1),r.height=Math.max(r.height,1/m))}var y=new o.PointF(e.cw[this._operation.resizeIndex]*r.width/2,e.ch[this._operation.resizeIndex]*r.height/2);y.rotate(r.angle),r.centerX+=y.x,r.centerY+=y.y}var C=this._canvas.get_contentEditingPlaceholderItemHandler();null!=C&&C.item.isCoverMode&&(r=this._constrainRectangleToPlaceholderCover(r,C.rectangle)),null==this._canvas.get_contentEditingPlaceholderItemHandler()&&(r=this._constrainRectangleToSnapLines(r,n)),this._updateRectangle(r)},e.prototype._drag=function(e,t){var n=this._canvas.get_contentEditingPlaceholderItemHandler(),i=new o.PointF(e.x-this._startPoint.x,e.y-this._startPoint.y);t?this._snapLinesHandler.resetActiveLines():null==this._canvas.get_contentEditingPlaceholderItemHandler()&&(i=this._snapLinesHandler.constrainDiffToSnapLines(e,this._startPoint,this._canvas)),null==n?i=this._constrainDiffToRegion(this._startRectangleWithFrames.bounds,i):n.item.isCoverMode&&(i=this._constrainDiffToPlaceholderCover(this._startRectangle,n.rectangle,i));var r=this._rectangle.clone();r.centerX=this._startRectangle.centerX+i.x,r.centerY=this._startRectangle.centerY+i.y,this._updateRectangle(r,!0)},e.prototype._rotate=function(e,t,n){var i=e.clone(),r=this._startPoint,a=this._rectangle.clone(),s=new o.PointF(a.centerX,a.centerY),l=Object(o.getTriangleAngle)(i,r,s),c=n?15:90,h=t?n?7.5:5:0,u=l=Object(o.normalizeAngle)(this._startRectangle.angle+l),d=l%c;d<h?u=c*Math.floor(l/c):d>c-h&&(u=c*Math.floor(l/c+1)),a.angle=Object(o.normalizeAngle)(u),this._updateRectangle(a)},e.prototype._move=function(e,t){var n=t/this._canvas.get_mul(),r=null;switch(e){case i.Up:r=new o.PointF(0,-n);break;case i.Down:r=new o.PointF(0,n);break;case i.Left:r=new o.PointF(-n,0);break;case i.Right:r=new o.PointF(n,0)}if(null!=r){var a=this._canvas.viewer.get_contentAngle();a>0&&r.rotate(-a);var s=this._canvas.get_contentEditingPlaceholderItemHandler();null==s?r=this._constrainDiffToRegion(this._rectangle.bounds,r):s.item.isCoverMode&&(r=this._constrainDiffToPlaceholderCover(this._rectangle,s.rectangle,r));var l=this._rectangle.clone();l.centerX+=r.x,l.centerY+=r.y,this._updateRectangle(l)}},e.prototype._get_permissions=function(){if(null==this._rectangle||0===this._itemHandlers.get_count())return new u.a({},!1);var e=this._itemHandlers.get_item(0).get_permissions().clone();this._itemHandlers.get_count()>1&&(this._rectangle.angle-this._itemHandlers.get_item(0).angle)%90!=0&&(e.get_resizeGrips().edge=!1,e.get_resizeGrips().setCornerArbitrary(!1));for(var t=1;t<this._itemHandlers.get_count();t++){var n=this._itemHandlers.get_item(t),i=n.get_permissions();i.get_allowMoveHorizontal()||e.set_allowMoveHorizontal(!1),i.get_allowMoveVertical()||e.set_allowMoveVertical(!1),i.get_allowRotate()||e.set_allowRotate(!1),i.get_resizeGrips().edge||(e.get_resizeGrips().edge=!1),i.get_resizeGrips().getCornerProportional()||e.get_resizeGrips().setCornerProportional(!1),i.get_resizeGrips().getCornerArbitrary()||e.get_resizeGrips().setCornerArbitrary(!1),(this._rectangle.angle-n.angle)%90!=0&&(e.get_resizeGrips().edge=!1,e.get_resizeGrips().setCornerArbitrary(!1))}return e},e.prototype._get_allowNegativeResize=function(){if(null==this._rectangle||0===this._itemHandlers.get_count())return!1;for(var e=0;e<this._itemHandlers.get_count();e++)if(!this._itemHandlers.get_item(e).allowNegativeResize)return!1;return!0},e.prototype._get_region=function(){var e=null;if(this._canvas.get_constrainedMarginEnabled()&&this._canvas.get_margin()>0){var t=this._canvas.get_margin();e=new o.RectangleF(t,t,this._canvas.get_workspaceWidth()-t,this._canvas.get_workspaceHeight()-t)}for(var n=new l.a,i=0;i<this._itemHandlers.get_count();i++){var r=this._itemHandlers.get_item(i).get_layer();null==r||null==r.get_region()||n.contains(r)||n.add(r)}for(var a=0;a<n.get_count();a++){var s=n.get_item(a).get_region();e=null!=e?o.RectangleF.intersect(e,s):s}return e},e.prototype._updateRectangle=function(e,t){void 0===t&&(t=!1);var n=this._canvas.get_contentEditingPlaceholderItemHandler();if(t||!this._canvas.suppressOutOfRegionManipulation||null==this._region||null!=n||this._region.containsRectangle(this._get_rectWithFrames(e).bounds)){this._rectangle=e,this._rectangleWithFrames=this._get_rectWithFrames(e);for(var i=0;i<this._itemHandlers.get_count();i++)this._itemHandlers.get_item(i)._transformRectangle(this._startRectangle,this._rectangle,!0)}},e.prototype._get_rectWithFrames=function(e){for(var t=this._getRectangleWithBorder(e),n=0;n<this._itemHandlers.get_count();n++){var i=this._itemHandlers.get_item(n);if(null!=i&&i instanceof a.a){var r=i.getRectangleIncludingFrames(),l=s.a.transformRectangleByTwoRectanglesDiff(r,this._rectangle,e);t=o.RotatedRectangleF.union(l,t)}}return t},e.prototype._constrainDiffToRegion=function(e,t){return this._canvas.suppressOutOfRegionManipulation&&null!=this._region?(e.left+t.x<this._region.left&&(t.x=this._region.left-e.left),e.top+t.y<this._region.top&&(t.y=this._region.top-e.top),e.right+t.x>this._region.left+this._region.width&&(t.x=this._region.left+this._region.width-e.right),e.bottom+t.y>this._region.top+this._region.height&&(t.y=this._region.top+this._region.height-e.bottom),t):t},e.prototype._constrainDiffToPlaceholderCover=function(e,t,n){var i=t.angle;t.angle=0;var o=t.bounds,r=e.clone();r.rotateAt(-i,t.center);var a=r.bounds;return n.rotate(-i),a.left+n.x>o.left&&(n.x=o.left-a.left),a.top+n.y>o.top&&(n.y=o.top-a.top),a.right+n.x<o.left+o.width&&(n.x=o.left+o.width-a.right),a.bottom+n.y<o.top+o.height&&(n.y=o.top+o.height-a.bottom),n.rotate(i),n},e.prototype._constrainRectangleToPlaceholderCover=function(e,t){var n=e.angle,i=t.angle,r=Object(o.EqualsOfFloatNumbers)(90,Object(o.normalizeAngle)(n-i)%180);t.angle=0;var a=t.bounds;e.rotateAt(-i,t.center);var s=e.bounds,l=Math.min(s.left,a.left),c=Math.min(s.top,a.top),h=Math.max(s.right,a.right),u=Math.max(s.bottom,a.bottom),d=h-l,_=u-c,p=r?this._startRectangle.height/this._startRectangle.width:this._startRectangle.width/this._startRectangle.height,g=d/_,f=(this._operation.resizeIndex-1+Math.round(Object(o.normalizeAngle)(n-i)/90))%4+1;if(g>p){var v=Math.abs(d/p-d/g);1===f||2===f?c-=v:u+=v}if(g<p){var m=Math.abs(_*p-_*g);2===f||3===f?h+=m:l-=m}var y=new o.RectangleF(l,c,h-l,u-c);if(!Object(o.EqualsOfFloatNumbers)(0,n-i%360)){var C=o.RotatedRectangleF.fromRectangleF(y);C.rotateAt(i-n,t.center),y=C.bounds}var b=o.RotatedRectangleF.fromRectangleF(y);return b.rotateAt(n,t.center),b},e.prototype._getRectangleWithBorder=function(e){if(null==e)return null;var t=e.center,n=e.angle;e.angle=0;var i=e.bounds,r=o.RotatedRectangleF.FromLTRB(i.left-this._border.left,i.top-this._border.top,i.right+this._border.right,i.bottom+this._border.bottom);return r.width*=Math.sign(e.width),r.height*=Math.sign(e.height),r.rotateAt(n,t),e.angle=n,r},e.prototype.addSelectedItemHandlersChanged=function(e){this._selectedItemHandlersChangedEvent.add(e)},e.prototype.removeSelectedItemHandlersChanged=function(e){this._selectedItemHandlersChangedEvent.remove(e)},e.prototype._onSelectedItemHandlersChanged=function(){this._selectedItemHandlersChangedEvent.notify(this)},Object.defineProperty(e.prototype,"_allowManipulation",{get:function(){return null!=this._canvas&&(!this._canvas.simpleMode||null!=this._canvas.get_contentEditingPlaceholderItemHandler())},enumerable:!0,configurable:!0}),e.cw=[0,-1,1,1,-1,-1,0,1,0],e.ch=[0,-1,-1,1,1,0,-1,0,1],e._isSafetyLineItemHandlersFunc=null,e}()},871:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Canvas});var _EventObject__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(370),_ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(396),_ItemHandlers_ImageItemHandler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(413),_Services_Service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(897),_LayerCollection__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(872),_SelectionHandler__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(722),_DragNDropHandler__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(873),_RotateHandler__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(874),_Utils_Common__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(423),_UpdateStatus__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(537),_CanvasData__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(875),_Math__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(368),_ItemHandlers_WrappingMode__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(419),_Layer__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(708),underscore__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(376),underscore__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_14__),_ItemHandlers_BoundedTextItemHandler__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(438),_Model_Product_Items_Item__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(401),_Exception__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(371),_ItemHandlers_HandlerFactoryByItem__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(541),_Utils_Convert__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(433),_ItemHandlers_PathBoundedTextItemHandler__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(534),_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(393),_HoverHandler__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(876),_Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(715),_CanvasElementHandler__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(877),_CanvasRenderer__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(878),_Viewer_SnapLinesHandler__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(879),__awaiter=function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},__generator=function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},__values=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},__read=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a},__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},Canvas=function(){function Canvas(e){var t=this;this._initialized=!1,this._zoomChangedEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._workspaceSizeChangedEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this.canvasItemHoverEnabled=!1,this._simpleMode=!0,this.handlerFactory=new _ItemHandlers_HandlerFactoryByItem__WEBPACK_IMPORTED_MODULE_18__.a(this,this.viewer),this._throttleRedraw=underscore__WEBPACK_IMPORTED_MODULE_14__.throttle(this._redraw,250),this._onItemRemoved=function(e){var n=e.item;if(n instanceof _Model_Product_Items_Item__WEBPACK_IMPORTED_MODULE_16__.a){var i=t.handlerFactory.get(n);t.isItemHandlerSelected(i)&&t.removeSelectedItemHandler(i),i.canvas=null}},this._onContainersChanged=function(e){var n,i,o,r,a,s,l,c;try{for(var h=__values(e.removed),u=h.next();!u.done;u=h.next()){var d=u.value;try{for(var _=__values(d.items),p=_.next();!p.done;p=_.next()){var g=p.value;t._onItemRemoved({item:g})}}catch(e){o={error:e}}finally{try{p&&!p.done&&(r=_.return)&&r.call(_)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}t._updateLayers();try{for(var f=__values(e.added),v=f.next();!v.done;v=f.next()){v.value.items.add_itemRemoved(t._onItemRemoved)}}catch(e){a={error:e}}finally{try{v&&!v.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}try{for(var m=__values(e.removed),y=m.next();!y.done;y=m.next()){(d=y.value).items.remove_itemRemoved(t._onItemRemoved)}}catch(e){l={error:e}}finally{try{y&&!y.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}t.redraw()},this._updateLayers=function(){t.layers.clear(),t.layers.addRange(t._viewer.containersFlatList.map(function(e){return new _Layer__WEBPACK_IMPORTED_MODULE_13__.a(e,t)})),t.disabledLayers=t.disabledLayers.map(function(e){return t.layers.toArray().find(function(t){return t.container.id===e.container.id})}).filter(function(e){return void 0!==e}),t.maskedLayers=t.maskedLayers.map(function(e){return t.layers.toArray().find(function(t){return t.container.id===e.container.id})}).filter(function(e){return void 0!==e}),t._layersUpdatedEvent.notify(t,{})},this._onServiceImageContainerLoaded=function(e){t.redraw()},this._viewer=e,this._prevWorkspaceSize={width:0,height:0},this._snapLinesHandler=new _Viewer_SnapLinesHandler__WEBPACK_IMPORTED_MODULE_26__.a,this._selection=new _SelectionHandler__WEBPACK_IMPORTED_MODULE_5__.a(this,this._snapLinesHandler),this._dndHandler=new _DragNDropHandler__WEBPACK_IMPORTED_MODULE_6__.a(this),this._hoverHandler=new _HoverHandler__WEBPACK_IMPORTED_MODULE_22__.a(this),this._rotateHandler=new _RotateHandler__WEBPACK_IMPORTED_MODULE_7__.a(this,this.viewer),this._canvasRenderer=new _CanvasRenderer__WEBPACK_IMPORTED_MODULE_25__.a(this._selection,this._dndHandler,this),this._canvasElementHandler=new _CanvasElementHandler__WEBPACK_IMPORTED_MODULE_24__.a(this.viewer.get_id(),this._selection,this._dndHandler,this._rotateHandler,this),this.layers=new _LayerCollection__WEBPACK_IMPORTED_MODULE_4__.a(this),this._disabledLayers=[],this._maskedLayers=[],this._workspaceWidth=72,this._workspaceHeight=72,this._zoom=1,this._screenXDpi=96,this._screenYDpi=96,this._targetDpi=null,this._hiddenFieldID="",this._parent=null,this._document=document,this._mouseMoveTimeout=100,this._disableSmoothing=!1,this._rotationGripSize=24,this._resizeGripSize=11,this._resizeGripColor="rgba(255,255,255,1)",this._rotationGripColor="rgba(0,0,255,0.2)",this._resizeGripLineColor="rgba(255,0,0,1)",this._rotationGripLineColor="rgba(112,112,112,1)",this._rotationGripLineLength=12,this._floatingItemToolbarEnabled=!1,this._violationWarningButtonsEnabled=!1,this._qualityChangeContainersEnabled=!0,this._floatingItemToolbarCssClass=null,this._violationContainerCssClass=null,this._placeholderButtonGroupCssClass=null,this._selectImageButtonCssClass=null,this._selectBarcodeButtonCssClass=null,this._doneButtonCssClass=null,this._handleButtonCssClass=null,this._deleteToolbarButtonCssClass=null,this._editToolbarButtonCssClass=null,this._selectToolbarButtonCssClass=null,this._bigButtonGroupCssClass=null,this._violationWarningButtonCssClass=null,this._goodViolationIconCssClass=null,this._warningViolationIconCssClass=null,this._violationBadIconCssClass=null,this._qualityChangeContainerCssClass=null,this._qualityChangeScaleBarCssClass=null,this._qualityBadToWarningChangeScaleBarCssClass=null,this._qualityWarningToGoodChangeScaleBarCssClass=null,this._qualityBadToGoodChangeScaleBarCssClass=null,this._qualityNoAnimationChangeScaleBarCssClass=null,this._qualityChangeInfoBarCssClass=null,this._selectButtonTitle="Select image",this._editBarcodeButtonTitle="Edit barcode",this._doneButtonTitle="Done",this._handleButtonTitle="Handle",this._deleteButtonTitle="Delete item",this._editButtonTitle="Edit item",this._backgroundImage=null,this._loadingImageUrl=null,this._marginColor="rgba(100,255,100,1)",this._marginWidth=0,this._leftMargin=18,this._rightMargin=18,this._topMargin=18,this._bottomMargin=18,this._maxFontSize=null,this._minFontSize=null,this._maxLeading=null,this._minLeading=null,this._constrainedMarginEnabled=!1,this._keyEventEnabled=!0,this._selectionColor="rgba(0,0,255,0.7)",this._selectionWidth=2,this._handlerUrl=null,this._suppressOutOfRegionManipulation=!0,this._initialization=!1,this._onSelectedItemHandlersDeletingDelegate,this._onSelectedItemHandlersChangedDelegate,this._callbackArgs="",this._exceptionDescription="",this._callback=null,this._status=_UpdateStatus__WEBPACK_IMPORTED_MODULE_9__.a.ready,this._callbackContext=0,this._callbackCount=0,this._callbackCollection=[],this._callbackDelay=100,this._callbackTimeout=null,this._rgbColorProfileFileId=null,this._cmykColorProfileFileId=null,this._grayscaleColorProfileFileId=null,this._returnValue=null,this._tags={},this._ready=!1,this._isMouseButtonPressed=!1,this._canDeleteItemHandlersCallback=null,this._serviceEndpoint=null,this._service=null,this._sendingRequestEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._requestCompleteEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._statusChangedEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._callbackExceptionEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._initializedEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._invokingCallbackRequestEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._itemHandlerCreatedEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._currentItemHandlerChangedEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._selectedItemHandlersChangedEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._selectedItemHandlersDeletingEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._dragNDropDoneEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._dragNDropStartingEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._dragNDropPerformedEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._readyEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._layersUpdatedEvent=new _EventObject__WEBPACK_IMPORTED_MODULE_0__.b,this._floatingItemToolbarEnabled=!1,this._autoPlaceholderEditModeEnabled=!1,this._initContainersObservation()}return Object.defineProperty(Canvas.prototype,"snapLinesHandler",{get:function(){return this._snapLinesHandler},enumerable:!0,configurable:!0}),Canvas.prototype._initContainersObservation=function(){var e,t;this._updateLayers();try{for(var n=__values(this._viewer.containersFlatList),i=n.next();!i.done;i=n.next()){i.value.items.add_itemRemoved(this._onItemRemoved)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._viewer.containersFlatListChangedEvent.add(this._onContainersChanged)},Canvas.prototype.setHistory=function(e){this._history=e,this._selection.history=e},Object.defineProperty(Canvas.prototype,"history",{get:function(){return this._history},enumerable:!0,configurable:!0}),Canvas.prototype.get_dndHandler=function(){return this._dndHandler},Object.defineProperty(Canvas.prototype,"hiddenFieldID",{get:function(){return this._hiddenFieldID},set:function(e){this._hiddenFieldID=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"rgbColorProfileFileId",{get:function(){return this._rgbColorProfileFileId},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"cmykColorProfileFileId",{get:function(){return this._cmykColorProfileFileId},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"grayscaleColorProfileFileId",{get:function(){return this._grayscaleColorProfileFileId},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"serviceEndpoint",{get:function(){return this._serviceEndpoint},set:function(e){this._serviceEndpoint=e,this.service=e?new _Services_Service__WEBPACK_IMPORTED_MODULE_3__.a(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"service",{get:function(){return this._service},set:function(e){null!=this._service&&this._service.imageLoaderService.removeImageContainerLoaded(this._onServiceImageContainerLoaded),this._service=e,null!=this._service&&this._service.imageLoaderService.addImageContainerLoaded(this._onServiceImageContainerLoaded)},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"viewer",{get:function(){return this._viewer},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"simpleMode",{get:function(){return this._simpleMode},set:function(e){this._simpleMode=e,this.clearSelectedItemHandlers(),this.redraw()},enumerable:!0,configurable:!0}),Canvas.prototype.alignItemHandler=function(e,t){if(e&&!this.isLockedOrDisabled(e)&&!this._simpleMode){var n=e instanceof _ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a&&!("verticalCenter"===t||"horizontalCenter"===t),i=n?e.getBoundsIncludingFrames():e.bounds,o=e.rectangle,r=e.rectangle,a=e.get_layer().get_region();a?"left"===t?r.centerX=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveHorizontal()?a.left+i.width/2:r.centerX:"horizontalCenter"===t?r.centerX=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveHorizontal()?a.left+a.width/2:r.centerX:"right"===t?r.centerX=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveHorizontal()?a.left+a.width-i.width/2:r.centerX:"top"===t?r.centerY=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveVertical()?a.top+i.height/2:r.centerY:"verticalCenter"===t?r.centerY=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveVertical()?a.top+a.height/2:r.centerY:"bottom"===t&&(r.centerY=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveVertical()?a.top+a.height-i.height/2:r.centerY):"left"===t?r.centerX=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveHorizontal()?this.leftMargin+i.width/2:r.centerX:"horizontalCenter"===t?r.centerX=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveHorizontal()?this.leftMargin+(this.get_workspaceWidth()-this.rightMargin-this.leftMargin)/2:r.centerX:"right"===t?r.centerX=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveHorizontal()?this.get_workspaceWidth()-this.rightMargin-i.width/2:r.centerX:"top"===t?r.centerY=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveVertical()?this.topMargin+i.height/2:r.centerY:"verticalCenter"===t?r.centerY=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveVertical()?this.topMargin+(this.get_workspaceHeight()-this.bottomMargin-this.topMargin)/2:r.centerY:"bottom"===t&&(r.centerY=!this.isLockedOrDisabled(e)&&e.get_permissions().get_allowMoveVertical()?this.get_workspaceHeight()-this.bottomMargin-i.height/2:r.centerY),n&&!this.isLockedOrDisabled(e)&&("bottom"!==t&&"top"!==t||!e.get_permissions().get_allowMoveVertical()||(r.centerY-=i.top+i.height/2-o.centerY),"left"!==t&&"right"!==t||!e.get_permissions().get_allowMoveHorizontal()||(r.centerX-=i.left+i.width/2-o.centerX)),e instanceof _ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a?(e.setRectangle(r,null,!0),e.updateContentAndFrames(function(e){var t=e.rectangle;t.centerX+=r.centerX-o.centerX,t.centerY+=r.centerY-o.centerY,e.setRectangle(t)})):e.setRectangle(r),this._selection.update(),this.redraw()}},Canvas.prototype.alignItemHandlers=function(e){if(!this._simpleMode&&this.get_selectedItemHandlers().get_count()>1){for(var t=this._selection.get_visibleRectangle(),n=0;n<this.get_selectedItemHandlers().get_count();n++){var i=this.get_selectedItemHandlers().get_item(n),o=i.rectangle,r=i.rectangle,a=r.bounds;"left"===e?r.centerX=!this.isLockedOrDisabled(i)&&i.get_permissions().get_allowMoveHorizontal()?t.location.x+a.width/2:r.centerX:"horizontalCenter"===e?r.centerX=!this.isLockedOrDisabled(i)&&i.get_permissions().get_allowMoveHorizontal()?t.centerX:r.centerX:"right"===e?r.centerX=!this.isLockedOrDisabled(i)&&i.get_permissions().get_allowMoveHorizontal()?t.getBottomRightCorner().x-a.width/2:r.centerX:"top"===e?r.centerY=!this.isLockedOrDisabled(i)&&i.get_permissions().get_allowMoveVertical()?t.location.y+a.height/2:r.centerY:"verticalCenter"===e?r.centerY=!this.isLockedOrDisabled(i)&&i.get_permissions().get_allowMoveVertical()?t.centerY:r.centerY:"bottom"===e&&(r.centerY=!this.isLockedOrDisabled(i)&&i.get_permissions().get_allowMoveVertical()?t.getBottomRightCorner().y-a.height/2:r.centerY),i.setRectangle(r),i instanceof _ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a&&i.updateContentAndFrames(function(e){var t=e.rectangle;t.centerX+=r.centerX-o.centerX,t.centerY+=r.centerY-o.centerY,e.setRectangle(t)}),this._selection.update(),this.redraw()}this.updateTexts()}},Canvas.prototype.set_handlerUrl=function(e){this._handlerUrl=e},Canvas.prototype.get_handlerUrl=function(){return this._handlerUrl},Canvas.prototype._deleteSelectedItemHandlersWithoutConfirm=function(){for(var e=!1,t=this.get_selectedItemHandlers().toArray(),n=0;n<t.length;n++){var i=t[n];if(this._canDeleteItemHandler(i))i.item.parentContainer.items.remove(i.item),e=!0}e&&(this.updateTexts(),this.updateSelection(),this.redraw())},Canvas.prototype._canDeleteItemHandler=function(e){return!this.simpleMode&&null!=e&&null!=e.get_layer()&&!this.isLockedOrDisabled(e)&&!e.get_layer().locked&&e.visible&&e.get_layer().get_visible()&&e.get_permissions()&&e.get_permissions().get_allowDelete()},Canvas.prototype.set_canDeleteItemHandlersCallback=function(e){this._canDeleteItemHandlersCallback=e},Canvas.prototype.deleteSelectedItemHandlers=function(e){if("function"!=typeof this._canDeleteItemHandlersCallback||this._canDeleteItemHandlersCallback()){for(var t=!1,n=0;n<this.get_selectedItemHandlers().get_count();n++){var i=this.get_selectedItemHandlers().get_item(n);if(this._canDeleteItemHandler(i)){t=!0;break}}if(t)if(e)if(this._selectedItemHandlersDeletingEvent.listenersCount()>0)this._selectedItemHandlersDeletingEvent.notify(this,this._onSelectedItemHandlersChangedDelegate);else confirm("Selected objects will be deleted. Continue?")&&this._deleteSelectedItemHandlersWithoutConfirm();else this._deleteSelectedItemHandlersWithoutConfirm()}},Canvas.prototype.get_ready=function(){return this._ready},Canvas.prototype.get_tags=function(){return this._tags},Canvas.prototype.set_tags=function(e){this._tags=e},Canvas.prototype.get_width=function(){return this._workspaceWidth*this._zoom*this.get_screenXDpi()/72},Canvas.prototype.get_height=function(){return this._workspaceHeight*this._zoom*this.get_screenYDpi()/72},Canvas.prototype.get_keyEventEnabled=function(){return this._keyEventEnabled},Canvas.prototype.set_keyEventEnabled=function(e){this._keyEventEnabled=e},Canvas.prototype.get_marginColor=function(){return this._marginColor},Canvas.prototype.set_marginColor=function(e){this._marginColor=e},Canvas.prototype.get_marginWidth=function(){return this._marginWidth},Canvas.prototype.set_marginWidth=function(e){this._marginWidth=e},Object.defineProperty(Canvas.prototype,"selectionColor",{get:function(){return this._selectionColor},set:function(e){this._selectionColor=e,this._updateGripsAndHoverDiv()},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"selectionWidth",{get:function(){return this._selectionWidth},set:function(e){this._selectionWidth=e,this._updateGripsAndHoverDiv()},enumerable:!0,configurable:!0}),Canvas.prototype.get_margin=function(){return Math.min(this._leftMargin,this._topMargin,this._rightMargin,this._bottomMargin)},Canvas.prototype.set_margin=function(e){this._leftMargin=e,this._rightMargin=e,this._topMargin=e,this._bottomMargin=e},Object.defineProperty(Canvas.prototype,"leftMargin",{get:function(){return this._leftMargin},set:function(e){this._leftMargin!==e&&(this._leftMargin=e)},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"rightMargin",{get:function(){return this._rightMargin},set:function(e){this._rightMargin!==e&&(this._rightMargin=e)},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"topMargin",{get:function(){return this._topMargin},set:function(e){this._topMargin!==e&&(this._topMargin=e)},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"bottomMargin",{get:function(){return this._bottomMargin},set:function(e){this._bottomMargin!==e&&(this._bottomMargin=e)},enumerable:!0,configurable:!0}),Canvas.prototype.set_constrainedMarginEnabled=function(e){this._constrainedMarginEnabled=e},Canvas.prototype.get_constrainedMarginEnabled=function(){return this._constrainedMarginEnabled},Canvas.prototype.get_targetDpi=function(){return this._targetDpi},Canvas.prototype.set_targetDpi=function(e){this._targetDpi=e},Object.defineProperty(Canvas.prototype,"suppressOutOfRegionManipulation",{get:function(){return this._suppressOutOfRegionManipulation},set:function(e){this._suppressOutOfRegionManipulation=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"floatingItemToolbarEnabled",{get:function(){return this._floatingItemToolbarEnabled},set:function(e){this._floatingItemToolbarEnabled=e,e?this._addFloatingItemToolbars():this._removeFloatingItemToolbars()},enumerable:!0,configurable:!0}),Canvas.prototype.setViolationContainersEnabled=function(e,t){this._violationWarningButtonsEnabled=e,this._qualityChangeContainersEnabled=t,this._removeViolationContainers(),(e||t)&&this._addViolationContainers()},Object.defineProperty(Canvas.prototype,"violationWarningButtonsEnabled",{get:function(){return this._violationWarningButtonsEnabled},set:function(e){this._violationWarningButtonsEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"qualityChangeContainersEnabled",{get:function(){return this._qualityChangeContainersEnabled},set:function(e){this._qualityChangeContainersEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"maxFontSize",{get:function(){return this._maxFontSize},set:function(e){this._maxFontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"minFontSize",{get:function(){return this._minFontSize},set:function(e){this._minFontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"maxLeading",{get:function(){return this._maxLeading},set:function(e){this._maxLeading=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"minLeading",{get:function(){return this._minLeading},set:function(e){this._minLeading=e},enumerable:!0,configurable:!0}),Canvas.prototype.getCallService=function(e,t,n,i,o){void 0===o&&(o=null);var r=this,a=_Utils_Common__WEBPACK_IMPORTED_MODULE_8__.c.makeCancelable(new Promise(function(n,i){var a,s=[r.get_data(!0,o)];null!=t&&(s=s.concat(t)),s=s.concat(n,function(e,t,n){i({error:e,userContext:t,methodName:n})}),(a=r.service)[e].apply(a,__spread(s))}));return a.promise.then(function(e){"function"==typeof n&&n(e)}).catch(function(e){if(e instanceof _Exception__WEBPACK_IMPORTED_MODULE_17__.d)console.error("Exception of type "+e.name+": "+e.message);else if(!e.isCanceled){var t=e.error;"function"==typeof i&&i(t)}}),a},Canvas.prototype.updateColors=function(e){var t,n,i,o,r=this;void 0===e&&(e=null);var a=null!=e?new Array(e):this.getAllItemHandlers({onlyVisible:!0}),s=new Array;try{for(var l=__values(a),c=l.next();!c.done;c=l.next()){var h=c.value.getColorData();h.isEmpty()||s.push(h)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}if(0===s.length)return Promise.resolve();var u=this.getCallService("UpdateByColorData",JSON.stringify(s),function(e){var t,n,i=JSON.parse(e),o=function(e){var t=a.find(function(t){return t.item.id===e.id});null!=t&&t.setColorData(e)};try{for(var s=__values(i),l=s.next();!l.done;l=s.next())o(l.value)}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}r.redraw()},function(e){console.log(e)});try{for(var d=__values(a),_=d.next();!_.done;_=d.next()){_.value._updateActiveWebServiceCall(u)}}catch(e){i={error:e}}finally{try{_&&!_.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}return u.promise},Canvas.prototype.waitUpdate=function(e){void 0===e&&(e=null);var t=null!=e?e:this.getAllItemHandlers();return Promise.all(t.map(function(e){return e.waitUpdate()}))},Canvas.prototype.get_status=function(){return this._status},Canvas.prototype.get_surfaceCanvas=function(){return this._canvasElementHandler.surfaceCanvas},Object.defineProperty(Canvas.prototype,"multipleSelectionEnabled",{get:function(){return this._selection.get_multipleSelectionEnabled()},set:function(e){this._selection.set_multipleSelectionEnabled(e)},enumerable:!0,configurable:!0}),Canvas.prototype.get_mouseMoveTimeout=function(){return this._mouseMoveTimeout},Canvas.prototype.set_mouseMoveTimeout=function(e){this._mouseMoveTimeout=e},Canvas.prototype.get_disableSmoothing=function(){return this._disableSmoothing},Canvas.prototype.set_disableSmoothing=function(e){this._disableSmoothing=e},Canvas.prototype.getAllItemHandlers=function(e){e=function(e){null==e&&(e={});return underscore__WEBPACK_IMPORTED_MODULE_14__.defaults(e,{onlyVisible:!1,onlyUnlocked:!1,whiteListFilter:function(e){return!1}})}(e);var t=this;return this.get_layers().toArray().map(function(e){return e.itemHandlers.toArray()}).reduce(function(e,t){return e.concat(t)},[]).filter(function(n){if(e.whiteListFilter(n))return!0;var i=!0;return e.onlyVisible&&(i=(i=(i=i&&null!=n.layer&&n.layer.get_visible())&&n.visible)&&!n.get_permissions().get_noShow()),e.onlyUnlocked&&i&&(i=!n.get_layer().locked&&!t.isLockedOrDisabled(n)),e.onlyType&&i&&(Array.isArray(e.onlyType)||(e.onlyType=[e.onlyType]),i=!1,e.onlyType.some(function(e){if(n instanceof e)return i=!0,!0})),i})},Canvas.prototype.get_allHandlers=function(e){return this.getAllItemHandlers(e)},Canvas.prototype.updateTexts=function(e){void 0===e&&(e=null);for(var t=function(e){return e instanceof _ItemHandlers_BoundedTextItemHandler__WEBPACK_IMPORTED_MODULE_15__.a||e instanceof _ItemHandlers_PathBoundedTextItemHandler__WEBPACK_IMPORTED_MODULE_20__.a},n=t(e)?e.uniqueId:null,i=this.get_layers(),o=0,r=i.get_count();o<r;o++){var a=i.get_item(o);if(a.get_visible())for(var s=a.itemHandlers,l=0,c=s.get_count();l<c;l++){var h=s.get_item(l);h.uniqueId!==n&&t(h)&&h.visible&&!h.get_permissions().get_noShow()&&this._updateWrappingRectangles(h)}}},Object.defineProperty(Canvas.prototype,"backgroundImage",{set:function(e){this._backgroundImage=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"isSquaredBackground",{get:function(){return this._isSquaredBackground},set:function(e){if(this._isSquaredBackground=e,this.get_isInitialized()){var t="url("+this._backgroundImage+") repeat";this._isSquaredBackground||(t="transparent"),this.get_surfaceCanvas().style.background=t}},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"loadingImageUrl",{get:function(){return this._loadingImageUrl},set:function(e){"string"==typeof e&&this._loadingImageUrl!==e&&(this._loadingImageUrl=e,this._canvasRenderer.setLoadingImageUrl(e))},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"workspaceWidth",{get:function(){return this._workspaceWidth},enumerable:!0,configurable:!0}),Canvas.prototype.get_workspaceWidth=function(){return this.workspaceWidth},Object.defineProperty(Canvas.prototype,"workspaceHeight",{get:function(){return this._workspaceHeight},enumerable:!0,configurable:!0}),Canvas.prototype.get_workspaceHeight=function(){return this.workspaceHeight},Canvas.prototype.set_workspaceSize=function(e,t,n){Object(_Math__WEBPACK_IMPORTED_MODULE_11__.EqualsOfFloatNumbers)(this._workspaceWidth,e)&&Object(_Math__WEBPACK_IMPORTED_MODULE_11__.EqualsOfFloatNumbers)(this._workspaceHeight,t)||(this._workspaceWidth=e,this._workspaceHeight=t,this._workspaceSizeChangedEvent.notify(this,n))},Canvas.prototype.begin_initialization=function(){this._initialization=!0,this._prevWorkspaceSize={width:this._workspaceWidth,height:this._workspaceHeight},this.service.beginMultiCall()},Canvas.prototype.end_initialization=function(e){void 0===e&&(e=!1),this._initialization=!1,(e||this._workspaceWidth!==this._prevWorkspaceSize.width||this._workspaceHeight!==this._prevWorkspaceSize.height)&&this._workspaceSizeChangedEvent.notify(this,{}),this.service.endMultiCall()},Object.defineProperty(Canvas.prototype,"initialization",{get:function(){return this._initialization},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"rotationGripColor",{get:function(){return this._rotationGripColor},set:function(e){this._rotationGripColor=e,this._updateGripsAndHoverDiv()},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"resizeGripColor",{get:function(){return this._resizeGripColor},set:function(e){this._resizeGripColor=e,this._updateGripsAndHoverDiv()},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"rotationGripSize",{get:function(){return this._rotationGripSize},set:function(e){this._rotationGripSize=e,this._updateGripsAndHoverDiv()},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"resizeGripSize",{get:function(){return this._resizeGripSize},set:function(e){this._resizeGripSize=e,this._updateGripsAndHoverDiv()},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"resizeGripLineColor",{get:function(){return this._resizeGripLineColor},set:function(e){this._resizeGripLineColor=e,this._updateGripsAndHoverDiv()},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"rotationGripLineColor",{get:function(){return this._rotationGripLineColor},set:function(e){this._rotationGripLineColor=e,this._updateGripsAndHoverDiv()},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"rotationGripLineLength",{get:function(){return this._rotationGripLineLength},set:function(e){this._rotationGripLineLength=e,this._updateGripsAndHoverDiv()},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"placeholderButtonGroupCssClass",{get:function(){return this._placeholderButtonGroupCssClass},set:function(e){this._placeholderButtonGroupCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"floatingItemToolbarCssClass",{get:function(){return this._floatingItemToolbarCssClass},set:function(e){this._floatingItemToolbarCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"violationContainerCssClass",{get:function(){return this._violationContainerCssClass},set:function(e){this._violationContainerCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"selectImageButtonCssClass",{get:function(){return this._selectImageButtonCssClass},set:function(e){this._selectImageButtonCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"selectBarcodeButtonCssClass",{get:function(){return this._selectBarcodeButtonCssClass},set:function(e){this._selectBarcodeButtonCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"handleButtonCssClass",{get:function(){return this._handleButtonCssClass},set:function(e){this._handleButtonCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"doneButtonCssClass",{get:function(){return this._doneButtonCssClass},set:function(e){this._doneButtonCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"violationWarningButtonCssClass",{get:function(){return this._violationWarningButtonCssClass},set:function(e){this._violationWarningButtonCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"qualityChangeContainerCssClass",{get:function(){return this._qualityChangeContainerCssClass},set:function(e){this._qualityChangeContainerCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"qualityChangeScaleBarCssClass",{get:function(){return this._qualityChangeScaleBarCssClass},set:function(e){this._qualityChangeScaleBarCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"qualityBadToWarningChangeScaleBarCssClass",{get:function(){return this._qualityBadToWarningChangeScaleBarCssClass},set:function(e){this._qualityBadToWarningChangeScaleBarCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"qualityWarningToGoodChangeScaleBarCssClass",{get:function(){return this._qualityWarningToGoodChangeScaleBarCssClass},set:function(e){this._qualityWarningToGoodChangeScaleBarCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"qualityBadToGoodChangeScaleBarCssClass",{get:function(){return this._qualityBadToGoodChangeScaleBarCssClass},set:function(e){this._qualityBadToGoodChangeScaleBarCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"qualityNoAnimationChangeScaleBarCssClass",{get:function(){return this._qualityNoAnimationChangeScaleBarCssClass},set:function(e){this._qualityNoAnimationChangeScaleBarCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"qualityChangeInfoBarCssClass",{get:function(){return this._qualityChangeInfoBarCssClass},set:function(e){this._qualityChangeInfoBarCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"deleteToolbarButtonCssClass",{get:function(){return this._deleteToolbarButtonCssClass},set:function(e){this._deleteToolbarButtonCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"editToolbarButtonCssClass",{get:function(){return this._editToolbarButtonCssClass},set:function(e){this._editToolbarButtonCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"selectToolbarButtonCssClass",{get:function(){return this._selectToolbarButtonCssClass},set:function(e){this._selectToolbarButtonCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"bigButtonGroupCssClass",{get:function(){return this._bigButtonGroupCssClass},set:function(e){this._bigButtonGroupCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"goodViolationIconCssClass",{get:function(){return this._goodViolationIconCssClass},set:function(e){this._goodViolationIconCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"warningViolationIconCssClass",{get:function(){return this._warningViolationIconCssClass},set:function(e){this._warningViolationIconCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"badViolationIconCssClass",{get:function(){return this._violationBadIconCssClass},set:function(e){this._violationBadIconCssClass=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"selectButtonTitle",{get:function(){return this._selectButtonTitle},set:function(e){this.setSelectButtonTitle(e)},enumerable:!0,configurable:!0}),Canvas.prototype.setSelectButtonTitle=function(e,t){return void 0===t&&(t=!1),e=null!=e?e:"",this.selectButtonTitle!==e&&(this._selectButtonTitle=e,t||this.updatePlaceholderButtonGroups(),!0)},Object.defineProperty(Canvas.prototype,"editBarcodeButtonTitle",{get:function(){return this._editBarcodeButtonTitle},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"EditBarcodeButtonTitle",{set:function(e){this.setEditBarcodeButtonTitle(e)},enumerable:!0,configurable:!0}),Canvas.prototype.setEditBarcodeButtonTitle=function(e,t){return void 0===t&&(t=!1),e=null!=e?e:"",this.editBarcodeButtonTitle!==e&&(this._editBarcodeButtonTitle=e,t||this.updatePlaceholderButtonGroups(),!0)},Object.defineProperty(Canvas.prototype,"handleButtonTitle",{get:function(){return this._handleButtonTitle},set:function(e){this.setHandleButtonTitle(e)},enumerable:!0,configurable:!0}),Canvas.prototype.setHandleButtonTitle=function(e,t){return void 0===t&&(t=!1),e=null!=e?e:"",this.handleButtonTitle!==e&&(this._handleButtonTitle=e,t||this.updatePlaceholderButtonGroups(),!0)},Object.defineProperty(Canvas.prototype,"doneButtonTitle",{get:function(){return this._doneButtonTitle},set:function(e){this.setDoneButtonTitle(e)},enumerable:!0,configurable:!0}),Canvas.prototype.setDoneButtonTitle=function(e,t){return void 0===t&&(t=!1),e=null!=e?e:"",this.doneButtonTitle!==e&&(this._doneButtonTitle=e,t||this.updatePlaceholderButtonGroups(),!0)},Object.defineProperty(Canvas.prototype,"deleteButtonTitle",{get:function(){return this._deleteButtonTitle},set:function(e){this.setDeleteButtonTitle(e)},enumerable:!0,configurable:!0}),Canvas.prototype.setDeleteButtonTitle=function(e,t){return void 0===t&&(t=!1),e=null!=e?e:"",this.deleteButtonTitle!==e&&(this._deleteButtonTitle=e,t||this.updatePlaceholderButtonGroups(),!0)},Object.defineProperty(Canvas.prototype,"editButtonTitle",{get:function(){return this._editButtonTitle},set:function(e){this.setEditButtonTitle(e)},enumerable:!0,configurable:!0}),Canvas.prototype.setEditButtonTitle=function(e,t){return void 0===t&&(t=!1),e=null!=e?e:"",this.editButtonTitle!==e&&(this._editButtonTitle=e,t||this.updatePlaceholderButtonGroups(),!0)},Canvas.prototype.get_screenXDpi=function(){return _Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.screenDpi},Canvas.prototype.get_screenYDpi=function(){return _Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.screenDpi},Canvas.prototype.get_zoom=function(){return this.zoom},Canvas.prototype.set_zoom=function(e,t,n){null==n&&(n={}),null==n.force&&(n.force=!1),null==n.updateButtonGroup&&(n.updateButtonGroup=!0),(e!==this._zoom||n.force)&&(this._zoom=e,this._initialization||(this._updateCanvasElementSize(n.updateButtonGroup),t||this._zoomChangedEvent.notify(this,{})))},Object.defineProperty(Canvas.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"autoPlaceholderEditModeEnabled",{get:function(){return this._autoPlaceholderEditModeEnabled},set:function(e){void 0!=e&&null!=e&&(this._autoPlaceholderEditModeEnabled=e)},enumerable:!0,configurable:!0}),Canvas.prototype.calcPlatformLimitZoom=function(){var e=_Utils_Convert__WEBPACK_IMPORTED_MODULE_19__.c(this.get_workspaceWidth(),this.get_screenXDpi()),t=_Utils_Convert__WEBPACK_IMPORTED_MODULE_19__.c(this.get_workspaceHeight(),this.get_screenYDpi()),n=function(n){return Math.sqrt(n/(e*t))},i=function(n,i){return Math.min(n/e,i/t)};if(_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.IsIos()){var o=_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.GetIosVersion();return n("number"==typeof o[0]&&o[0]>=9&&"number"==typeof o[1]&&o[1]>=3?16e6:5e6)}return _Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.IsIE()||_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.IsEdge()?i(8192,8192):_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.IsGoogleChrome()?Math.min(i(32767,32767),n(268435456)):_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.IsSafari()?Math.min(i(32767,32767)):_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.IsFirefox()?Math.min(i(32767,32767),n(472907776)):2147483647},Canvas.prototype._updateCanvasElementSize=function(e){var t=this.get_width(),n=this.get_height();this._canvasElementSize||(this._canvasElementSize={});var i=this._canvasElementSize;t===i.width&&n===i.height||(i.width=t,i.height=n,this._canvasElementHandler.updateElementSize(t,n)),(null==e||e)&&this.updateButtonGroups()},Canvas.prototype.updateSelection=function(){if(this.get_selectedItemHandlers().where(function(e){return!e.isVisible()}).toArray().length>0){var e=this.get_selectedItemHandlers().where(function(e){return e.isVisible()}).toArray();this.set_selectedItemHandlers(e)}if(this._selection.update(),this._floatingItemToolbarEnabled){var t=this.get_selectedItemHandlers(),n=null!=t?t.get_item(0):null;null!=n&&null!=n.floatingItemToolbar&&this.isOnlyThisItemHandlerSelected(n)&&this.updateFloatingItemToolbar(n)}},Canvas.prototype.get_selectedItemHandlers=function(){return this._selection.get_selectedItemHandlers()},Canvas.prototype.set_selectedItemHandlers=function(e){this._selection.set_selectedItemHandlers(e),this.redrawDesign()},Canvas.prototype.isItemHandlerSelected=function(e){return this._selection.isItemHandlerSelected(e)},Canvas.prototype.isOnlyThisItemHandlerSelected=function(e){return this._selection.isOnlyThisItemHandlerSelected(e)},Canvas.prototype.addSelectedItemHandler=function(e){this._selection.addSelectedItemHandler(e)},Canvas.prototype.removeSelectedItemHandler=function(e){this._selection.removeSelectedItemHandler(e)},Canvas.prototype.clearSelectedItemHandlers=function(){this._selection.clearSelectedItemHandlers()},Canvas.prototype.get_currentItemHandler=function(){return this._selection.get_currentItemHandler()},Canvas.prototype._onDragNDropStarting=function(e){this._dragNDropStartingEvent.notify(this,e)},Canvas.prototype._onDragNDropDone=function(){this._dragNDropDoneEvent.notify(this)},Canvas.prototype._onDragNDropPerformed=function(e){this._dragNDropPerformedEvent.notify(this,e),this._currentItemHandlerChangedEvent.notify(this)},Canvas.prototype.onCurrentItemHandlerChanged=function(e){null==e&&this._viewer.set_cursor(_Utils_Common__WEBPACK_IMPORTED_MODULE_8__.a.defaultCursor),this._currentItemHandlerChangedEvent.notify(this)},Object.defineProperty(Canvas.prototype,"layers",{get:function(){return this._layers},set:function(e){this._layers=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"disabledLayers",{get:function(){return this._disabledLayers},set:function(e){this._disabledLayers=e},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"maskedLayers",{get:function(){return this._maskedLayers},set:function(e){this._maskedLayers=e},enumerable:!0,configurable:!0}),Canvas.prototype.get_layers=function(){return this.layers},Canvas.prototype.set_layers=function(e){this.layers=e},Canvas.prototype.get_data=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=null);var n=new _CanvasData__WEBPACK_IMPORTED_MODULE_10__.a(this,e,t);return JSON.stringify(n)},Canvas.prototype.set_data=function(e){if(e&&""!=e){var t=JSON.parse(e);_CanvasData__WEBPACK_IMPORTED_MODULE_10__.a.applyState(t,this)}},Canvas.prototype.get_returnValue=function(){return this._returnValue},Canvas.prototype._callbackSuccess=function(message,context){this._onRequestComplete(),context==this._callbackContext&&(eval(message),this._callbackComplete())},Canvas.prototype._callbackError=function(e,t){this._onRequestComplete(),this._exceptionDescription=e,this._callbackComplete(),this._raiseCallbackException(e)},Canvas.prototype._callbackComplete=function(){this._callbackCount--,0==this._callbackCount&&(this._status=_UpdateStatus__WEBPACK_IMPORTED_MODULE_9__.a.ready,this.redraw(),this._statusChangedEvent.notify(this))},Canvas.prototype._onSendingRequest=function(){this._sendingRequestEvent.notify(this)},Canvas.prototype._onRequestComplete=function(){this._requestCompleteEvent.notify(this)},Canvas.prototype._raiseCallbackException=function(e){if(!(this._callbackExceptionEvent.listenersCount()>0))throw e;this._callbackExceptionEvent.notify(e)},Canvas.prototype.add_sendingRequest=function(e){this._sendingRequestEvent.add(e)},Canvas.prototype.remove_sendingRequest=function(e){this._sendingRequestEvent.remove(e)},Canvas.prototype.add_requestComplete=function(e){this._requestCompleteEvent.add(e)},Canvas.prototype.remove_requestComplete=function(e){this._requestCompleteEvent.remove(e)},Canvas.prototype.add_zoomChanged=function(e){this._zoomChangedEvent.add(e)},Canvas.prototype.remove_zoomChanged=function(e){this._zoomChangedEvent.remove(e)},Canvas.prototype.add_statusChanged=function(e){this._statusChangedEvent.add(e)},Canvas.prototype.remove_statusChanged=function(e){this._statusChangedEvent.remove(e)},Canvas.prototype.add_callbackException=function(e){this._callbackExceptionEvent.add(e)},Canvas.prototype.remove_callbackException=function(e){this._callbackExceptionEvent.remove(e)},Canvas.prototype.add_initialized=function(e){this._initializedEvent.add(e)},Canvas.prototype.remove_initialized=function(e){this._initializedEvent.remove(e)},Canvas.prototype.add_invokingCallbackRequest=function(e){this._invokingCallbackRequestEvent.add(e)},Canvas.prototype.remove_invokingCallbackRequest=function(e){this._invokingCallbackRequestEvent.remove(e)},Canvas.prototype.raiseMouseMove=function(e){this._onMouseMove(e)},Canvas.prototype.raiseMouseUp=function(e){this._onMouseUp(e)},Canvas.prototype.raiseMouseDown=function(e){this._onMouseDown(e)},Canvas.prototype.raiseDoubleClick=function(e){this._onDoubleClick(e)},Canvas.prototype.raiseKeyDown=function(e){this._keyEventEnabled&&this._onKeyDown(e)},Canvas.prototype.raiseKeyUp=function(e){this._keyEventEnabled&&this._onKeyUp(e)},Canvas.prototype.add_itemHandlerCreated=function(e){this._itemHandlerCreatedEvent.add(e)},Canvas.prototype.remove_itemHandlerCreated=function(e){this._itemHandlerCreatedEvent.remove(e)},Canvas.prototype.add_currentItemHandlerChanged=function(e){this._currentItemHandlerChangedEvent.add(e)},Canvas.prototype.remove_currentItemHandlerChanged=function(e){this._currentItemHandlerChangedEvent.remove(e)},Canvas.prototype.add_selectedItemHandlerChanged=function(e){this._selectedItemHandlersChangedEvent.add(e)},Canvas.prototype.remove_selectedItemHandlerChanged=function(e){this._selectedItemHandlersChangedEvent.remove(e)},Canvas.prototype.add_selectedItemHandlersDeleting=function(e){this._selectedItemHandlersDeletingEvent.add(e)},Canvas.prototype.remove_selectedItemHandlersDeleting=function(e){this._selectedItemHandlersDeletingEvent.remove(e)},Canvas.prototype.add_dragNDropDone=function(e){this._dragNDropDoneEvent.add(e)},Canvas.prototype.remove_dragNDropDone=function(e){this._dragNDropDoneEvent.remove(e)},Canvas.prototype.add_dragNDropStarting=function(e){this._dragNDropStartingEvent.add(e)},Canvas.prototype.remove_dragNDropStarting=function(e){this._dragNDropStartingEvent.remove(e)},Canvas.prototype.add_dragNDropPerformed=function(e){this._dragNDropPerformedEvent.add(e)},Canvas.prototype.remove_dragNDropPerformed=function(e){this._dragNDropPerformedEvent.remove(e)},Canvas.prototype.add_ready=function(e){this._readyEvent.add(e)},Canvas.prototype.remove_ready=function(e){this._readyEvent.remove(e)},Canvas.prototype.add_workspaceSizeChanged=function(e){this._workspaceSizeChangedEvent.add(e)},Canvas.prototype.remove_workspaceSizeChanged=function(e){this._workspaceSizeChangedEvent.remove(e)},Canvas.prototype.add_layersUpdated=function(e){this._layersUpdatedEvent.add(e)},Canvas.prototype.remove_layersUpdated=function(e){this._layersUpdatedEvent.remove(e)},Canvas.prototype.addElement=function(e){null!=this._viewer&&(this._removeElement(),this._parent=e,this._document=e.ownerDocument,this._document&&this._canvasElementHandler.addElement(this._parent,this._viewer.get_whitespaceDiv(),this.get_width(),this.get_height()))},Canvas.prototype._removeElement=function(){this._canvasElementHandler.removeElement(),this._document=null},Object.defineProperty(Canvas.prototype,"hoverDiv",{get:function(){return this._canvasElementHandler.hoverDiv},enumerable:!0,configurable:!0}),Canvas.prototype.addStyles=function(){this._canvasElementHandler.addStyles()},Canvas.prototype.updateHoverDiv=function(){this._canvasElementHandler.updateHoverDiv()},Canvas.prototype._updateGripsAndHoverDiv=function(){this._canvasElementHandler.updateSelectionDiv(),this._canvasElementHandler.updateHoverDiv()},Canvas.prototype.showDnd=function(e,t){this._canvasElementHandler.showDnd(e,t,this._viewer.get_contentAngle())},Canvas.prototype.hideDnd=function(){this._canvasElementHandler.hideDnd()},Canvas.prototype.showSelection=function(e,t){this._canvasElementHandler.showSelection(e,t,this._viewer)},Canvas.prototype.hideSelection=function(){this._canvasElementHandler.hideSelection()},Canvas.prototype.showHover=function(e,t){this._canvasElementHandler.showHover(e,t,this._viewer)},Canvas.prototype.updateHoverPosition=function(e,t){this._canvasElementHandler.updateHoverPosition(e,this._viewer,t)},Canvas.prototype.hideHover=function(){this._canvasElementHandler.hideHover()},Canvas.prototype._isPlaceholder=function(e){return e instanceof _ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a},Canvas.prototype._isImage=function(e){return e instanceof _ItemHandlers_ImageItemHandler__WEBPACK_IMPORTED_MODULE_2__.a},Canvas.prototype._isImageOrPlaceholder=function(e){return this._isImage(e)||this._isPlaceholder(e)},Canvas.prototype._addFloatingItemToolbars=function(){if(null!=this._viewer)for(var e=this.get_allHandlers(),t=0;t<e.length;t++)this.addFloatingItemToolbar(e[t])},Canvas.prototype._removeFloatingItemToolbars=function(){if(null!=this._viewer)for(var e=this.get_allHandlers(),t=0;t<e.length;t++)this._canvasElementHandler.removeFloatingItemToolbar(e[t])},Canvas.prototype._addViolationContainers=function(){if(null!=this._viewer)for(var e=this.get_allHandlers(),t=0;t<e.length;t++)this.addViolationContainer(e[t])},Canvas.prototype._removeViolationContainers=function(){var e,t;if(null!=this._viewer){var n=this.get_allHandlers();try{for(var i=__values(n),o=i.next();!o.done;o=i.next()){var r=o.value;this.removeViolationContainer(r);var a=r.getViolationWarningButton();if(null!=a&&a.remove(),r instanceof _ItemHandlers_ImageItemHandler__WEBPACK_IMPORTED_MODULE_2__.a||r instanceof _ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a){var s=void 0;null!=(s=(_ItemHandlers_ImageItemHandler__WEBPACK_IMPORTED_MODULE_2__.a,r.qualityChangeContainer))&&s.remove()}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}}},Canvas.prototype.addPlaceholderButtonGroup=function(e){this._canvasElementHandler.addPlaceholderButtonGroup(e,this._viewer)},Canvas.prototype.addFloatingItemToolbar=function(e){this._canvasElementHandler.addFloatingItemToolbar(e,this._viewer)},Canvas.prototype.addViolationContainer=function(e){this._canvasElementHandler.addViolationContainer(e,this._viewer)},Canvas.prototype.removePlaceholderButtonGroup=function(e){this._canvasElementHandler.removePlaceholderButtonGroup(e)},Canvas.prototype.removeFloatingItemToolbar=function(e){this._canvasElementHandler.removeFloatingItemToolbar(e)},Canvas.prototype.removeViolationContainer=function(e){this._canvasElementHandler.removeViolationContainer(e)},Canvas.prototype.updateButtonGroups=function(e){void 0===e&&(e={onlyVisible:!0,floatingItemToolbar:!0,violationContainers:!0,placeholderButtons:!0}),!0===e.floatingItemToolbar&&this.updateFloatingItemToolbars(e.onlyVisible),!0===e.violationContainers&&this.updateViolationContainers(!0,e.onlyVisible),!0===e.placeholderButtons&&this.updatePlaceholderButtonGroups(e.onlyVisible)},Canvas.prototype.updateFloatingItemToolbars=function(e){if(this._floatingItemToolbarEnabled)for(var t=this.get_allHandlers({onlyVisible:e}),n=0;n<t.length;n++)this.updateFloatingItemToolbar(t[n])},Canvas.prototype.updateViolationContainers=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._violationWarningButtonsEnabled||this._qualityChangeContainersEnabled)for(var n=this.get_allHandlers({onlyVisible:t}),i=0;i<n.length;i++)this.updateViolationContainer(n[i],e)},Canvas.prototype.updatePlaceholderButtonGroups=function(e){void 0===e&&(e=!1);for(var t=this.get_allHandlers({onlyType:_ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a,onlyVisible:e}),n=0;n<t.length;n++)this.updatePlaceholderButtonGroup(t[n])},Canvas.prototype.updatePlaceholderButtonGroup=function(e){this._canvasElementHandler.updatePlaceholderButtonGroup(e,this._viewer)},Canvas.prototype.updateViolationContainer=function(e,t){void 0===t&&(t=!1),this._canvasElementHandler.updateViolationContainer(e,t,this._viewer)},Canvas.prototype.updateFloatingItemToolbar=function(e){this._canvasElementHandler.updateFloatingItemToolbar(e,this._viewer)},Canvas.prototype.updatePlaceholderButtonGroupPosition=function(e){this._canvasElementHandler.updatePlaceholderButtonGroupPosition(e,this._viewer)},Canvas.prototype.updateViolationContainerPosition=function(e){this._canvasElementHandler.updateViolationContainerPosition(e,this._viewer)},Canvas.prototype._placeholderButtonGroupHitTest=function(e,t){return null!=this._viewer&&null!=this._parent&&null!=e&&null!=e.placeholderButtonGroup&&this._getPlaceholderButtonGroupRect(e.placeholderButtonGroup).contains(t)},Canvas.prototype._floatingItemToolbarHitTest=function(e){if(null==this._viewer||null==this._parent||!this._floatingItemToolbarEnabled)return!1;var t=this._get_selectedHandler();return null!=t&&null!=t.floatingItemToolbar&&this.getButtonGroupRectInGripsDiv(t.floatingItemToolbar).contains(e)},Canvas.prototype.violationWarningButtonHitTestObject=function(e){if(null==this._viewer||null==this._parent||!this._violationWarningButtonsEnabled)return null;for(var t=this.get_allHandlers({onlyVisible:!0}),n=0;n<t.length;n++){var i=t[n].getViolationWarningButton();if(null!=i)if(this.getButtonGroupRectInGripsDiv(i).contains(e))return t[n]}return null},Canvas.prototype._getPlaceholderButtonGroupRect=function(e){var t=this._viewer.getParentPosition(this._parent.parentElement),n=e.offsetLeft+t.left,i=e.offsetTop+t.top,o=e.offsetWidth,r=e.offsetHeight,a=new _Utils_Common__WEBPACK_IMPORTED_MODULE_8__.b(n,i,o,r),s=this._viewer.controlToWorkspaceRectangle(a),l=new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(s.x,s.y,s.width,s.height);return _Math__WEBPACK_IMPORTED_MODULE_11__.RotatedRectangleF.fromRectangleF(l).bounds},Canvas.prototype.getButtonGroupRectInGripsDiv=function(e,t){void 0===t&&(t=!1);var n=this._viewer.get_element().getBoundingClientRect(),i=e.getBoundingClientRect(),o=new _Utils_Common__WEBPACK_IMPORTED_MODULE_8__.b(i.left-n.left,i.top-n.top,e.offsetWidth,e.offsetHeight),r=this._viewer.controlToWorkspaceRectangle(o),a=new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(r.x,r.y,r.width,r.height),s=_Math__WEBPACK_IMPORTED_MODULE_11__.RotatedRectangleF.fromRectangleF(a),l=this._viewer.get_contentAngle();return l>0&&!t&&(s.rotateAt(-l,new _Math__WEBPACK_IMPORTED_MODULE_11__.PointF),90===l?s.translate(0,this.get_workspaceHeight()):180===l?s.translate(this.get_workspaceWidth(),this.get_workspaceHeight()):270===l&&s.translate(this.get_workspaceWidth(),0)),s.bounds},Canvas.prototype.redraw=function(){this._throttleRedraw()},Canvas.prototype._redraw=function(e){void 0===e&&(e=!0),!this.get_isInitialized()||this.get_isUpdating()||this._initialization||(e&&this._canvasElementHandler.calculateRenderStateForItemHandlers(this.layers),this._canvasRenderer.redrawInactiveCanvas(this.layers,this._canvasElementHandler.surfaceCanvas,this._canvasElementHandler.inactiveCanvas),this._canvasRenderer.redrawActiveCanvas(this.layers,this._canvasElementHandler.activeCanvas,this._canvasElementHandler.designCanvas))},Canvas.prototype.redrawDesign=function(){this._canvasRenderer.redrawActiveCanvas(this.layers,this._canvasElementHandler.activeCanvas,this._canvasElementHandler.designCanvas)},Canvas.prototype.drawWaitClock=function(e,t){this._canvasRenderer.drawWaitClock(e,t)},Canvas.prototype.workspaceToControl=function(e){var t=e.clone(),n=this.get_screenXDpi()/72*this.get_zoom();return t.scale(n,n),t.round()},Canvas.prototype.controlToWorkspace=function(e){var t=e.clone(),n=72/(this.get_screenXDpi()*this.get_zoom());return t.scale(n,n),t},Canvas.prototype._onClick=function(e){if(e.type="click",null!=e.x&&null!=e.y){var t=e instanceof _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b?e:new _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b(e);this._processMouseEvent(t)}},Canvas.prototype._onKeyDown=function(e){if("keydown"!==e.type)throw new Error("fix this!");this._processKeyEvent(e)},Canvas.prototype._onKeyUp=function(e){if("keyup"!==e.type)throw new Error("fix this!");this._processKeyEvent(e)},Canvas.prototype._isPrimaryPointer=function(e){var t=e.originalEvent;return t instanceof MouseEvent&&(null!=t.button||null!=t.which)?null!=t.button?0===t.button:1===t.which:t instanceof TouchEvent?1===t.touches.length||0===t.touches.length:t instanceof PointerEvent?t.isPrimary:e.which>0&&1===e.which},Canvas.prototype._onMouseMove=function(e){if(e.type="mousemove",null!=e.x&&null!=e.y){var t=e instanceof _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b?e:new _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b(e);this._processMouseEvent(t)}},Canvas.prototype._onMouseUp=function(e){if(e.type="mouseup",null!=e.x&&null!=e.y&&this._isPrimaryPointer(e)){var t=e instanceof _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b?e:new _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b(e);this._processMouseEvent(t)}},Canvas.prototype._onMouseDown=function(e){if(e.type="mousedown",null!=e.x&&null!=e.y&&this._isPrimaryPointer(e)){var t=e instanceof _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b?e:new _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b(e);this._processMouseEvent(t)}},Canvas.prototype._onDoubleClick=function(e){if(e.type="dblclick",null!=e.x&&null!=e.y){var t=e instanceof _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b?e:new _Viewer_BaseViewer__WEBPACK_IMPORTED_MODULE_23__.b(e);this._processMouseEvent(t)}},Canvas.prototype.isSelectionByHitTest=function(e){return this._selection.get_visibleRectangle().contains(e)},Canvas.prototype.getItemHandlersByHitTest=function(e){for(var t=[],n=this.get_layers().get_count()-1;n>=0;n--){var i=this.get_layers().get_item(n);if(i.get_visible()&&!i.locked)for(var o=i.itemHandlers.get_count()-1;o>=0;o--){var r=i.itemHandlers.get_item(o);if(r.visible&&!this.isLockedOrDisabled(r)&&!r.get_permissions().get_noShow())r.hitTest(e).body&&t.push(r)}}return t},Canvas.prototype._getHandlerForSelect=function(e,t,n){var i=this;if(null!=e&&0!==e.length){var o=n.originalEvent.shiftKey||n.originalEvent.metaKey||n.originalEvent.ctrlKey,r=e.findIndex(function(e){return i.isItemHandlerSelected(e)}),a=e[0],s=this.get_contentEditingPlaceholderItemHandler();if(null!=s&&s.content.hitTest(t).body)return s;if(!(this.get_selectedItemHandlers().length>1&&this._selection.get_visibleRectangle().bounds.contains(t))||o||"dblclick"==n.type)return r>0&&!e[r].bounds.containsRectangle(a.bounds)&&!o?e[r]:a}},Canvas.prototype._processSelection=function(e,t){if(null!=e){var n=t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey;this.isItemHandlerSelected(e)?n?this.removeSelectedItemHandler(e):this._selection.set_currentItemHandler(e):n?this.addSelectedItemHandler(e):this.set_selectedItemHandlers([e])}},Canvas.prototype._processKeyEvent=function(e){if("keydown"===e.type||"keyup"===e.type)if("keydown"===e.type&&"Delete"===e.code)this.deleteSelectedItemHandlers(!0);else if("keydown"===e.type&&(e.ctrlKey||e.metaKey))switch(e.code){case"KeyZ":this._history.undo();break;case"KeyY":this._history.redo()}else this._selection.processKeyEvent(e),this.redrawDesign()},Canvas.prototype._processMouseEvent=function(e){var t=this,n=new _Math__WEBPACK_IMPORTED_MODULE_11__.PointF(e.x,e.y),i=this.getItemHandlersByHitTest(n),o=this._getHandlerForSelect(i,n,e),r=o instanceof _ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a&&this._placeholderButtonGroupHitTest(o,n),a=this._placeholderHandleButtonGroupHitTest(n),s=!!this._isShowFloatingItemToolbar()&&this._floatingItemToolbarHitTest(n),l=this._selection.hitTest(n,e.originalEvent.shiftKey),c=l.body||l.resize||l.rotate;!this.canvasItemHoverEnabled||l.resize||l.rotate||this._isMouseButtonPressed?this.hideHover():this._hoverHandler.processMouseEvent(e,o);var h=c||this.isResizing()||!this._violationWarningButtonsEnabled?null:this.violationWarningButtonHitTestObject(n),u=null!=h,d=this.get_contentUpdatingPlaceholderItemHandler(),_=null!=this._viewer?this._viewer.get_whitespaceDiv():null;null!=_&&(_.style.pointerEvents=a||r?"none":"auto");if("mousedown"===e.type||"dblclick"===e.type){var p=this.get_contentEditingPlaceholderItemHandler();if(null!=o){a||s||u||l.resize||l.rotate||this._processSelection(o,e);var g=this._get_selectedPlaceholderItemHandler();!a||this._isMouseButtonPressed||null==g||this.autoPlaceholderEditModeEnabled?null==g||!this._autoPlaceholderEditModeEnabled||this._isMouseButtonPressed||g.editing||g.onHandleButtonMouseDown():g.showHandleButton()?g.onHandleButtonMouseDown():g.editing&&g.get_permissions(!0).get_showDoneButton()&&g.onDoneButtonClick()}else c||s||u||!t._viewer.clearSelectionOnViewerClick||this.clearSelectedItemHandlers();null!=p&&c&&(p.setContentUpdating(!0),this.updatePlaceholderButtonGroups()),this._mouseDownTimeStamp=(new Date).getTime(),"dblclick"===e.type&&null!=this.get_currentItemHandler()&&(this._viewer.selectedItems.length>1?null!=o&&(this.clearSelectedItemHandlers(),o.dispatchDoubleClickEvent(e),this.addSelectedItemHandler(o)):this.get_currentItemHandler().dispatchDoubleClickEvent(e)),"dblclick"!==e.type&&(this._isMouseButtonPressed=!0)}else if("mouseup"===e.type)this._isMouseButtonPressed=!1,null!=d&&d.onPlaceholderButtonMouseUp.apply(d),delete this._mouseDownTimeStamp,delete this._cursor,null!=this._rotateHandler.rotateDiv&&this._rotateHandler.removeRotateDiv(),this._viewer.selectedItems.length>0&&this._rotation(this.get_currentItemHandler(),n,!0);else if("mousemove"===e.type){for(var f=this.get_allHandlers({onlyVisible:!0,onlyType:_ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a}),v=0;v<f.length;v++){var m=f[v],y=m.placeholderButtonGroup;this.isItemHandlerSelected(m)||null==y||(y.style.pointerEvents="none")}if(a||r)if(o instanceof _ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a&&null!=o.placeholderButtonGroup)o.placeholderButtonGroup.style.pointerEvents="auto";else{var C=this._get_selectedPlaceholderItemHandler();null!=C&&null!=C.placeholderButtonGroup&&(C.placeholderButtonGroup.style.pointerEvents="auto")}var b=this._get_selectedHandler();if(null!=b&&null!=b.floatingItemToolbar&&this._floatingItemToolbarEnabled){var E=b.floatingItemToolbar;l.rotate||l.resize?E.style.pointerEvents="none":E.style.pointerEvents="auto"}if(u){var w=h.getViolationWarningButton();l.rotate||l.resize?w.style.pointerEvents="none":w.style.pointerEvents="auto"}if(this._viewer.selectedItems.length>0&&this._isMouseButtonPressed&&this._rotation(b,n),null!=this._mouseDownTimeStamp&&(new Date).getTime()-this._mouseDownTimeStamp<this.get_mouseMoveTimeout())return}var D=this._cursor,P=null!=D;if(d=this.get_contentUpdatingPlaceholderItemHandler(),null==D&&(l.resize||l.rotate||null==o||this.isItemHandlerSelected(o)||r?null==d||l.resize||l.rotate?D=r?_Utils_Common__WEBPACK_IMPORTED_MODULE_8__.a.defaultCursor:this._selection.get_cursor(n):(D=_Utils_Common__WEBPACK_IMPORTED_MODULE_8__.a.move,P=!0):D=_Utils_Common__WEBPACK_IMPORTED_MODULE_8__.a.pointer),this._viewer.set_cursor(D,P),"mousemove"!==e.type&&(this._cursor="mousedown"===e.type?D:null),this._selection.processMouseEvent(e),(a||d||this._selection.isResizing())&&"mouseup"!==e.originalEvent.type||this._dndHandler.processMouseEvent(e),"mousemove"===e.type){var M=this._selection.isOperationNotNull(),I=null!=l.selection&&this._isMouseButtonPressed;(M||I||this._dndHandler.isDragStarted())&&this.redrawDesign()}else"mouseup"===e.type&&this.redrawDesign()},Canvas.prototype._buttonsShow=function(e){e.classList.remove("buttonsHidden"),e.classList.add("buttonsShown")},Canvas.prototype._buttonsHidden=function(e){e.classList.remove("buttonsShown"),e.classList.add("buttonsHidden")},Canvas.prototype._rotation=function(e,t,n){var i=this,o=document.querySelectorAll("#resize-left-top, #resize-right-top, #resize-right-bottom, #resize-left-bottom, #rotate-circle, #resize-width-left, #resize-width-right, #resize-height-top, #resize-height-bottom"),r=this._viewer.get_contentAngle(),a=null!=e&&this._isPlaceholder(e)?e:null,s=function(){o.forEach(function(e){i._buttonsShow(e)}),null!=a&&(null!=a.handleButton&&i._buttonsShow(a.handleButton),null!=a.selectButton&&i._buttonsShow(a.selectButton)),i._rotateHandler.removeRotateDiv()},l=this._viewer.get_element(),c=this._rotateHandler.calculatePositionRotateDiv(r,Math.max(0,i._viewer.getParentPosition(i._parent.parentElement).left),Math.max(0,i._viewer.getParentPosition(i._parent.parentElement).top),t,this._parent.parentElement.offsetWidth,this._parent.parentElement.offsetHeight),h=l.scrollTop,u=l.scrollLeft,d=l.scrollWidth>l.clientWidth&&0==u||u>0,_=l.scrollHeight>l.clientHeight&&0==h||h>0,p=_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.IsTouchDevice()?0:17,g=35+(d?p:0),f=58+(_?p:0),v=this._viewer.get_height()-g+h,m=this._viewer.get_width()-f+u;c.y>v?c.y=v:c.y<h&&(c.y=h),c.x>m?c.x=m:c.x<u&&(c.x=u),this._selection.isRotating()?(o.forEach(function(e){i._buttonsHidden(e)}),null!=a&&(null!=a.handleButton&&this._buttonsHidden(a.handleButton),null!=a.selectButton&&this._buttonsHidden(a.selectButton)),null==this._rotateHandler.rotateDiv?this._rotateHandler.addRotateDiv(c.y,c.x):this._rotateHandler.updateRotatePositionDiv(c.y,c.x)):s(),n&&s(),this.updatePlaceholderButtonGroups()},Canvas.prototype.get_contentUpdatingPlaceholderItemHandler=function(){var e=this._get_selectedPlaceholderItemHandler();return null!=e&&e.isContentUpdating()?e:null},Canvas.prototype.get_contentEditingPlaceholderItemHandler=function(){var e=this._get_selectedPlaceholderItemHandler();return null!=e&&e.editing?e:null},Canvas.prototype._get_selectedPlaceholderItemHandler=function(){var e=this._get_selectedHandler();return e instanceof _ItemHandlers_PlaceholderItemHandler__WEBPACK_IMPORTED_MODULE_1__.a?e:null},Canvas.prototype._get_selectedHandler=function(){var e=this.get_selectedItemHandlers();return 1===e.get_count()?e.get_item(0):null},Canvas.prototype._isShowFloatingItemToolbar=function(e){var t=this._get_selectedHandler(),n=!!e&&this.isOnlyThisItemHandlerSelected(e),i=!!e&&(this._autoPlaceholderEditModeEnabled&&this._isPlaceholder(e));return null!=t&&n&&t.isVisible()&&!i&&this._floatingItemToolbarEnabled&&(t.showDeleteToolbarButton()&&!this.simpleMode||t.showEditToolbarButton()||this._isImageOrPlaceholder(t)&&t.showSelectToolbarButton())&&!this._selection.isOperationNotNull()&&null==this.get_contentEditingPlaceholderItemHandler()&&null==this.get_contentUpdatingPlaceholderItemHandler()},Canvas.prototype._placeholderHandleButtonGroupHitTest=function(e){var t=this._get_selectedPlaceholderItemHandler();return null!=t&&null!=t.placeholderButtonGroup&&this._getPlaceholderButtonGroupRect(t.placeholderButtonGroup).contains(e)},Canvas.prototype.isResizing=function(){return this._selection.isResizing()},Canvas.prototype.get_isInitialized=function(){return this._initialized},Canvas.prototype.get_isUpdating=function(){return!1},Canvas.prototype.initialize=function(){var e=this;this.begin_initialization(),_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.IsTouchDevice()&&(this.rotationGripSize=24),this._onSelectedItemHandlersChangedDelegate=function(t){e.updateButtonGroups(),e._selection.update(),e._canvasElementHandler.calculateRenderStateForItemHandlers(e.layers)&&e._redraw(!1),e._selectedItemHandlersChangedEvent.notify(null)},this.get_selectedItemHandlers().add_itemAdded(this._onSelectedItemHandlersChangedDelegate),this.get_selectedItemHandlers().add_itemRemoved(this._onSelectedItemHandlersChangedDelegate),this._onSelectedItemHandlersDeletingDelegate=this._deleteSelectedItemHandlersWithoutConfirm.bind(this),this._canvasRenderer.setLoadingImageUrl(this._loadingImageUrl),this._document=document,this.redraw(),this._initialized=!0,this._initializedEvent.notify(null),this._checkReady(),this.end_initialization()},Canvas.prototype.checkReady=function(){this._ready=!1,this._checkReady()},Canvas.prototype._checkReady=function(){var e=this;if(!this._ready){for(var t=this.get_layers(),n=[],i=0,o=t.get_count();i<o;i++)for(var r=t.get_item(i).itemHandlers,a=0,s=r.get_count();a<s;a++){var l=r.get_item(a);l.ready||n.push(l)}if(0===n.length)this._ready=!0,this._readyEvent.notify(this);else{var c=function(t,i){for(var o=0,r=n.length;o<r;o++)if(n[o]==t){n[o].remove_ready(c),n.splice(o,1);break}0===n.length&&(e._ready=!0,e._readyEvent.notify(e))};for(i=0,o=n.length;i<o;i++)n[i].add_ready(c)}}},Canvas.prototype._getItemHandlerWrappingRectangle=function(e){switch(e.item.textWrappingMode){case _ItemHandlers_WrappingMode__WEBPACK_IMPORTED_MODULE_12__.a.Square:if(e instanceof _ItemHandlers_BoundedTextItemHandler__WEBPACK_IMPORTED_MODULE_15__.a){var t=_Math__WEBPACK_IMPORTED_MODULE_11__.RotatedRectangleF.fromRectangleF(e.item.textRectangle,e.angle);return _Math__WEBPACK_IMPORTED_MODULE_11__.RotatedRectangleF.fromRectangleF(t.bounds)}return _Math__WEBPACK_IMPORTED_MODULE_11__.RotatedRectangleF.fromRectangleF(e.bounds);case _ItemHandlers_WrappingMode__WEBPACK_IMPORTED_MODULE_12__.a.Tight:return e.rectangle;default:return null}},Canvas.prototype._updateWrappingRectangles=function(e,t){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,function(){var n,i,o,r,a,s,l,c,h,u,d,_,p,g,f,v,m,y,C,b,E,w,D,P,M,I;return __generator(this,function(T){switch(T.label){case 0:return!0===this._initialization?[2]:t&&e instanceof _ItemHandlers_BoundedTextItemHandler__WEBPACK_IMPORTED_MODULE_15__.a?(e.update(),[2]):(o=e.get_layer().get_index(),r=e.index,-1===o||-1===r?[2]:e.isUpdating?[4,e.waitUpdate()]:[3,2]);case 1:T.sent(),T.label=2;case 2:for(a=e instanceof _ItemHandlers_BoundedTextItemHandler__WEBPACK_IMPORTED_MODULE_15__.a?_Math__WEBPACK_IMPORTED_MODULE_11__.RotatedRectangleF.fromRectangleF(e.getTextRectangle(),e.angle):e.rectangle,s=[],l=this.get_layers(),c=o,h=l.get_count();c>-1&&c<h;c++)if((u=l.get_item(c)).get_visible())for(d=u.itemHandlers,_=0,p=d.get_count();_<p;_++)(g=d.get_item(_)).visible&&!g.get_permissions().get_noShow()&&g.item.textWrappingMode!==_ItemHandlers_WrappingMode__WEBPACK_IMPORTED_MODULE_12__.a.None&&(g.index>r||u.get_index()>o)&&(f=this._getItemHandlerWrappingRectangle(g),a.intersectsWith(f)&&s.push(f));v=s.length>0?new _Math__WEBPACK_IMPORTED_MODULE_11__.Path:null;try{for(m=__values(s),y=m.next();!y.done;y=m.next())C=y.value,b=C.getUpperLeftCorner(),E=C.getUpperRightCorner(),w=C.getBottomRightCorner(),D=C.getBottomLeftCorner(),v.moveTo(b.x,b.y),v.lineTo(E.x,E.y),v.lineTo(w.x,w.y),v.lineTo(D.x,D.y),v.lineTo(b.x,b.y),v.close()}catch(e){n={error:e}}finally{try{y&&!y.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}return P=e.lastRectangle,M=!P||!a.isEqual(P),e.lastRectangle=a,I=null==e.item.wrappingPath||!e.item.wrappingPath.isEqual(v),e.item.wrappingPath=v,!I&&(t||M&&s.length>0)&&e.update(),[2]}})})},Canvas.prototype.dispose=function(){null!=this._onSelectedItemHandlersChangedDelegate&&(this.get_selectedItemHandlers().remove_itemAdded(this._onSelectedItemHandlersChangedDelegate),delete this._onSelectedItemHandlersChangedDelegate),null!=this._onSelectedItemHandlersChangedDelegate&&(this.get_selectedItemHandlers().remove_itemRemoved(this._onSelectedItemHandlersChangedDelegate),delete this._onSelectedItemHandlersDeletingDelegate)},Canvas.prototype.hitTestSelection=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=null);var o={},r=new _Math__WEBPACK_IMPORTED_MODULE_11__.Matrix;0!==e.angle&&r.rotate(-e.angle),r.translate(-e.centerX,-e.centerY),t=r.transformPoint(t,!0);var a=e.width,s=e.height,l=this.get_mul(),c=null!=i?Math.max(i/l,s):s,h=null!=i?Math.max(i/l,a):a;o.body=new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(-h/2,-c/2,h,c).contains(t),o.resize=!1,o.resizeIndex=0;for(var u=(_Utils_Environment__WEBPACK_IMPORTED_MODULE_21__.a.IsTouchDevice()?33:this.resizeGripSize)/l,d=u/2,_=[null,new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(-a/2-d,-s/2-d,u,u),new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(a/2-d,-s/2-d,u,u),new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(a/2-d,s/2-d,u,u),new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(-a/2-d,s/2-d,u,u),new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(-a/2-d,0-d,u,u),new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(0-d,-s/2-d,u,u),new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(a/2-d,0-d,u,u),new _Math__WEBPACK_IMPORTED_MODULE_11__.RectangleF(0-d,s/2-d,u,u)],p=new Array(5,7),g=1,f=_.length;g<f;g++)if(_[g].contains(t)&&(!n||-1!==p.indexOf(g))){o.resize=!0,o.resizeIndex=g;break}s<0&&(s=-s),o.rotate=!1,o.rotateIndex=0,u=this.rotationGripSize/2/l;var v=s/2+this.rotationGripSize/l+u,m=t.x-0,y=t.y-v;return m*m+y*y<u*u&&(o.rotate=!0,o.rotateIndex=6),o},Canvas.prototype.get_mul=function(){return 96*this.zoom/72},Canvas.prototype.isLockedOrDisabled=function(e){return null==e||(e.isLocked()||this.disabledLayers.includes(e.layer))},Canvas.prototype.onLayerTextureLoaded=function(){for(var e=0;e<this.layers.length;e++){var t=this.get_layers().get_item(e);if(!t.get_locked()&&!t.isTextureLoadedOrNotExists())return}this.redraw()},Canvas}()},872:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(380),o=n(495),r=n(371),a=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),s=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},l=function(e){function t(t){var n=e.call(this)||this;return n._canvas=t,n}return a(t,e),t.prototype.getLayerById=function(e){for(var t=0,n=this.get_count();t<n;t++){var i=this.get_item(t);if(i.get_uniqueId()==e)return i}return null},t.prototype.getLayerByContainerId=function(e){for(var t=0,n=this.get_count();t<n;t++){var i=this.get_item(t);if(i.container.id==e)return i}return null},t.prototype.getLayersByName=function(e){for(var t=[],n=0;n<this.get_count();n++)this.get_item(n).get_name()==e&&t.push(this.get_item(n));return t},t.prototype.getItemHandlersByName=function(e){for(var t=[],n=0;n<this.get_count();n++)for(var i=this.get_item(n),o=0;o<i.itemHandlers.get_count();o++)i.itemHandlers.get_item(o).name===e&&t.push(i.itemHandlers.get_item(o));return t},t.prototype._onLayerAdded=function(e,t){var n=this._canvas;n&&(e.set_canvas(n),e.onLayerAdded())},t.prototype._onLayerMoved=function(e,t,n){this._canvas},t.prototype.removeRange=function(t,n){var i=function(e){this._onLayerRemoved(e.item,e.index)}.bind(this);try{return this.add_itemRemoved(i),e.prototype.removeRange.call(this,t,n)}finally{this.remove_itemRemoved(i)}},t.prototype.insertAt=function(t,n){var i,a;Array.isArray(n)||(n=[n]);try{for(var l=s(n),c=l.next();!c.done;c=l.next()){var h=c.value;if(this.contains(h))throw new r.b(o.b)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}e.prototype.insertAt.call(this,t,n);for(var u=0;u<n.length;u++){var d=n[u];this._onLayerAdded(d,this._collection.indexOf(d))}},t.prototype.move=function(t,n){var i=e.prototype.move.call(this,t,n);return i&&this._onLayerMoved(i,t,n),i},t.prototype.clear=function(){var t,n;try{for(var i=s(this),o=i.next();!o.done;o=i.next()){o.value.dispose()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e.prototype.clear.call(this)},t}(i.a)},873:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(387),o=n(396),r=n(434),a=function(){function e(e){this._dndStarting=!1,this._dndStarted=!1,this._isShown=!1,this._startPoint=null,this._currentPoint=null,this._currentPointClient=null,this._isOutOfCanvas=!1,this._dragSource=null,this._dragOver=null,this._dragImg=null,this._dragTargets=null,this._allowedTargets=null,this._canvas=e}return e.prototype.processMouseEvent=function(e){var t=new i.a(e.x,e.y);if("mousedown"===e.type){var n=this.hitTest(t),o=this._canvas.get_currentItemHandler();if(null!=n&&null!=o&&n.uniqueId===o.uniqueId){this._isOutOfCanvas=this._testOutOfCanvas(t);var a=n.get_permissions(),s=a.get_allowDragAndDrop();n.isStubOrEmpty()||!1!==a.get_allowMove()&&!this._canvas.simpleMode||!s||this._isOutOfCanvas||n.content instanceof r.a||(this._dndStarting=!0,this._startPoint=t,this._currentPoint=t,this._currentPointClient=new i.a(e.clientX,e.clientY),this._dragSource=n,this._allowedTargets=null)}}else if("mousemove"===e.type){if(this._dndStarting){var l=Math;if(l.abs(t.x-this._startPoint.x)>4||l.abs(t.y-this._startPoint.y)>4){var c={source:this._dragSource,allowedTargets:null};this._canvas._onDragNDropStarting(c),null!=c.allowedTargets&&(this._allowedTargets=c.allowedTargets),this._dndStarted=!0,this._dndStarting=!1,this._dragSource._reloadPlaceholderButtons(),this._dragImg=this._get_image(),this._setDragTargets(this._dragSource)}}if(this._dndStarted){this._isOutOfCanvas=this._testOutOfCanvas(t);n=this.hitTest(t);this._dragTargets.includes(n)||(n=null),this._setDragOver(n),this._currentPoint=t,this._currentPointClient=new i.a(e.clientX,e.clientY)}}else if("mouseup"===e.type&&(this._dndStarted||this._dndStarting)){var h=this.hitTest(t);this.isDragTarget(h)||(h=null),this._testOutOfCanvas(t)?(this._canvas._onDragNDropPerformed({source:this._dragSource,target:null}),this._canvas.set_selectedItemHandlers([])):null!=h&&h!=this._dragSource&&(this._canvas._onDragNDropPerformed({source:this._dragSource,target:h}),this._canvas.set_selectedItemHandlers([h])),this._setDragOver(null),this._dndStarted=!1,this._dndStarting=!1;var u=this._dragSource;this._dragSource=null,u&&u._reloadPlaceholderButtons(),this._startPoint=null,this._currentPoint=null,this._currentPointClient=null,this._dragImg=null,this._dragOver=null,this._unsetDragTargets(),this.draw(),this._canvas._onDragNDropDone()}},e.prototype._setDragOver=function(e){if(null!=this._dragOver&&this._dragOver!==e){var t=this._dragOver;this._dragOver=null,this._canvas.redrawDesign(),t._reloadPlaceholderButtons()}e&&e!==this._dragSource&&e!==this._dragOver&&(this._dragOver=e,this._canvas.redrawDesign(),this._dragOver._reloadPlaceholderButtons())},e.prototype.isDragSource=function(e){return this._dragSource===e},e.prototype.isDragTarget=function(e){return null!=this._dragTargets&&this._dragTargets.includes(e)},e.prototype.isDragStarted=function(){return this._dndStarted},e.prototype.isDragOver=function(e){return void 0===e&&(e=null),null===e?null!=this._dragOver:this._dragOver===e},e.prototype.isOutOfCanvas=function(){return this._isOutOfCanvas},e.prototype.hitTest=function(e){var t=this._canvas.getItemHandlersByHitTest(e)[0];return t instanceof o.a?t:null},e.prototype._testOutOfCanvas=function(e){return e.x<0||e.x>this._canvas.get_workspaceWidth()||(e.y<0||e.y>this._canvas.get_workspaceHeight())},e.prototype._get_image=function(){return this._dragSource.content._imageContainer._image},e.prototype._unsetDragTargets=function(){var e=this._dragTargets;this._dragTargets=null,null!=e&&(e.forEach(function(e){return e._reloadPlaceholderButtons()}),this._canvas.redraw())},e.prototype._setDragTargets=function(e){var t=this,n=this._canvas.get_allHandlers({onlyVisible:!0,onlyType:o.a});this._dragTargets=n.filter(function(n){return n!==e&&(null==t._allowedTargets||t._allowedTargets.includes(n))}),this._dragTargets.length>0&&(this._dragTargets.forEach(function(e){return e._reloadPlaceholderButtons()}),this._canvas.redraw())},e.prototype.draw=function(){this._dndStarted?(this._canvas.showDnd(this._currentPointClient,this._dragImg),this._isShown=!0):this._isShown&&(this._canvas.hideDnd(),this._isShown=!1)},e}()},874:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(368),o=function(){function e(e,t){this.rotateDiv=null,this._canvas=e,this._viewer=t,this._rotationStyle=null}return e.prototype.addRotationStyle=function(){null!=this._viewer&&(null!=this._rotationStyle&&this._rotationStyle.remove(),this._rotationStyle=document.createElement("style"),this._rotationStyle.type="text/css",this._rotationStyle.innerHTML='\n                #rotate-circle::after { \n                    content: ""; \n                    position: absolute; \n                    width: 16px; \n                    height: 16px; \n                    background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTEuMTUxIDIuNTQyOTNDMTQuMTY0MyA0LjI4MjYyIDE1LjE5NjcgOC4xMzU2NCAxMy40NTcgMTEuMTQ4OUMxMy4xNzUgMTEuNjM3NCAxMi44Mzc0IDEyLjA3MzggMTIuNDU2OSAxMi40NTQ4TDEwLjU0NjcgMTQuMzYyOU00Ljg1MTAxIDEzLjQ1NDhDMS44Mzc3NyAxMS43MTUxIDAuODA1MzU2IDcuODYyMTMgMi41NDUwNSA0Ljg0ODg4QzIuODI3MDcgNC4zNjA0MSAzLjE2NDYzIDMuOTI0IDMuNTQ1MTQgMy41NDMwMUw1LjQ1NTUgMS42MzQ5OE0xMC41NDU2IDExLjE4MkwxMC41NDY3IDE0LjM2MjlNMTAuNTQ2NyAxNC4zNjI5TDEzLjcyNzUgMTQuMzY0TTUuNDU0MzkgNC44MTgwN0w1LjQ1NTUgMS42MzQ5OE01LjQ1NTUgMS42MzQ5OEwyLjI3MjQxIDEuNjM2MDkiIHN0cm9rZT0iIzMwQzJGRiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjwvc3ZnPg==);\n                    top: 3px; \n                    left: 3px; \n                } \n                #degree { \n                    position: absolute; \n                    border-radius: 5px; \n                    background-color: rgba(0, 0, 0, 0.8); \n                    color: #fff; \n                    display: flex; \n                    align-items: center; \n                    justify-content: center; \n                    z-index: 2; \n                    font-size: 12px; \n                    line-height: 14px; \n                    height: 22px; \n                    width: 45px; \n                    transition: 0.3s opacity; \n                }\n                ',document.head.appendChild(this._rotationStyle))},e.prototype.addRotateDiv=function(e,t){if(null!=this._viewer&&null!=this._viewer.get_whitespaceDiv()){var n=this._viewer.get_whitespaceDiv();this.rotateDiv=document.createElement("div"),this.rotateDiv.id="degree",n.appendChild(this.rotateDiv),this.updateRotatePositionDiv(e,t),this._canvas.updateHoverDiv()}},e.prototype.removeRotateDiv=function(){null!=this.rotateDiv&&(this.rotateDiv.remove(),this.rotateDiv=null)},e.prototype.updateRotatePositionDiv=function(e,t){null!=this.rotateDiv&&(this.rotateDiv.style.top=e+"px",this.rotateDiv.style.left=t+"px")},e.prototype.updateRotateDegreeDiv=function(e){null!=this.rotateDiv&&(this.rotateDiv.innerHTML=Math.round(e)%360+"&deg;")},e.prototype.rotateHoverLabel=function(e,t){e>45&&e<135?this._canvas.hoverDiv.querySelectorAll("#hover-label").forEach(function(e){e.style.left="-"+(t.width/2+10)+"px",e.style.top=t.height-t.width/2-7+"px",e.style.transform="rotate(-90deg)"}):e>=135&&e<225?this._canvas.hoverDiv.querySelectorAll("#hover-label").forEach(function(e){e.style.left="0px",e.style.top=t.height+5+"px",e.style.transform="rotate(180deg)"}):e>225&&e<315?this._canvas.hoverDiv.querySelectorAll("#hover-label").forEach(function(e){e.style.left=t.width/2+10+"px",e.style.top=t.width/2-10+"px",e.style.transform="rotate(90deg)"}):this._canvas.hoverDiv.querySelectorAll("#hover-label").forEach(function(e){e.style.left="0px",e.style.top="-20px",e.style.transform="rotate(0deg)"})},e.prototype.calculatePositionRotateDiv=function(e,t,n,o,r,a){var s=this._canvas.get_mul();switch(e){case 0:var l=o.x*s+t+20,c=o.y*s+n+20;break;case 90:l=a-o.y*s+t+20,c=o.x*s+n+20;break;case 180:l=r-o.x*s+t+20,c=a-o.y*s+n+20;break;case 270:l=o.y*s+t+20,c=r-o.x*s+n+20}return new i.PointF(l,c)},e}()},875:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(707),o=n(708),r=function(){function e(e,t,n){if(this.L=[],this.XDpi=72,this.YDpi=72,this.Z=1,this.RV=null,this.MinFontSize=null,this.MaxFontSize=null,this.MinLeading=null,this.MaxLeading=null,e){this.RgbCPId=e.rgbColorProfileFileId,this.CmykCPId=e.cmykColorProfileFileId,this.GrayscaleCPId=e.grayscaleColorProfileFileId,this.Z=e.get_zoom(),this.TDpi=e.get_targetDpi(),this.XDpi=e.get_screenXDpi(),this.YDpi=e.get_screenYDpi(),this.WW=e.get_workspaceWidth(),this.WH=e.get_workspaceHeight(),this.MinFontSize=e.minFontSize,this.MaxFontSize=e.maxFontSize,this.MinLeading=e.minLeading,this.MaxLeading=e.maxLeading;var o=e.layers;if(this.L=[],!1===t||void 0===t){for(var r=0;r<o.get_count();r++)this.L.push(new i.a(o.get_item(r)));this.ReGC=e.resizeGripColor,this.RoGC=e.rotationGripColor,this.ReGS=e.resizeGripSize,this.RoGS=e.rotationGripSize,this.RV=e.get_returnValue(),this.SB=e.isSquaredBackground,this.MW=e.get_marginWidth(),this.MC=e.get_marginColor(),this.LM=e.leftMargin,this.RM=e.rightMargin,this.TM=e.topMargin,this.BM=e.bottomMargin,this.CM=e.get_constrainedMarginEnabled(),this.Tags=e.get_tags(),this.LIU=e.loadingImageUrl,this.SC=e.selectionColor,this.SW=e.selectionWidth,this.ReGLC=e.resizeGripLineColor,this.RoGLC=e.rotationGripLineColor,this.RoGLL=e.rotationGripLineLength,this.PBGCC=e.placeholderButtonGroupCssClass,this.FloatingItemToolbarCssClass=e.floatingItemToolbarCssClass,this.SIBCC=e.selectImageButtonCssClass,this.SBBCC=e.selectBarcodeButtonCssClass,this.HBCC=e.handleButtonCssClass,this.DBCC=e.doneButtonCssClass,this.DeleteToolbarButtonCssClass=e.deleteToolbarButtonCssClass,this.EditToolbarButtonCssClass=e.editToolbarButtonCssClass,this.SelectToolbarButtonCssClass=e.selectToolbarButtonCssClass,this.QCCCC=e.qualityChangeContainerCssClass,this.QCSBCC=e.qualityChangeScaleBarCssClass,this.QBTWCSBCC=e.qualityBadToWarningChangeScaleBarCssClass,this.QWTGCSBCC=e.qualityWarningToGoodChangeScaleBarCssClass,this.QBTGCSBCC=e.qualityBadToGoodChangeScaleBarCssClass,this.QNACSBCC=e.qualityNoAnimationChangeScaleBarCssClass,this.QCIBCC=e.qualityChangeInfoBarCssClass,this.VCCC=e.violationContainerCssClass,this.VBCC=e.violationWarningButtonCssClass,this.GVICC=e.goodViolationIconCssClass,this.WVICC=e.warningViolationIconCssClass,this.BVICC=e.badViolationIconCssClass,this.BBGCC=e.bigButtonGroupCssClass,this.SBT=e.selectButtonTitle,this.HBT=e.handleButtonTitle,this.DBT=e.doneButtonTitle,this.DLTBT=e.deleteButtonTitle,this.EBT=e.editButtonTitle,this.MSE=e.multipleSelectionEnabled,this.MMT=e.get_mouseMoveTimeout(),this.DS=e.get_disableSmoothing()}else null!=n&&this.L.push(new i.a(o.getLayerById(n),!0))}}return e.applyState=function(e,t){if(t&&e){var n;t._initialization=!0,t.get_history().set_locked(!0),t.set_workspaceSize(e.WW,e.WH),t.set_targetDpi(e.TDpi),t._rgbColorProfileFileId=e.RgbCPId,t._cmykColorProfileFileId=e.CmykCPId,t._grayscaleColorProfileFileId=e.GrayscaleCPId;for(var r={},a=function(e){e.get_uniqueId&&(r[e.get_uniqueId()]=e)},s=t.get_layers(),l=s.get_count(),c=0;c<l;c++){a(n=s.get_item(c));for(var h=n.itemHandlers,u=h.get_count(),d=0;d<u;d++)a(h.get_item(d));h.clear()}s.clear();var _=void 0;for(c=0;c<e.L.length;c++)_=e.L[c],n=r[_.ID]||new o.a,r[_.ID]=null,i.a.applyState(e.L[c],n,r),t.get_layers().add(n);for(var p in r){var g=r[p];g&&g.dispose()}t.get_history().set_locked(!1),t._returnValue=e.RV,t._canvasClientSideOptions=e.CSO,t.initialization=!0,t.set_resizeGripColor(e.ReGC),t.set_rotationGripColor(e.RoGC),t.set_resizeGripSize(e.ReGS),t.set_rotationGripSize(e.RoGS),t.set_isSquaredBackground(e.SB),t.set_marginColor(e.MC),t.set_marginWidth(e.MW),t.set_leftRightMargin(e.LRM),t.set_topBottomMargin(e.TBM),t.set_constrainedMarginEnabled(e.CM),t.set_tags(e.Tags),t.set_loadingImageUrl(e.LIU),t.set_selectionColor(e.SC),t.set_selectionWidth(e.SW),t.set_resizeGripLineColor(e.ReGLC),t.set_rotationGripLineColor(e.RoGLC),t.set_rotationGripLineLength(e.RoGLL),t.set_placeholderButtonGroupCssClass(e.PBGCC),t.set_floatingItemToolbarCssClass(e.FloatingItemToolbarCssClass),t.selectImageButtonCssClass(e.SIBCC),t.selectBarcodeButtonCssClass(e.SBBCC),t.set_handleButtonCssClass(e.HBCC),t.set_doneButtonCssClass(e.DBCC),t.set_selectToolbarButtonCssClass(e.SelectToolbarButtonCssClass),t.set_deleteToolbarButtonCssClass(e.DeleteToolbarButtonCssClass),t.set_editToolbarButtonCssClass(e.EditToolbarButtonCssClass),t.set_qualityChangeContainerCssClass(e.QCCCC),t.set_qualityChangeScaleBarCssClass(e.QCSBCC),t.set_qualityBadToWarningChangeScaleBarCssClass(e.QBTWCSBCC),t.set_qualityWarningToGoodChangeScaleBarCssClass(e.QWTGCSBCC),t.set_qualityBadToGoodChangeScaleBarCssClass(e.QBTGCSBCC),t.set_qualityNoAnimationChangeScaleBarCssClass(e.QNACSBCC),t.set_qualityChangeInfoBarCssClass(e.QCIBCC),t.set_violationContainerCssClass(e.VCCC),t.set_violationWarningButtonCssClass(e.VBCC),t.setGoodViolationIconCssClass(e.GVICC),t.setWarningViolationIconCssClass(e.WVICC),t.setBadViolationIconCssClass(e.BVICC),t.set_bigButtonGroupCssClass(e.BBGCC),t.set_selectButtonTitle(e.SBT),t.set_handleButtonTitle(e.HBT),t.set_doneButtonTitle(e.DBT),t.set_deleteButtonTitle(e.DLTBT),t.set_editButtonTitle(e.EBT),t.set_multipleSelectionEnabled(e.MSE),t.set_mouseMoveTimeout(e.MMT),t.set_disableSmoothing(e.DS),t._initialization=!1}},e}()},876:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(){function e(e){this._canvas=e}return e.prototype.processMouseEvent=function(e,t){"mousemove"===e.type&&(null==t?this._canvas.hideHover():this._canvas.showHover(t.rectangle,t.item.name))},e}()},877:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n(393),o=n(434),r=n(371),a=n(368),s=n(423),l=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a},c=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e},h=function(){function e(e,t,n,i,o){if(this._selection=t,this._dndHandler=n,this._rotateHandler=i,this._canvas=o,this._document=null,this._parent=null,this._whitespace=null,this._dndDiv=null,this._dndStyle=null,this._selectionDiv=null,this._selectionStyle=null,this._buttonStyle=null,this.hoverDiv=null,this.surfaceCanvas=null,this.activeCanvas=null,this.inactiveCanvas=null,this.designCanvas=null,this._stopPropagationFnc=function(e){e.stopPropagation()},null==e)throw new r.e("Element id cannot be null or undefined");this._surfaceCanvasId=e,this._activeCanvasId=e+"_active",this._inactiveCanvasId=e+"_inactive",this._designCanvasId=e+"_design"}return e.prototype.addStyles=function(){this._addButtonStyles(),this._addSelectionStyle(),this._addDndStyle(),this._rotateHandler.addRotationStyle()},e.prototype._addButtonStyles=function(){null!=this._buttonStyle&&this._buttonStyle.remove(),this._buttonStyle=document.createElement("style"),this._buttonStyle.type="text/css",this._buttonStyle.innerHTML=".buttonsHidden {opacity: 0; transition: 0.3s opacity; pointer-events: none !important;}.buttonsShown {opacity: 1; transition: 0.3s opacity;}.elementHidden {opacity: 0; transition: 0.3s opacity;}.elementShown {opacity: 1; transition: 0.3s opacity;}",document.head.appendChild(this._buttonStyle)},e.prototype._addSelectionStyle=function(){null!=this._selectionStyle&&this._selectionStyle.remove(),this._selectionStyle=document.createElement("style"),this._selectionStyle.type="text/css",this._selectionStyle.innerHTML="#grips, #grips .selection, #hover {position: absolute; z-index: 1; pointer-events: none; box-sizing: border-box}#hover-label {left: 0px; top: -20px; position: absolute; width: 100%; text-align: left;min-width: 48px; font-family: Roboto; font-style: normal; font-weight: normal; font-size: 12px; line-height: 14px; white-space: nowrap; overflow: hidden;text-overflow: ellipsis;}",document.head.appendChild(this._selectionStyle)},e.prototype._addDndStyle=function(){null!=this._dndStyle&&this._dndStyle.remove(),this._dndStyle=document.createElement("style"),this._dndStyle.type="text/css",this._dndStyle.innerHTML="#ccDndDiv {position: absolute; left: 0; top: 0; z-index: 3; pointer-events: none; box-sizing: border-box; width: 100%; height: 100%;}#ccDndDiv .thumb {position: absolute; left: 0; top: 0; z-index: 3; pointer-events: none; box-sizing: border-box; width: 100px; height: 100px; border: 1px solid black; opacity: 0.8; background-size: cover;}#ccDndDiv .thumb.outside-canvas:after { content: '\\e92b'; font-size: 46px; text-align: center; font-family: 'Material Icons'; line-height: 100px; vertical-align: middle; color: white; background-color: red; opacity: 0.5; width: 100%; height: 100%; display: block; }#ccDndDiv .thumb.outside-canvas { opacity: 0.5 }#ccDndDiv .thumb.drag-over { opacity: 0.4 }.cc-dnd-icon {color: white}.cc-dnd-over {transition: transform 1.5s; transform: scale(1.2); }",document.head.appendChild(this._dndStyle)},e.prototype.addElement=function(e,t,n,i){this._parent=e,this._document=e.ownerDocument,this._whitespace=t,null!=this._document&&null!=this._whitespace&&(this.surfaceCanvas=this._createCanvasElement(this._surfaceCanvasId,n,i),this._parent.appendChild(this.surfaceCanvas),this.activeCanvas=this._createCanvasElement(this._activeCanvasId,n,i),this._parent.appendChild(this.activeCanvas),this.inactiveCanvas=this._createCanvasElement(this._inactiveCanvasId,n,i),this._parent.appendChild(this.inactiveCanvas),this.designCanvas=this._createCanvasElement(this._designCanvasId,n,i),this._parent.appendChild(this.designCanvas),this._addDndDiv(),this._addSelectionDiv(),this._addHoverDiv())},e.prototype.removeElement=function(){var e=this._getAllCanvases(),t=null!=e[0]?e[0].parentNode:null;if(null!=t)for(var n=e.length-1;n>=0;--n){var i=e[n];null!=i&&t.removeChild(i)}this._removeDndDiv(),this._removeSelectionDiv(),this._removeHoverDiv()},e.prototype.updateElementSize=function(e,t){for(var n=this._getAllCanvases(),i=0;i<n.length;i++){var o=n[i];null!=o&&this._setElementSize(o,e,t)}},e.prototype._addDndDiv=function(){this._dndDiv=this._document.createElement("div"),this._dndDiv.id="ccDndDiv",this._document.body.appendChild(this._dndDiv);var e=this._document.createElement("div");e.id="ccDndThumb",e.classList.add("thumb"),e.style.visibility="hidden",e.style.left="50%",e.style.top="0%",this._dndDiv.appendChild(e)},e.prototype._removeDndDiv=function(){null!=this._dndDiv&&(this._dndDiv.remove(),this._dndDiv=null)},e.prototype.showDnd=function(e,t,n){this._dndDiv.querySelectorAll("div[id^=ccDndThumb]").forEach(function(t){t.style.left=e.x-50+"px",t.style.top=e.y-50+"px"}),this._dndDiv.style.visibility="visible",this._dndDiv.querySelectorAll("div[id^=ccDndThumb]").forEach(function(e){e.style.visibility="visible",e.style.backgroundImage="url("+t.src+")",e.style.transform="rotate("+n+"deg)"}),this._dndHandler.isOutOfCanvas()?this._dndDiv.querySelectorAll("div[id^=ccDndThumb]").forEach(function(e){e.classList.add("outside-canvas")}):this._dndDiv.querySelectorAll("div[id^=ccDndThumb]").forEach(function(e){e.classList.remove("outside-canvas")}),this._dndHandler.isDragOver()?this._dndDiv.querySelectorAll("div[id^=ccDndThumb]").forEach(function(e){e.classList.add("drag-over")}):this._dndDiv.querySelectorAll("div[id^=ccDndThumb]").forEach(function(e){e.classList.remove("drag-over")})},e.prototype.hideDnd=function(){this._dndDiv.style.visibility="hidden",this._dndDiv.querySelectorAll("div[id^=ccDndThumb]").forEach(function(e){e.style.visibility="hidden"})},e.prototype._addSelectionDiv=function(){this._selectionDiv=document.createElement("div"),this._selectionDiv.id="grips",this._selectionDiv.style.visibility="hidden",this._whitespace.appendChild(this._selectionDiv);var e=document.createElement("div");e.id="rotate-circle",e.classList.add("selection"),e.style.left="calc(50% - 12px)",e.style.bottom="0%",this._selectionDiv.appendChild(e),(e=document.createElement("div")).id="resize-left-top",e.classList.add("selection"),e.style.left="0%",e.style.top="0%",this._selectionDiv.appendChild(e),(e=document.createElement("div")).id="resize-right-top",e.classList.add("selection"),e.style.left="100%",e.style.top="0%",this._selectionDiv.appendChild(e),(e=document.createElement("div")).id="resize-right-bottom",e.classList.add("selection"),e.style.left="100%",e.style.top="100%",this._selectionDiv.appendChild(e),(e=document.createElement("div")).id="resize-left-bottom",e.classList.add("selection"),e.style.left="0%",e.style.top="100%",this._selectionDiv.appendChild(e),(e=document.createElement("div")).id="resize-width-left",e.classList.add("selection"),e.style.left="0%",e.style.top="50%",this._selectionDiv.appendChild(e),(e=document.createElement("div")).id="resize-width-right",e.classList.add("selection"),e.style.left="100%",e.style.top="50%",this._selectionDiv.appendChild(e),(e=document.createElement("div")).id="resize-height-top",e.classList.add("selection"),e.style.left="50%",e.style.top="0%",this._selectionDiv.appendChild(e),(e=document.createElement("div")).id="resize-height-bottom",e.classList.add("selection"),e.style.left="50%",e.style.top="100%",this._selectionDiv.appendChild(e),this.updateSelectionDiv()},e.prototype._removeSelectionDiv=function(){null!=this._selectionDiv&&(this._selectionDiv.remove(),this._selectionDiv=null)},e.prototype.updateSelectionDiv=function(){var e=this;if(null!=this._selectionDiv){this._selectionDiv.style.border=this._canvas.selectionWidth+"px solid "+this._canvas.selectionColor;var t=this._canvas.resizeGripSize;this._selectionDiv.querySelectorAll("div[id^=resize]").forEach(function(n){n.style.width=t+"px",n.style.height=t+"px",n.style.marginLeft="-"+t/2+"px",n.style.marginTop="-"+t/2+"px",n.style.border="1px solid "+e._canvas.resizeGripLineColor,n.style.backgroundColor=""+e._canvas.resizeGripColor});var n=this._canvas.rotationGripSize;this._selectionDiv.querySelectorAll("div#rotate-circle").forEach(function(e){e.style.width=n+"px",e.style.height=n+"px",e.style.marginBottom="-"+2*n+"px",e.style.border="1px solid #eee",e.style.borderRadius="50%",e.style.backgroundColor="#fff",e.style.boxShadow="0px 1px 3px rgba(0, 0, 0, 0.2), 0px 0px 2px rgba(0, 0, 0, 0.2)"})}},e.prototype.showSelection=function(e,t,n){null!=this._selectionDiv&&null!=n&&(this._updateSelectionPosition(e,n),this._selectionDiv.querySelectorAll("div[id^=rotate]").forEach(function(e){e.style.visibility=t.rotate?"visible":"hidden"}),this._selectionDiv.querySelectorAll("div[id^=resize]").forEach(function(e){e.style.visibility=t.resize?"visible":"hidden"}),this._selectionDiv.querySelectorAll("div[id^=resize-width]").forEach(function(e){e.style.visibility=t.arbitraryWidthResize?"visible":"hidden"}),this._selectionDiv.querySelectorAll("div[id^=resize-height]").forEach(function(e){e.style.visibility=t.arbitraryHeightResize?"visible":"hidden"}))},e.prototype.hideSelection=function(){null!=this._selectionDiv&&(this._selectionDiv.style.visibility="hidden",this._selectionDiv.querySelectorAll("div[id^=rotate]").forEach(function(e){e.style.visibility="hidden"}),this._selectionDiv.querySelectorAll("div[id^=resize]").forEach(function(e){e.style.visibility="hidden"}),this._selectionDiv.querySelectorAll("div[id^=resize-width]").forEach(function(e){e.style.visibility="hidden"}),this._selectionDiv.querySelectorAll("div[id^=resize-height]").forEach(function(e){e.style.visibility="hidden"}))},e.prototype._updateSelectionPosition=function(e,t){if(null!=(e=e||this._selection.get_visibleRectangle())){var n=t.get_contentAngle(),i=this._getControlRectangle(e,t);this._selectionDiv.style.visibility="visible",this._selectionDiv.style.left=i.x+"px",this._selectionDiv.style.top=i.y+"px",this._selectionDiv.style.width=i.width+"px",this._selectionDiv.style.height=i.height+"px",this._selectionDiv.style.transform="rotate("+e.angle+"deg)",this._rotateHandler.updateRotateDegreeDiv(e.angle-n)}},e.prototype._addHoverDiv=function(){this.hoverDiv=document.createElement("div"),this.hoverDiv.id="hover",this.hoverDiv.style.visibility="hidden",this.hoverDiv.style.zIndex="-1";var e=document.createElement("div");e.id="hover-label",this.hoverDiv.appendChild(e),this._whitespace.appendChild(this.hoverDiv),this.updateHoverDiv()},e.prototype._removeHoverDiv=function(){null!=this.hoverDiv&&(this.hoverDiv.remove(),this.hoverDiv=null)},e.prototype.updateHoverDiv=function(){null!=this.hoverDiv&&(this.hoverDiv.style.border=this._canvas.selectionWidth+"px solid "+this._canvas.selectionColor,this.hoverDiv.querySelector("#hover-label").style.color=""+this._canvas.selectionColor)},e.prototype.showHover=function(e,t,n){null!=e&&null!=this.hoverDiv&&null!=n&&(this.hoverDiv.querySelector("div[id^=hover-label]").innerText=t,this.hoverDiv.querySelector("div[id^=hover-label]").title=t,this.hoverDiv.style.visibility="visible",this.updateHoverPosition(e,n))},e.prototype.hideHover=function(){null!=this.hoverDiv&&(this.hoverDiv.style.visibility="hidden")},e.prototype.updateHoverPosition=function(e,t,n){if(null!=e&&"hidden"!==this.hoverDiv.style.visibility){var i=this._getControlRectangle(e,t);null!=n&&(this.hoverDiv.querySelector("div[id^=hover-label]").innerText=n),this.hoverDiv.style.left=i.x+"px",this.hoverDiv.style.top=i.y+"px",this.hoverDiv.style.width=i.width+"px",this.hoverDiv.style.height=i.height+"px",this.hoverDiv.style.transform="rotate("+e.angle+"deg)";var o=e.angle%360;this._rotateHandler.rotateHoverLabel(o,i)}},e.prototype.addPlaceholderButtonGroup=function(e,t){var n,o,r,a,s,l,h;if(null!=t&&null!=this._parent&&null!=e){var u=this._parent,d=document.createElement("div");d.style.position="absolute",d.style.display="flex",d.style.alignItems="center",d.id="buttonDiv";var _=this._canvas.placeholderButtonGroupCssClass,p=document.createElement("div");if(p.id="editDiv",null!=_&&""!==_&&(n=p.classList).add.apply(n,c(_.split(" "))),i.a.IsTouchDevice()){var g=this._canvas.bigButtonGroupCssClass;null!=g&&""!==g&&(o=p.classList).add.apply(o,c(g.split(" ")))}if(e.isStubOrEmpty()&&(!this._dndHandler.isDragStarted()||!this._dndHandler.isDragTarget(e))){var f=document.createElement("button");f.type="button",f.id="selectButton",f.setAttribute("style","will-change: transform"),f.addEventListener("mousedown",this._stopPropagationFnc),f.addEventListener("dblclick",this._stopPropagationFnc);var v=e.selectButtonClickHandler;if(this._addClickAndTapHandler(f,v),e.item.isBarcodePlaceholder){var m=this._canvas.selectBarcodeButtonCssClass;null!=m&&""!==m?(r=f.classList).add.apply(r,c(m.split(" "))):f.innerText="Select"}else{var y=this._canvas.selectImageButtonCssClass;null!=y&&""!==y?(a=f.classList).add.apply(a,c(y.split(" "))):f.innerText="Select"}e.selectButton=f,p.appendChild(f)}if(this._dndHandler.isDragStarted&&this._dndHandler.isDragTarget(e)){var C=document.createElement("div");C.id="dropIcon",C.classList.add("cc-dnd-icon"),C.setAttribute("style","width: 30px; height: 30px; will-change: transform");var b=e.isStubOrEmpty()?"cc-icon-dnd-target-empty":"cc-icon-dnd-target-not-empty";C.classList.add(b),this._dndHandler.isDragOver(e)&&C.classList.add("cc-dnd-over"),p.appendChild(C)}var E=e.get_permissions().get_allowEditContent();if(E&&!e.isStubOrEmpty()&&!this._dndHandler.isDragStarted()){var w=document.createElement("button");w.type="button",w.id="handleButton",w.setAttribute("style","will-change: transform"),w.addEventListener("dblclick",this._stopPropagationFnc);var D=this._canvas.handleButtonCssClass;null!=D&&""!==D?(s=w.classList).add.apply(s,c(D.split(" "))):w.innerText="Handle",e.handleButton=w,p.appendChild(w)}d.appendChild(p);var P=document.createElement("div");if(P.id="doneDiv",null!=_&&""!==_&&(l=P.classList).add.apply(l,c(_.split(" "))),E){var M=document.createElement("button");M.type="button",M.setAttribute("style","will-change: transform"),M.addEventListener("dblclick",this._stopPropagationFnc);var I=this._canvas.doneButtonCssClass;null!=I&&""!==I?(h=M.classList).add.apply(h,c(I.split(" "))):M.innerText="Done",e.doneButton=M,P.appendChild(M)}d.appendChild(P),u.appendChild(d),e.placeholderButtonGroup=d,e.editButtonGroup=p,e.doneButtonGroup=P,this.updatePlaceholderButtonGroup(e,t)}},e.prototype.removePlaceholderButtonGroup=function(e){if(null!=e&&null!=e.placeholderButtonGroup){for(var t=[e.selectButton,e.doneButton,e.handleButton],n=0;n<t.length;n++){var i=t[n];null!=i&&(i.removeEventListener("click",this._stopPropagationFnc),i.removeEventListener("mousedown",this._stopPropagationFnc),i.removeEventListener("dblclick",this._stopPropagationFnc))}e.placeholderButtonGroup.remove(),e.placeholderButtonGroup=null,e.doneButtonGroup=null,e.selectButton=null,e.handleButton=null,e.doneButton=null}},e.prototype.updatePlaceholderButtonGroup=function(e,t){var n=this;if(null!=e&&null!=e.placeholderButtonGroup){var i=e.placeholderButtonGroup;if(e.isVisible()&&!e.isLocked()){i.style.visibility="visible";var o=this._selection.isItemHandlerSelected(e)?"auto":"none",r=t.get_contentAngle();i.style.pointerEvents=o,i.style.transform="rotate(-"+r+"deg)";var a=e.editButtonGroup,s=e.doneButtonGroup,l=function(){return e.isStubOrEmpty()&&e.showSelectButton()};this._canvas.autoPlaceholderEditModeEnabled?(l()||this._buttonsHidden(a),this._buttonsHidden(s)):(l()||!e.isStubOrEmpty()&&e.showHandleButton()&&n._selection.isItemHandlerSelected(e)&&!e.isContentUpdating()&&1===n._selection.get_selectedItemHandlers().get_count()||n._dndHandler.isDragStarted()&&n._dndHandler.isDragTarget(e)?this._buttonsShow(a):this._buttonsHidden(a),e.editing&&!e.isContentUpdating()&&e.get_permissions(!0).get_showDoneButton()?this._buttonsShow(s):this._buttonsHidden(s));var c=e.selectButton;null!=c&&(c.title=this._getSelectButtonTitle(e));var h=e.doneButton;null!=h&&(h.title=this._canvas.doneButtonTitle);var u=e.handleButton;null!=u&&(u.title=this._canvas.handleButtonTitle),this.updatePlaceholderButtonGroupPosition(e,t)}else i.style.visibility="hidden"}},e.prototype.updatePlaceholderButtonGroupPosition=function(e,t){if(null!=t&&null!=this._parent&&null!=e&&null!=e.placeholderButtonGroup){var n=e.rectangle,i=t.workspaceToControlPoint(new a.PointF(n.centerX,n.centerY)),o=t.getParentPosition(this._parent.parentElement),r=new a.PointF(o.left,o.top),s=e.placeholderButtonGroup,l=i.x-s.offsetWidth/2-r.x,c=i.y-s.offsetHeight/2-r.y;s.style.position="absolute",s.style.left=l+"px",s.style.top=c+"px"}},e.prototype.addFloatingItemToolbar=function(e,t){var n,o,r,a,s;if(null!=t&&null!=this._parent&&null!=e&&this._canvas.floatingItemToolbarEnabled&&null==e.floatingItemToolbar){var l=this._whitespace,h=document.createElement("div");h.style.position="absolute",h.id="buttonDiv";var u=this._canvas.floatingItemToolbarCssClass,d=document.createElement("div");if(d.style.display="flex",d.id="floatingItemToolbarDiv",null!=u&&""!==u&&(n=d.classList).add.apply(n,c(u.split(" "))),i.a.IsTouchDevice()){var _=this._canvas.bigButtonGroupCssClass;null!=_&&""!==_&&(o=d.classList).add.apply(o,c(_.split(" ")))}if(this._isPlaceholder(e)||this._isImage(e)){var p=document.createElement("button");p.type="button",p.addEventListener("mousedown",this._stopPropagationFnc),p.addEventListener("dblclick",this._stopPropagationFnc);var g=e.getSelectToolbarButtonClickHandler();this._addClickAndTapHandler(p,g);var f=this._canvas.selectToolbarButtonCssClass;null!=f&&""!==f?(r=p.classList).add.apply(r,c(f.split(" "))):p.innerText="Select",e.selectToolbarButton=p,d.appendChild(p)}var v=document.createElement("button");v.type="button",v.addEventListener("mousedown",this._stopPropagationFnc),v.addEventListener("dblclick",this._stopPropagationFnc);var m=e.getEditToolbarButtonClickHandler();this._addClickAndTapHandler(v,m);var y=this._canvas.editToolbarButtonCssClass;null!=y&&""!==y?(a=v.classList).add.apply(a,c(y.split(" "))):v.innerText="Edit",e.editToolbarButton=v,d.appendChild(v);var C=document.createElement("button");C.type="button",C.addEventListener("mousedown",this._stopPropagationFnc),C.addEventListener("dblclick",this._stopPropagationFnc);var b=e.getDeleteToolbarButtonClickHandler();this._addClickAndTapHandler(C,b);var E=this._canvas.deleteToolbarButtonCssClass;null!=E&&""!==E?(s=C.classList).add.apply(s,c(E.split(" "))):C.innerText="Delete",e.deleteToolbarButton=C,d.appendChild(C),h.appendChild(d),l.appendChild(h),e.floatingItemToolbar=h,this.updateFloatingItemToolbar(e,t)}},e.prototype.removeFloatingItemToolbar=function(e){if(null!=e&&null!=e.floatingItemToolbar){for(var t=[e.selectToolbarButton,e.deleteToolbarButton,e.editToolbarButton],n=0;n<t.length;n++){var i=t[n];null!=i&&(i.removeEventListener("click",this._stopPropagationFnc),i.removeEventListener("mousedown",this._stopPropagationFnc),i.removeEventListener("dblclick",this._stopPropagationFnc))}e.floatingItemToolbar.remove(),e.floatingItemToolbar=null,e.selectToolbarButton=null,e.deleteToolbarButton=null,e.editToolbarButton=null}},e.prototype.updateFloatingItemToolbar=function(e,t){if(null!=e&&null!=e.floatingItemToolbar&&this._canvas.floatingItemToolbarEnabled){var n=e.floatingItemToolbar;if(this._canvas._isShowFloatingItemToolbar(e)){if(this._buttonsShow(n),this._isImageOrPlaceholder(e)){var i=e.selectToolbarButton;null!=i&&(e.showSelectToolbarButton()?(i.style.display="block",this._updateFloatingItemToolbarPosition(e,t)):i.style.display="none",i.title=this._getSelectButtonTitle(e))}var o=e.deleteToolbarButton;null!=o&&(e.showDeleteToolbarButton()&&!this._canvas.simpleMode?o.style.display="block":o.style.display="none",o.title=this._canvas.deleteButtonTitle);var r=e.editToolbarButton;null!=r&&(e.showEditToolbarButton()?r.style.display="block":r.style.display="none",r.title=this._canvas.editButtonTitle),this._updateFloatingItemToolbarPosition(e,t)}else this._buttonsHidden(n)}},e.prototype._updateFloatingItemToolbarPosition=function(e,t){if(null!=t&&null!=this._parent&&null!=e&&this._canvas.floatingItemToolbarEnabled&&null!=e.floatingItemToolbar){var n=e.rectangle,i=t.get_contentAngle(),o=e.floatingItemToolbar;i>0&&(n.rotateAt(i,new a.PointF),90===i?n.translate(t.get_workspaceHeight(),0):180===i?n.translate(t.get_workspaceWidth(),t.get_workspaceHeight()):270===i&&n.translate(0,t.get_workspaceWidth()));var r=t.zoom,s=t.get_screenXDpi()/72*r,l=t.get_screenYDpi()/72*r,c=Math.floor(n.width*s),h=Math.floor(n.height*l),u=o,d=u.offsetWidth,_=u.offsetHeight,p=3.5*d>c||3.5*_>h,g=(p?-d/2:8)+d/2,f=(p?-_:8)+_/2;new a.PointF(g,f).rotate(n.angle);var v=t.workspaceToControlPoint(n.getUpperRightCorner()),m=t.get_element(),y=new a.PointF(0,0);y.x=Math.max(0,v.x),y.y=Math.max(0,v.y);var C=e.rectangle.angle%360;if(C>=0&&C<90){var b=[t.workspaceToControlPoint(n.getUpperLeftCorner()),t.workspaceToControlPoint(n.getUpperRightCorner()),t.workspaceToControlPoint(n.getBottomRightCorner()),t.workspaceToControlPoint(n.getBottomLeftCorner())];y=this._findBetter(b,i,m,y,_,d,t)}else if(C>=180&&C<270){b=[t.workspaceToControlPoint(n.getBottomRightCorner()),t.workspaceToControlPoint(n.getBottomLeftCorner()),t.workspaceToControlPoint(n.getUpperLeftCorner()),t.workspaceToControlPoint(n.getUpperRightCorner())];y=this._findBetter(b,i,m,y,_,d,t)}else if(C>=270){b=[t.workspaceToControlPoint(n.getUpperRightCorner()),t.workspaceToControlPoint(n.getBottomRightCorner()),t.workspaceToControlPoint(n.getBottomLeftCorner()),t.workspaceToControlPoint(n.getUpperLeftCorner())];y=this._findBetter(b,i,m,y,_,d,t)}else{b=[t.workspaceToControlPoint(n.getBottomLeftCorner()),t.workspaceToControlPoint(n.getUpperLeftCorner()),t.workspaceToControlPoint(n.getUpperRightCorner()),t.workspaceToControlPoint(n.getBottomRightCorner())];y=this._findBetter(b,i,m,y,_,d,t)}o.style.left=y.x-12+"px",o.style.top=y.y+"px"}},e.prototype._findBetter=function(e,t,n,i,o,r,a){switch(t){case 90:e=e.concat(e.splice(0,3));break;case 180:e=e.concat(e.splice(0,2));break;case 270:e=e.concat(e.splice(0,1))}var s=e[0],l=e[1],c=e[2],h=e[3],u=n.offsetWidth-(l.x+r/2),d=n.offsetHeight-c.y,_=s.y-12,p=this._selectionDiv.querySelector("div#rotate-circle"),g=null;if(p){var f=p.getBoundingClientRect();g=a.pageToControlPoint(f.left,f.top)}var v=function(){return null!=g&&g.y+15>i.y&&g.y-15<i.y+o&&g.x+30>i.x&&g.x-30<i.x+r},m=function(){return i.x=u<0?l.x-r/2-5+u:l.x-r/2-5,v()&&(u>0&&n.offsetWidth-(g.x+30+r+5)>0?i.x=g.x+30:i.x=g.x-15-r),i.x},y=function(){return s.y-o>0?i.y=s.y-o:i.y=0,v()&&(i.y=g.y+15),i.y};return _>o?(i.y=s.y-o-12,i.x=m()):u-(r/2+5)>0?(i.x=l.x+5,i.y=y()):u-(r/2+5)<0&&(h.x-r-5>5?(i.x=h.x-r-5,i.y=y()):(i.x=m(),i.y=d>o?c.y:y())),i.x+=n.scrollLeft,i.y+=n.scrollTop,i},e.prototype.addViolationContainer=function(e,t){var n,i,r,a,s;if(null!=t&&null!=this._parent&&null!=e&&(this._canvas.violationWarningButtonsEnabled||this._canvas.qualityChangeContainersEnabled)&&null==e.getViolationContainer()&&(this._canvas.violationWarningButtonsEnabled||!this._canvas.qualityChangeContainersEnabled||e instanceof o.d||e instanceof o.f)){var l=document.createElement("div"),h=this._canvas.violationContainerCssClass;if(null!=h&&""!==h&&(n=l.classList).add.apply(n,c(h.split(" "))),e.setViolationContainer(l),this._canvas.violationWarningButtonsEnabled){var u=this._canvas.violationWarningButtonCssClass,d=document.createElement("button");d.type="button",null!=u&&""!==u?(i=d.classList).add.apply(i,c(u.split(" "))):d.innerText="Quality",d.addEventListener("mousedown",this._stopPropagationFnc),d.addEventListener("dblclick",this._stopPropagationFnc);var _=e.getViolationWarningButtonClickHandler();this._addClickAndTapHandler(d,_),e.setViolationWarningButton(d),l.appendChild(d)}if(this._canvas.qualityChangeContainersEnabled&&(e instanceof o.d||e instanceof o.e&&null==e.item.barcodeFormat)){var p=document.createElement("div");l.appendChild(p);var g=this._canvas.qualityChangeContainerCssClass;null!=g&&""!==g&&(r=p.classList).add.apply(r,c(g.split(" ")));var f=document.createElement("div");p.appendChild(f);var v=this._canvas.qualityChangeScaleBarCssClass;null!=v&&""!==v&&(a=f.classList).add.apply(a,c(v.split(" ")));var m=document.createElement("div");p.appendChild(m);var y=this._canvas.qualityChangeInfoBarCssClass;null!=y&&""!==y&&(s=m.classList).add.apply(s,c(y.split(" "))),e.qualityChangeContainer=p,e.qualityChangeScaleBar=f,e.qualityChangeInfoBar=m}this._whitespace.appendChild(l),this.updateViolationContainer(e,!0,t)}},e.prototype.removeViolationContainer=function(e){if(null!=e){var t=e.getViolationWarningButton();if(null!=t&&(t.removeEventListener("click",this._stopPropagationFnc),t.removeEventListener("mousedown",this._stopPropagationFnc),t.removeEventListener("dblclick",this._stopPropagationFnc),t.remove(),e.setViolationWarningButton(null)),e instanceof o.d||e instanceof o.e){var n=e.qualityChangeContainer;null!=n&&(n.remove(),e.qualityChangeContainer=null,e.qualityChangeScaleBar=null,e.qualityChangeInfoBar=null)}var i=e.getViolationContainer();null!=i&&(i.remove(),e.setViolationContainer(null))}},e.prototype.updateViolationContainer=function(e,t,n){if(void 0===t&&(t=!1),null!=e&&null!=e.getViolationContainer()){var i=e instanceof o.d||e instanceof o.e?e.qualityChangeContainer:null,r=e.getViolationWarningButton();if(!e.isVisible())return null!=i&&(i.style.visibility="hidden"),void(null!=r&&(r.style.visibility="hidden"));if(this._canvas.violationWarningButtonsEnabled&&null!=r)r.style.pointerEvents="auto",this._selection.isOnlyThisItemHandlerSelected(e)?r.classList.add("active"):r.classList.remove("active");if(this._canvas.qualityChangeContainersEnabled&&null!=i)i.style.visibility="visible",!(e instanceof o.e&&e.isStubOrEmpty())&&(this._selection.isResizing()||e instanceof o.e&&e.forceQualityChangeInfoBar)?this._buttonsShow(i):this._buttonsHidden(i);t&&this.updateViolationContainerPosition(e,n)}},e.prototype.updateViolationContainerPosition=function(e,t){if(null!=t&&null!=this._parent&&null!=e&&(this._canvas.violationWarningButtonsEnabled||this._canvas.qualityChangeContainersEnabled)&&null!=e.getViolationContainer()){var n=e.rectangle,i=t.get_contentAngle();i>0&&(n.rotateAt(i,new a.PointF),90===i?n.translate(t.get_workspaceHeight(),0):180===i?n.translate(t.get_workspaceWidth(),t.get_workspaceHeight()):270===i&&n.translate(0,t.get_workspaceWidth()));var o=t.zoom,r=t.get_screenXDpi()/72*o,s=t.get_screenYDpi()/72*o,l=Math.floor(n.width*r),c=Math.floor(n.height*s),h=e.getViolationWarningButton(),u=e.getViolationContainer(),d=null!=h?h:u,_=d.offsetWidth,p=d.offsetHeight,g=3.5*_>l||3.5*p>c,f=(g?-_/2:8)+_/2,v=(g?-p:8)+p/2,m=new a.PointF(f,v);m.rotate(n.angle);var y=t.workspaceToControlPoint(n.getUpperLeftCorner()),C=t.get_whitespaceDiv(),b=t.get_element();y.x+=m.x-C.offsetLeft-_/2+b.scrollLeft,y.y+=m.y-C.offsetTop-p/2+b.scrollTop,y.x=Math.max(0,y.x),y.y=Math.max(0,y.y);var E=y.x+_-t.get_whitespaceDiv().offsetWidth;E>0&&(y.x-=E);var w=y.y+p-t.get_whitespaceDiv().offsetHeight;w>0&&(y.y-=w),u.style.left=y.x+"px",u.style.top=y.y+"px",u.style.position="absolute";h=e.getViolationWarningButton();e.isVisible()?null!=h&&(h.style.visibility="visible",this._selection.isOperationNotNull()?(h.classList.remove("elementShown"),h.classList.add("elementHidden")):(h.classList.remove("elementHidden"),h.classList.add("elementShown"))):null!=h&&(h.style.visibility="hidden")}},e.prototype.calculateRenderStateForItemHandlers=function(e){var t=this,n=!1,i=function(e,t){e.renderState!==t&&(e.renderState=t,n=!0)},r=e.selectMany(function(e){return e.itemHandlers.toArray()}).reverse(),a=this._selection._get_permissions();if(a.get_allowMove()||a.get_allowRotate()||a.get_allowResize())for(var s=r.indexOf(function(e){return t._selection.isItemHandlerSelected(e)}),l=r.lastIndexOf(function(e){return t._selection.isItemHandlerSelected(e)}),c=r.indexOf(function(e){return e.hasBlendMode()}),h=c>-1,u=0;u<r.count();u++){var d=r.elementAt(u);d.isVisible()?i(d,u<s&&(u<c||!h)?o.g.Top:u>=s&&u<=l||h&&s>=c?o.g.Active:o.g.Bottom):i(d,o.g.Hidden)}else r.forEach(function(e){e.isVisible()?i(e,o.g.Bottom):i(e,o.g.Hidden)});return n},e.prototype._getAllCanvases=function(){return[this.surfaceCanvas,this.activeCanvas,this.inactiveCanvas,this.designCanvas]},e.prototype._createCanvasElement=function(e,t,n){var i=this._document.createElement("canvas");return i.id=e,i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.style.pointerEvents="none",this._setElementSize(i,t,n),i},e.prototype._setElementSize=function(e,t,n){var o=i.a.devicePixelRatio;e.width=Math.ceil(t),e.style.width=Math.ceil(t/o)+"px",e.height=Math.ceil(n),e.style.height=Math.ceil(n/o)+"px"},e.prototype._addClickAndTapHandler=function(e,t){i.a.IsTouchDevice()&&!i.a.IsAndroid()?window.Hammer(e).on("tap",t):e.addEventListener("click",t)},e.prototype._buttonsShow=function(e){e.classList.remove("buttonsHidden"),e.classList.add("buttonsShown")},e.prototype._buttonsHidden=function(e){e.classList.remove("buttonsShown"),e.classList.add("buttonsHidden")},e.prototype._isPlaceholder=function(e){return e instanceof o.e},e.prototype._isImage=function(e){return e instanceof o.d},e.prototype._isImageOrPlaceholder=function(e){return this._isImage(e)||this._isPlaceholder(e)},e.prototype._getSelectButtonTitle=function(e){return this._isPlaceholder(e)&&e.item.isBarcodePlaceholder?this._canvas.editBarcodeButtonTitle:this._canvas.selectButtonTitle},e.prototype._getControlRectangle=function(e,t){var n=t.get_contentAngle();n>0&&(e.rotateAt(n,new a.PointF),90===n?e.translate(t.get_workspaceHeight(),0):180===n?e.translate(t.get_workspaceWidth(),t.get_workspaceHeight()):270===n&&e.translate(0,t.get_workspaceWidth()));var i=e.toRectangleF(),o=t.zoom,r=t.get_screenXDpi()/72*o,l=t.get_screenYDpi()/72*o,c=a.RectangleF.FromLTRB(Math.floor(i.left*r),Math.floor(i.top*l),Math.ceil(i.right*r)+this._canvas.selectionWidth,Math.ceil(i.bottom*l)+this._canvas.selectionWidth);return t.contentToWhitespaceRectangle(new s.b(c.left,c.top,c.width,c.height))},e}()},878:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(368),o=n(378),r=n(434),a=n(393),s=function(){function e(e,t,n){this._selection=e,this._dndHandler=t,this._canvas=n,this._loadingImage=new Image}return e.prototype.redrawActiveCanvas=function(e,t,n){var i=this._getScaledContext(t),o=this._getScaledContext(n);if(null!=i&&null!=o){if(this._getItemHandlersByRenderState(e,r.g.Active).forEach(function(e){return e.draw(i)}),this._selection.get_selectedItemHandlers().get_count()>1)this._selection.get_selectedItemHandlers().forEach(function(e){e.drawHighlight(o)});else{var a=this._selection.get_currentItemHandler();null!=a&&a instanceof r.e&&a.editing&&(this._drawFade(o),a.draw(o),a.drawHighlight(o))}this._selection.draw(o,this),this._dndHandler.draw(),i.restore(),o.restore()}},e.prototype.redrawInactiveCanvas=function(e,t,n){var i=this._getScaledContext(t),o=this._getScaledContext(n);null!=i&&null!=o&&(this._drawMargins(i),this._getItemHandlersByRenderState(e,r.g.Bottom).forEach(function(e){return e.draw(i)}),this._getItemHandlersByRenderState(e,r.g.Top).forEach(function(e){return e.draw(o)}),o.restore(),i.restore())},e.prototype.drawRubberband=function(e,t){var n=this._canvas.get_mul(),i=1/n,r="rgba(0,0,0,1)",a="rgba(0,0,0,0)",s=2/n;o.a.drawDashedLine(e,t.left,t.top,t.right,t.top,i,r,a,s,s),o.a.drawDashedLine(e,t.right,t.top,t.right,t.bottom,i,r,a,s,s),o.a.drawDashedLine(e,t.right,t.bottom,t.left,t.bottom,i,r,a,s,s),o.a.drawDashedLine(e,t.left,t.bottom,t.left,t.top,i,r,a,s,s)},e.prototype.drawVerticalLine=function(e,t,n){o.a.drawLine(e,t,0,t,this._canvas.workspaceHeight,1/this._canvas.zoom,n)},e.prototype.drawHorizontalLine=function(e,t,n){o.a.drawLine(e,0,t,this._canvas.workspaceWidth,t,1/this._canvas.zoom,n)},e.prototype.drawWaitClock=function(e,t){var n=this._canvas.get_mul(),r=new i.RotatedRectangleF(t.x||0,t.y||0,this._loadingImage.width/n,this._loadingImage.height/n,0);this._loadingImage.complete&&o.a.drawImage(e,this._loadingImage,r,n,n)},e.prototype.setLoadingImageUrl=function(e){this._loadingImage.src=e},e.prototype._getScaledContext=function(e){if(null==e)return null;var t=e.getContext("2d");if(null==t)return null;o.a.clearCanvas(t),t.save();var n=a.a.screenDpi*this._canvas.zoom/72;return t.scale(n,n),t},e.prototype._getItemHandlersByRenderState=function(e,t){return e.selectMany(function(e){return e.itemHandlers.toArray()}).where(function(e){return e.renderState==t&&!(e instanceof r.e&&e.editing)})},e.prototype._drawFade=function(e){var t=i.RotatedRectangleF.FromLTRB(0,0,this._canvas.workspaceWidth,this._canvas.workspaceHeight);o.a.rectangle(e,t,0,null,"rgb(0, 0, 0)",.75)},e.prototype._drawMargins=function(e){var t=this._canvas.leftMargin,n=this._canvas.rightMargin,i=this._canvas.topMargin,r=this._canvas.bottomMargin,a=this._canvas.workspaceWidth,s=this._canvas.workspaceHeight,l=this._canvas.get_mul(),c=this._canvas.get_marginWidth()/l,h=this._canvas.get_marginColor();0!==t&&0!==n&&0!==i&&0!==r&&a>=t+n&&s>=i+r&&c>0&&(o.a.drawLine(e,t,i,t,s-r,c,h),o.a.drawLine(e,t,i,a-n,i,c,h),o.a.drawLine(e,a-n,s-r,t,s-r,c,h),o.a.drawLine(e,a-n,s-r,a-n,i,c,h))},e}()},879:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i,o=n(368),r=n(372),a=n(722),s=function(){function e(e){this.setConfiguration(e),this._snapData={xAnchors:[],yAnchors:[],defaultBounds:null,activeXAnchorIndex:null,activeYAnchorIndex:null,xPoints:[],yPoints:[],activeXPointIndex:null,activeYPointIndex:null}}return e.prototype.setConfiguration=function(e){this._conf=Object(r.a)(this._getDefaultConf,[e||{}])},Object.defineProperty(e.prototype,"configuration",{get:function(){return this._conf},enumerable:!0,configurable:!0}),e.prototype.drawActiveLines=function(e,t){if(null!=this._snapData.activeXAnchorIndex){var n=this._snapData.xAnchors[this._snapData.activeXAnchorIndex];t.drawVerticalLine(e,n.position,this._conf.snapElements[n.type].color)}if(null!=this._snapData.activeYAnchorIndex){var i=this._snapData.yAnchors[this._snapData.activeYAnchorIndex];t.drawHorizontalLine(e,i.position,this._conf.snapElements[i.type].color)}},e.prototype.resetActiveLines=function(){this._snapData.activeXAnchorIndex=null,this._snapData.activeYAnchorIndex=null},e.prototype.constrainDiffToSnapLines=function(e,t,n){if(null==t)return new o.PointF;var i=new o.PointF(e.x-t.x,e.y-t.y);if(!this._enabled)return i;null==i&&(i=new o.PointF(0,0));var r=i.clone();null==this._prevPoint&&(this._prevPoint=t);var a=e.x-this._prevPoint.x,s=e.y-this._prevPoint.y;this._prevPoint=e,this._snapData.activeXAnchorIndex=null;for(var l=a>0?0:this._snapData.xAnchors.length-1,c=a>0?this._snapData.xAnchors.length-1:0,h=a>0?1:-1,u=a>0?this._snapData.xPoints.length-1:0,d=a>0?0:this._snapData.xPoints.length-1,_=a>0?-1:1,p=l;p!==c+h;p+=h)for(var g=this._snapData.xAnchors[p],f=u;f!==d+_;f+=_){var v=this._snapData.xPoints[f],m=this._getSnapLineTolerance(n,g.type);if(Math.abs(v+i.x-g.position)<m){var y=null!=this._snapData.activeXAnchorIndex?this._conf.snapElements[this._snapData.xAnchors[this._snapData.activeXAnchorIndex].type]:null,C=this._conf.snapElements[g.type];(null==this._snapData.activeXAnchorIndex||C.priority>y.priority)&&(r.x=g.position-v,this._snapData.activeXAnchorIndex=p,this._snapData.activeXPointIndex=f)}}this._snapData.activeYAnchorIndex=null;for(var b=s>0?0:this._snapData.yAnchors.length-1,E=s>0?this._snapData.yAnchors.length-1:0,w=s>0?1:-1,D=s>0?this._snapData.yPoints.length-1:0,P=s>0?0:this._snapData.yPoints.length-1,M=s>0?-1:1,I=b;I!==E+w;I+=w)for(var T=this._snapData.yAnchors[I],x=D;x!==P+M;x+=M){var S=this._snapData.yPoints[x];m=this._getSnapLineTolerance(n,T.type);if(Math.abs(S+i.y-T.position)<m){y=null!=this._snapData.activeYAnchorIndex?this._conf.snapElements[this._snapData.yAnchors[this._snapData.activeYAnchorIndex].type]:null,C=this._conf.snapElements[T.type];(null==this._snapData.activeYAnchorIndex||C.priority>y.priority)&&(r.y=T.position-S,this._snapData.activeYAnchorIndex=I,this._snapData.activeYPointIndex=x)}}return r},e.prototype.constrainRectangleToSnapLines=function(e,t,n,r,s,l,c){var h=this;if(!this._enabled)return e;var u,d,_=e.clone();this._snapData.xPoints=[],this._snapData.yPoints=[];var p=r.resizeIndex-1;r.resizeIndex>4?((d=new o.PointF(s.centerX+a.a.cw[r.resizeIndex]*(s.width/2),s.centerY+a.a.ch[r.resizeIndex]*(s.height/2))).rotateAt(_.angle,s.center),(u=new o.PointF(l.centerX+a.a.cw[r.resizeIndex]*(l.width/2),l.centerY+a.a.ch[r.resizeIndex]*(l.height/2))).rotateAt(_.angle,l.center)):(d=s.getCornerByIndex(p),u=l.getCornerByIndex(p));var g,f,v=this,m=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),e=null==e||e,t=null==t||t,e||t){var n=h._getSnapLineTolerance(c,i.Items);e&&(v._snapData.xPoints=[d.x],Math.abs(d.x-u.x)>n&&v._snapData.xPoints.push(u.x)),t&&(v._snapData.yPoints=[d.y],Math.abs(d.y-u.y)>n&&v._snapData.yPoints.push(u.y))}};if(n){if(s.angle%90!=0&&r.resizeIndex>4)return e;var y=_.center,C=r.resizeIndex>4&&(_.angle-90)%180==0;m(a.a.cw[r.resizeIndex]!==(0^(C?1:0)),a.a.ch[r.resizeIndex]!==(0^(C?1:0)));var b=this.constrainDiffToSnapLines(d,d,c);if(null==b||Object(o.EqualsOfFloatNumbers)(b.x,0,.1)&&Object(o.EqualsOfFloatNumbers)(b.y,0,.01))return e;g=(f=0!==b.x&&0===this._snapData.activeXPointIndex||0!==b.y&&0===this._snapData.activeYPointIndex)?d:u;var E=new o.PointF(g.x+b.x,g.y+b.y),w=_.angle;E.rotateAt(-w,y),g.rotateAt(-_.angle,y),_.angle=0;var D=new o.PointF((E.x-g.x)*(f?_.width/s.width:1),(E.y-g.y)*(f?_.height/s.height:1));_.centerX+=D.x/2,_.width+=a.a.cw[r.resizeIndex]*D.x,_.centerY+=D.y/2,_.height+=a.a.ch[r.resizeIndex]*D.y,_.rotateAt(w,y)}else if(!n){if(t.getCornerByIndex(p).isEqual(u,.01))return e;m();var P=this.constrainDiffToSnapLines(u,u,c),M=Object(o.EqualsOfFloatNumbers)(P.x,0,.01),I=Object(o.EqualsOfFloatNumbers)(P.y,0,.01);if(M&&I)return e;g=(f=!M&&0===this._snapData.activeXPointIndex||!I&&0===this._snapData.activeYPointIndex)?d:u;var T,x=(p+2)%4,S=l.getCornerByIndex(x);T=M?new o.PointF(S.x,g.y+P.y):new o.PointF(g.x+P.x,S.y);var B=Object(o.getTriangleAngle)(T,g,S),H=Object(o.ConvertDegreeToRadian)(B),k=Math.sqrt(Object(o.getSquareDistanceToPoint)(S,T))/Math.cos(H)/Math.sqrt(Object(o.getSquareDistanceToPoint)(S,g));if(null==k)return e;var O=_.getCornerByIndex(x);_.width*=k,_.height*=k;var L=_.getCornerByIndex(x);_.centerX+=O.x-L.x,_.centerY+=O.y-L.y}return _},e.prototype.fillSnapData=function(e,t,n,r,s,l){if(this.clearSnapData(),this._snapData.defaultBounds=s.viewer.surface.printAreas.get(0).bounds,this._enabled&&null!=e){var c=[],h=[],u=function(e,t){var n=null!=r?o.RectangleF.intersect(e,r):e;n.isEmpty()||(c.push({position:n.left,type:t},{position:n.left+n.width/2,type:t},{position:n.right,type:t}),h.push({position:n.top,type:t},{position:n.top+n.height/2,type:t},{position:n.bottom,type:t}))},d=this._conf.snapElements;null!=r&&d.region.enabled&&u(r,i.Region),null!=this._snapData.defaultBounds&&d.printArea.enabled&&u(this._snapData.defaultBounds,i.PrintArea);var _=s.get_allHandlers({onlyVisible:!0,onlyUnlocked:!0,whiteListFilter:a.a.isSafetyLineItemHandler});(d.items.enabled||d.safetyLines.enabled)&&_.forEach(function(e){if(e.get_layer().get_visible())if(a.a.isSafetyLineItemHandler(e)){if(!d.safetyLines.enabled)return;var t=e.controlPoints[0],n=e.controlPoints[1];c.push({position:t.x,type:i.SafetyLines}),c.push({position:n.x,type:i.SafetyLines}),h.push({position:t.y,type:i.SafetyLines}),h.push({position:n.y,type:i.SafetyLines})}else!s.isItemHandlerSelected(e)&&d.items.enabled&&u(e.bounds,i.Items)});var p=function(e,t){void 0===t&&(t=null);var n=[];return e.sort(function(e,t){return e.position-t.position}).forEach(function(e,i){var r=n.slice(-1)[0];0!==i&&Object(o.EqualsOfFloatNumbers)(r.position,e.position,null!=t?t:.01)&&r.type===e.type||n.push(e)}),n},g=function(e,t){void 0===t&&(t=null);var n=[];return e.sort(function(e,t){return e-t}).forEach(function(e,i){0!==i&&Object(o.EqualsOfFloatNumbers)(n.slice(-1)[0],e,null!=t?t:.01)||n.push(e)}),n};if(this._snapData.xAnchors=p(c),this._snapData.yAnchors=p(h),l.drag){var f=t.bounds;this._snapData.xPoints=[n.left,e.centerX,n.right],this._snapData.yPoints=[n.top,e.centerY,n.bottom];var v=this._getSnapLineTolerance(s,i.Items);this._snapData.xPoints=g([f.left,n.left,t.centerX,e.centerX,n.right,f.right],v),this._snapData.yPoints=g([f.top,n.top,t.centerY,e.centerY,n.bottom,f.bottom],v)}}},e.prototype.clearSnapData=function(){this._snapData.xAnchors=[],this._snapData.yAnchors=[],this._snapData.activeXAnchorIndex=null,this._snapData.activeYAnchorIndex=null,this._snapData.xPoints=[],this._snapData.yPoints=[]},e.prototype._getSnapLineTolerance=function(e,t){return Math.abs(this._conf.snapElements[t.toString()].tolerance/e.get_zoom())},Object.defineProperty(e.prototype,"_getDefaultConf",{get:function(){var e={tolerance:5,color:"rgb(255,0,255)",enabled:!1,priority:0};return{snapElements:{items:e,printArea:e,safetyLines:e,region:e}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_enabled",{get:function(){var e=this._conf.snapElements;return e.items.enabled||e.printArea.enabled||e.region.enabled||e.safetyLines.enabled},enumerable:!0,configurable:!0}),e}();!function(e){e.Items="items",e.PrintArea="printArea",e.SafetyLines="safetyLines",e.Region="region"}(i||(i={}))},896:function(e,t,n){"use strict";var i=n(871),o=n(715),r=n(537),a=n(709),s=n(423),l=n(711),c=n(710),h=n(436),u=n(371),d=n(372),_=n(380),p=n(395),g=n(370),f=n(410),v=n(442),m=n(375),y=n(411),C=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},b=function(){function e(){var e=this;this._changedEvent=new g.b,this._visibilityChangedEvent=new g.a,this._containers=null,this._visible=!1,this._onPrintAreaAdded=function(t,n){e._clearCurrentSafetyLinesContainers(),e._subscribePrintAreaEvents(n),e._changedEvent.notify(e)},this._onPrintAreaRemoved=function(t,n){e._clearCurrentSafetyLinesContainers(),e._unsubscribePrintAreaEvents(n),e._changedEvent.notify(e)},this._onSafetyLinePropertyChanged=function(){e._clearCurrentSafetyLinesContainers(),e._changedEvent.notify(e)},this._onSafetyLinesCollectionRemoved=function(t){e._unsubscribeSafetyLineEvents(t.item),e._clearCurrentSafetyLinesContainers(),e._changedEvent.notify(e)},this._onSafetyLinesCollectionAdded=function(t){e._subscribeSafetyLineEvents(t.item),e._clearCurrentSafetyLinesContainers(),e._changedEvent.notify(e)}}return Object.defineProperty(e.prototype,"surface",{get:function(){return this._surface},set:function(e){var t=this;this._surface!==e&&(null!=this._surface&&this._surface.remove_printAreaAdded(this._onPrintAreaAdded),this._surface=e,this._clearCurrentSafetyLinesContainers(),null!=this._surface&&(this._surface.add_printAreaAdded(this._onPrintAreaAdded),this._surface.add_printAreaRemoved(this._onPrintAreaRemoved),this._surface.printAreas.forEach(function(e){return t._subscribePrintAreaEvents(e)})))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"safetyLinesContainers",{get:function(){return null==this._containers&&(this._containers=this._buildSafetyLinesContainers()),this._containers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){var t,n;if(this._visible!==e&&(this._visible=e,null!=this._containers)){var i=!1;try{for(var o=C(this._containers),r=o.next();!r.done;r=o.next()){var a=r.value;a.visible!==this._visible&&(a.visible=this._visible,i=!0)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}i&&this._visibilityChangedEvent.notify()}},enumerable:!0,configurable:!0}),e.prototype.addChanged=function(e){this._changedEvent.add(e)},e.prototype.removeChanged=function(e){this._changedEvent.remove(e)},e.prototype.addVisibilityChanged=function(e){this._visibilityChangedEvent.add(e)},e.prototype.removeVisibilityChanged=function(e){this._visibilityChangedEvent.remove(e)},e.prototype._clearCurrentSafetyLinesContainers=function(){this._containers=null},e.prototype._subscribePrintAreaEvents=function(e){var t=this;e.safetyLines.add_itemAdded(this._onSafetyLinesCollectionAdded),e.safetyLines.add_itemRemoved(this._onSafetyLinesCollectionRemoved),e.safetyLines.forEach(function(e){return t._subscribeSafetyLineEvents(e)})},e.prototype._unsubscribePrintAreaEvents=function(e){var t=this;e.safetyLines.forEach(function(e){return t._unsubscribeSafetyLineEvents(e)}),e.safetyLines.remove_itemAdded(this._onSafetyLinesCollectionAdded),e.safetyLines.remove_itemRemoved(this._onSafetyLinesCollectionRemoved)},e.prototype._subscribeSafetyLineEvents=function(e){e.addPropertyChanged(this._onSafetyLinePropertyChanged)},e.prototype._unsubscribeSafetyLineEvents=function(e){e.removePropertyChanged(this._onSafetyLinePropertyChanged)},e.prototype._buildSafetyLinesContainers=function(){var e,t,n,i,o=new _.a;if(null!=this.surface)try{for(var r=C(this.surface.printAreas),a=r.next();!a.done;a=r.next()){var s=a.value;if(null!=s.safetyLines)try{for(var l=C(s.safetyLines),c=l.next();!c.done;c=l.next()){var h=c.value,u=new p.a;u.locked=!0,u.name="SafetyLines["+s.name+"]",u.visible=this._visible,o.add(u);var d=this._createDashedRectangle(s.bounds,h);u.items.add(d)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return o},e.prototype._createDashedRectangle=function(e,t){var n=t.getRectangle(e),i=t.getCornerRadiuses(e),o=y.a.roundedRectangle(n.left,n.top,n.width,n.height,i),r=new f.a(o);return r.name=v.b.voPrefix+"_"+t.name+"_shape",r.borderColor=t.color,r.fillColor=m.ColorFactory.createColor("transparent"),r.fixedBorderWidth=!0,r.borderWidth=t.widthPx,null!=t.altColor&&(r.altBorderColor=t.altColor),r.dash=[t.stepPx,3],r},e}(),E=n(720),w=function(){function e(e,t){var n=this;this._productParser=new E.a,this._watermarkCollectionChangedEvent=new g.b,this._watermarkContainers=new _.a,this._onSurfacePropertyChanged=function(e,t){switch(t){case"width":case"height":n._updateWatermark()}},this._watermarkConfig=e,this._service=t,this._clearWatermarkContainer()}return Object.defineProperty(e.prototype,"surface",{get:function(){return this._surface},set:function(e){this._surface!==e&&(null!=this._surface&&this.surface.removePropertyChanged(this._onSurfacePropertyChanged),this._surface=e,this._watermarkConfig=null!=this._surface&&null!=this._surface.parentProduct?this._surface.parentProduct.watermarkConfig:null,null!=this._surface&&this.surface.addPropertyChanged(this._onSurfacePropertyChanged),this._updateWatermark())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"watermarkConfig",{get:function(){return this._watermarkConfig},set:function(e){this._watermarkConfig!==e&&(this._watermarkConfig=e,this._updateWatermark())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"watermarkContainers",{get:function(){return null==this._watermarkContainers&&(this._watermarkContainers=new _.a),this._watermarkContainers},enumerable:!0,configurable:!0}),e.prototype._setWatermarkContainers=function(e){this._watermarkContainers=e,this._watermarkCollectionChangedEvent.notify(this)},e.prototype.add_watermarkCollectionChanged=function(e){this._watermarkCollectionChangedEvent.add(e)},e.prototype.remove_watermarkCollectionChanged=function(e){this._watermarkCollectionChangedEvent.remove(e)},e.prototype._clearWatermarkContainer=function(){this._watermarkContainers=null},e.prototype._updateWatermark=function(){this._clearWatermarkContainer(),null!=this.surface&&0!==this.surface.width&&0!==this.surface.height&&null!=this.watermarkConfig&&null!=this.watermarkConfig.visibility&&!1!==this.watermarkConfig.visibility.canvas&&this._requestWatermarkItems()},e.prototype._requestWatermarkItems=function(){var e=this,t=Math.random();this._requestWatermarkItemsId=t,this._service.getWatermarkItemsAsync(this.surface.width,this.surface.height,this._watermarkConfig).then(function(n){try{if(t!==e._requestWatermarkItemsId)return;var i=new _.a([e._productParser.parseContainer(n)]);e._setWatermarkContainers(i)}catch(e){throw e}}).catch(function(e){console.error("Error while updating watermark items.",e)})},e}(),D=n(706),P=function(){function e(){var e=this;this._visible=!1,this._changedEvent=new g.a,this._onSurfacePropertyChanged=function(t,n){switch(n){case"width":case"height":e._updateGrid()}}}return Object.defineProperty(e.prototype,"surface",{get:function(){return this._surface},set:function(e){this._surface!==e&&(null!=this._surface&&this.surface.removePropertyChanged(this._onSurfacePropertyChanged),this._surface=e,null!=this._surface&&this.surface.addPropertyChanged(this._onSurfacePropertyChanged),this._updateGrid())},enumerable:!0,configurable:!0}),e.prototype.setConfig=function(e,t,n){this._config=e,this._unit=t,this._customUnitScale=n},Object.defineProperty(e.prototype,"gridContainers",{get:function(){var e=new _.a;return null!=this._gridContainer&&e.add(this._gridContainer),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridContainer",{get:function(){return this._gridContainer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this._updateGrid())},enumerable:!0,configurable:!0}),e.prototype.addChanged=function(e){this._changedEvent.add(e)},e.prototype.removeChanged=function(e){this._changedEvent.remove(e)},e.prototype._updateGrid=function(){null!=this._gridContainer&&this._width==this.surface.width&&this._height==this.surface.height||(this._gridContainer=this._createGrid()),null!=this._gridContainer&&this._gridContainer.visible!==this._visible&&(this._gridContainer.visible=this._visible,this._changedEvent.fire())},e.prototype._createGrid=function(){if(null==this.surface)return null;if(this._width=this.surface.width,this._height=this.surface.height,0===this.surface.width||0===this.surface.height)return null;if(null==this._config||null==this._unit)return null;var e=new p.a;e.locked=!0,e.visible=!1,e.name="Grid";var t=this._getUnitScale(),n=this._config.stepX/t,i=this._config.stepY/t;if(n>0&&i>0){var o=Math.round(this._width/n)+1,r=Math.round(this._height/i)+1;if(o>0&&o!==Number.POSITIVE_INFINITY&&r>0&&r!==Number.POSITIVE_INFINITY){var a=new D.a(0,0,o,r,n,i);a.horizontalLineColor=m.ColorFactory.createColor(this._config.horizontalColor),a.verticalLineColor=m.ColorFactory.createColor(this._config.verticalColor),a.lineWidth=this._config.lineWidthPx,a.fixedLineWidth=!0,e.items.add(a)}}return e},e.prototype._getUnitScale=function(){switch(this._unit){case"Mm":return.352777778;case"Cm":return.0352777778;case"Inch":return.0138888889;case"Custom":return this._customUnitScale;case"Point":default:return 1}},e}(),M=n(368),I=n(393),T=n(433),x=n(712),S=function(){function e(e){e=null!=e?e:{},Object(d.a)(this,[e],{deep:!0})}return e.prototype._getDefaultConfig=function(){return{stubImages:{barcode:{text:"Sample",postScriptName:"ArialMT"}}}},e}(),B=(function(){}(),function(){}(),n(404)),H=n(376),k=n(461),O=function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},L=function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},R=function(){function e(e,t){var n=this;this._viewer=e,this._backendUrl=t,this._viewer.add_onResize(function(){n._updatePosition(),null!=n._expireLicenseMessageElement&&n._updateHeightExpireLicenseMessage()})}return e.prototype.checkLicense=function(){return O(this,void 0,void 0,function(){var e,t;return L(this,function(n){switch(n.label){case 0:return null!=this._license?[3,2]:(e=this,[4,this._getLicense()]);case 1:e._license=n.sent(),n.label=2;case 2:return this._license.isEnterprise&&!this._license.isTrial?(this._getLeftDays()<=30&&(this._expireLicenseMessageElement=this._createExpireLicenseMessage(),(t=document.getElementById("aspnetForm").parentElement).insertBefore(this._expireLicenseMessageElement,t.childNodes[0]),this._updateHeightExpireLicenseMessage()),[2]):this._isFullLicense()?[2]:(this._watermarkElement=this._createElement(),this._viewer.get_element().parentElement.appendChild(this._watermarkElement),this._updatePosition(),[2])}})})},e.prototype._updatePosition=function(){if(null!=this._watermarkElement){var t=this._viewer.get_element().clientWidth,n=this._viewer.get_element().clientHeight,i=this._watermarkElement.clientWidth,o=this._watermarkElement.clientHeight,r=t-i-e._margin,a=n-o-e._margin;this._watermarkElement.style.left=r+"px",this._watermarkElement.style.top=a+"px"}},e.prototype._isFullLicense=function(){return!this._license.isTrial&&!this._license.isDeveloper},e.prototype._createExpireLicenseMessage=function(){var e=document.createElement("div");e.style.background="rgba(244, 67, 54, 0.1)";var t=document.createElement("p");return t.style.color="#F44336",t.style.fontSize="14px",t.style.margin="0",t.style.lineHeight="20px",t.style.padding="8px 16px",t.textContent="The license expires soon. It won't affect your current design, but please contact the website administrator or customer service department and let them know that you see this message.",e.appendChild(t),e},e.prototype._updateHeightExpireLicenseMessage=function(){var e=this._expireLicenseMessageElement;if(null!=e){var t=e.clientHeight;document.getElementById("aspnetForm").style.height="calc(100% - "+t+"px)",e.style.textAlign=t>36?"left":"center"}},e.prototype._createElement=function(){var e=document.createElement("div");e.id="cvLicenseWatermark",e.style.width="auto",e.style.height="auto",e.style.whiteSpace="nowrap",e.style.position="absolute",e.style.borderRadius="4px",e.style.backgroundColor="rgba(255, 255, 255, 0.5)",e.style.zIndex="1",e.style.pointerEvents="none";var t=document.createElement("div");t.style.padding="8px",t.style.display="flex",t.style.flexDirection="column";var n=document.createElement("span");n.style.fontFamily="Roboto",n.style.fontStyle="normal",n.style.fontWeight="500",n.style.fontSize="14px",n.style.lineHeight="15px",n.style.color="#333333";var i=document.createElement("span");i.style.fontFamily="Roboto",i.style.fontStyle="normal",i.style.fontSize="12px",i.style.lineHeight="18px",i.style.color="#333333",n.textContent="This is a "+this._getLicenseType()+" edition";var o=this._license.expirationDate.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return i.textContent="Expires on "+o+" ("+this._getLeftDays()+" days left)",t.appendChild(n),t.appendChild(i),e.appendChild(t),e},e.prototype._getLicenseType=function(){return this._license.isTrial?"Trial":this._license.isDeveloper?"Developer":""},e.prototype._getLeftDays=function(){var e=Math.max(0,this._license.expirationDate.getTime()-Date.now());return Math.ceil(e/864e5)},e.prototype._getLicense=function(){return O(this,void 0,void 0,function(){var e,t;return L(this,function(n){switch(n.label){case 0:return[4,k.d(Object(d.g)(this._backendUrl,"license"))];case 1:if((e=n.sent()).status!==k.c.Ok)throw new u.e("Cannot get license from server");return t=JSON.parse(e.value),[2,Object(d.b)(new W,{isDeveloper:t.isDeveloper,isTrial:t.isTrial,isDesktopOnly:t.isDesktopOnly,isEnterprise:t.isEnterprise,expirationDate:new Date(t.expirationDate)})]}})})},e._margin=12,e}(),W=function(){return function(){}}();n.d(t,"a",function(){return j});var z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),A=function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},F=function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},U=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a},q=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(U(arguments[t]));return e},V=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},j=function(e){function t(t){var n=t.holderElement,i=t.backendUrl,o=t.surface,r=void 0===o?new h.a:o,a=t.canvasBackground,s=void 0===a?"chess":a,_=t.rulerEnabled,p=void 0===_||_,f=t.frontEndTextRenderingEnabled,v=void 0!==f&&f,m=t.zone,y=void 0===m?null:m,C=t.productViewerPartId,E=void 0===C?"ProductViewer":C,D=e.call(this,y)||this;if(D._containersFlatList=[],D.containersFlatListChangedEvent=new g.a,D._surface=null,D._onSurfacePropertyChanged=function(e,t){switch(t){case"mockup":D._updateContainersFlatList();break;case"width":case"height":D._canvas.set_workspaceSize(D.surface.width,D.surface.height)}},D._updateContainersFlatList=function(){var e=D._containersFlatList;D._containersFlatList=q(D.surface.mockup.underContainers,D.surface.containers,D.surface.mockup.overContainers,D._safetyLinesHandler.safetyLinesContainers,D._watermarkHandler.watermarkContainers,D._gridHandler.gridContainers),D.containersFlatListChangedEvent.notify(D._getDifference(e,D._containersFlatList))},D._setActiveThrowsException=!1,D.frontEndTextRenderingEnabled=v,D._backendUrl=i,D._serviceEndPoint=Object(d.g)(D._backendUrl,"api/ccviewer"),D._normalizeHolderElement(n),D._viewerElement=D._createViewerElement(n,E),D._canvas=D._createCanvas(),D.frontEndTextRenderingEnabled)throw new u.f;return D._screenXDpi=D._screenYDpi=96,D._canvasSaveStateDelegate=null,D._bitmapViewerSaveStateDelegate=null,D._mouseMoveDelegate=null,D._mouseUpDelegate=null,D._mouseDownDelegate=null,D._ignoreMouseDown=!1,D._ignoreMouseDownTimeout=null,D._doubleClickDelegate=null,D._zoomDelegate=null,D._resizeDelegate=null,D._keyDownDelegate=null,D._keyUpDelegate=null,D._modalBgClass=null,D._clearSelectionOnDocumentClick=!0,D._clearSelectionOnViewerClick=!0,D._devicePixelRatio=1,D._whitespaceDiv=null,D._resizeCheckIntervalId=null,D._safetyLinesHandler=new b,D._safetyLinesHandler.addChanged(D._updateContainersFlatList),D._safetyLinesHandler.addVisibilityChanged(function(){D.canvas.redraw()}),D._watermarkHandler=new w(null,D._canvas.service),D._watermarkHandler.add_watermarkCollectionChanged(D._updateContainersFlatList),D._gridHandler=new P,D._gridHandler.addChanged(function(){D.canvas.redraw()}),D.surface=r,D._licenseHandler=new R(D,D._serviceEndPoint),D.initialize({ignore:!1}),D.zoomMode=l.a.bestFit,D.set_viewportAlignment(c.a.centerCenter),D.rulerEnabled=p,D._setCanvasBackground(s),D}return z(t,e),Object.defineProperty(t.prototype,"containersFlatList",{get:function(){return this._containersFlatList},enumerable:!0,configurable:!0}),t.prototype._normalizeHolderElement=function(e){e.style.overflow="hidden",e.style.userSelect="none",e.style.position="relative"},t.prototype._createViewerElement=function(e,t){var n=document.createElement("div");return n.id=e.id+"_"+t,n.attributes.name=n.id,n.style.width="100%",n.style.height="100%",n.style.display="block",n.style.zIndex="1",n.style.margin="0",n.style.padding="0",n.style.border="0",n.style.position="relative",n.style.overflow="hidden",n.style.transform="translate3d(0px, 0px, 0px)",n.style.touchAction="none",e.appendChild(n),n},Object.defineProperty(t.prototype,"licenseHandler",{get:function(){return this._licenseHandler},enumerable:!0,configurable:!0}),t.prototype._createCanvas=function(){var e=new i.a(this);return e.serviceEndpoint=this._serviceEndPoint,e.loadingImageUrl=Object(d.g)(this._serviceEndPoint,"/resource?image=waitclock"),e.set_handlerUrl(this._serviceEndPoint),e.initialize(),e.multipleSelectionEnabled=!0,e},t.prototype._setCanvasBackground=function(e){"chess"===e?(this.canvas.backgroundImage=Object(d.g)(this._serviceEndPoint,"/resource?image=background"),this.canvas.isSquaredBackground=!0):this.canvas.get_surfaceCanvas().style.backgroundColor=e.color},Object.defineProperty(t.prototype,"fontRegistry",{get:function(){return this._fontRegistry},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),t.prototype.get_canvas=function(){return this.canvas},t.prototype.get_whitespaceDiv=function(){return this._whitespaceDiv},Object.defineProperty(t.prototype,"surface",{get:function(){return this._surface},set:function(e){if(null==e)throw new u.c("surface");var t=this.surface;e!==t&&(this._canvas.clearSelectedItemHandlers(),this._surface=e,this._onCurrentSurfaceChange(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"safetyLinesHandler",{get:function(){return this._safetyLinesHandler},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gridHandler",{get:function(){return this._gridHandler},enumerable:!0,configurable:!0}),t.prototype._onCurrentSurfaceChange=function(e){var t,n,i,o,r,a,s,l,c,h,u,d,_=this;if(this._safetyLinesHandler.surface=this.surface,this._watermarkHandler.surface=this.surface,this._gridHandler.surface=this.surface,this.canvas.service.beginMultiCall(),this._canvas.set_workspaceSize(this.surface.width,this.surface.height),this._updateContainersFlatList(),this.canvas.service.endMultiCall(),null!=e)try{for(var p=V(this._getContainerCollections(e)),g=p.next();!g.done;g=p.next()){var f=g.value;try{for(var v=V(f),m=v.next();!m.done;m=v.next()){var y=m.value;try{for(var C=V(y.items),b=C.next();!b.done;b=C.next()){var E=b.value;this.getHandler(E).canvas=null}}catch(e){r={error:e}}finally{try{b&&!b.done&&(a=C.return)&&a.call(C)}finally{if(r)throw r.error}}}}catch(e){i={error:e}}finally{try{m&&!m.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}f.remove_collectionChanged(this._updateContainersFlatList)}}catch(e){t={error:e}}finally{try{g&&!g.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}try{for(var w=V(this._getContainerCollections(this._surface)),D=w.next();!D.done;D=w.next()){f=D.value;try{for(var P=V(f),M=P.next();!M.done;M=P.next()){y=M.value;try{for(var I=V(y.items),T=I.next();!T.done;T=I.next()){E=T.value;this.getHandler(E).canvas=this.canvas}}catch(e){u={error:e}}finally{try{T&&!T.done&&(d=I.return)&&d.call(I)}finally{if(u)throw u.error}}}}catch(e){c={error:e}}finally{try{M&&!M.done&&(h=P.return)&&h.call(P)}finally{if(c)throw c.error}}f.add_collectionChanged(this._updateContainersFlatList)}}catch(e){s={error:e}}finally{try{D&&!D.done&&(l=w.return)&&l.call(w)}finally{if(s)throw s.error}}this._canvas.updateColors(),this.surface.addPropertyChanged(this._onSurfacePropertyChanged);var x=this._surface.containers.toArray().filter(function(e){return e.renderingType!==B.RenderingType.Normal});H.isEmpty(x)||(this._canvas.disabledLayers=x.map(function(e){return _._canvas.layers.getLayerByContainerId(e.id)}),this._canvas.maskedLayers=this._canvas.disabledLayers,this._canvas.redraw())},t.prototype._getContainerCollections=function(e){return[e.mockup.underContainers,e.mockup.overContainers,e.containers,this._safetyLinesHandler.safetyLinesContainers,this._watermarkHandler.watermarkContainers,this._gridHandler.gridContainers]},Object.defineProperty(t.prototype,"watermarkConfig",{get:function(){return this._watermarkHandler.watermarkConfig},set:function(e){this._watermarkHandler.watermarkConfig=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItems",{get:function(){var e=this.canvas.get_selectedItemHandlers();return null!==e?e.select(function(e){return e.item}).toArray():null},set:function(e){if(null!=e){var t=e.map(this.canvas.handlerFactory.get);this.canvas.set_selectedItemHandlers(t)}else this.canvas.clearSelectedItemHandlers()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentItem",{get:function(){var e=this.canvas.get_currentItemHandler();return null!=e?e.item:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"configuration",{get:function(){return this._configuration},set:function(e){this._configuration=new S(e),this.gridHandler.setConfig(this._configuration.grid,this._configuration.rulers.unit,this._configuration.rulers.customUnitScale),this.canvas.snapLinesHandler.setConfiguration(this._configuration.snapLines)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomConfig",{get:function(){return this._configuration?this._configuration.zoom:null},enumerable:!0,configurable:!0}),t.prototype._getDifference=function(e,t){return{added:t.reduce(function(t,n){return e.includes(n)||t.push(n),t},new Array),removed:e.reduce(function(e,n){return t.includes(n)||e.push(n),e},new Array)}},t.prototype.get_contentWidth=function(){return this._get_contentDimension(this.get_workspaceWidth(),this.get_canvas().get_screenXDpi())},t.prototype.get_contentHeight=function(){return this._get_contentDimension(this.get_workspaceHeight(),this.get_canvas().get_screenYDpi())},t.prototype._get_contentDimension=function(e,t){var n=T.a(T.c(e,t)*this.zoom);return Math.ceil(n)},t.prototype.get_workspaceWidth=function(){return this.get_canvas().get_workspaceWidth()},t.prototype.get_workspaceHeight=function(){return this.get_canvas().get_workspaceHeight()},t.prototype.get_actualSizeHorizontalScale=function(){return this.get_canvas().get_screenXDpi()/I.a.devicePixelRatio/72},t.prototype.get_actualSizeVerticalScale=function(){return this.get_canvas().get_screenYDpi()/I.a.devicePixelRatio/72},t.prototype.get_modalBgClass=function(){return this._modalBgClass},t.prototype.set_modalBgClass=function(e){this._modalBgClass=e},Object.defineProperty(t.prototype,"clearSelectionOnDocumentClick",{get:function(){return this._clearSelectionOnDocumentClick},set:function(e){this._clearSelectionOnDocumentClick=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clearSelectionOnViewerClick",{get:function(){return this._clearSelectionOnViewerClick},set:function(e){this._clearSelectionOnViewerClick=e},enumerable:!0,configurable:!0}),t.prototype._renderContent=function(e){return e+='<div id="cvImage" style="',e+="width:"+this.get_contentWidth()+"px;height:"+this.get_contentHeight()+"px;",e+='position:absolute;left:0px;top:0px;z-index:1"/>'},t.prototype._setZoomMode=function(t){e.prototype._setZoomMode.call(this,t),Object(M.EqualsOfFloatNumbers)(this.canvas.zoom,this.zoom)||(this.canvas.set_zoom(this.zoom),this.canvas.redraw())},t.prototype.setZoom=function(t,n){if("number"==typeof t){this.zoomConfig&&(t>this.zoomConfig.max&&(t=this.zoomConfig.max),t<this.zoomConfig.min&&(t=this.zoomConfig.min)),t=e.prototype.setZoom.call(this,t,n);var i=this.get_canvas();return i.service.beginMultiCall(),i.set_zoom(t),i.service.endMultiCall().finally(function(){return i.redraw()}),t}},t.prototype.get_maxZoom=function(){var t=e.prototype.get_maxZoom.call(this);return Math.min(t,this.get_canvas().calcPlatformLimitZoom())},t.prototype._onDocumentClick=function(t){if(!0!==this._ignoreDocumentClickOnce){if(e.prototype._onDocumentClick.call(this,t),this.clearSelectionOnDocumentClick&&!this._ignoreSelectionClick(t)){var n=this.get_canvas();n&&n.get_selectedItemHandlers().get_count()>0&&(n.clearSelectedItemHandlers(),n.redraw())}}else this._ignoreDocumentClickOnce=!1},t.prototype._ignoreSelectionClick=function(e){return!!this.get_element().contains(e.target)||s.c.isEventPathContainsClass(e,t.preventClickHandleClass)},t.prototype._onMouseMove=function(t){e.prototype._onMouseMove.call(this,t);var n=this.get_canvas();(n.multipleSelectionEnabled||n.get_selectedItemHandlers().get_count()>0)&&t.preventDefault()},t.prototype._onTouch=function(t){e.prototype._onTouch.call(this,t),this._touchFlags.isScroll=!0,this._touchFlags.isScrollChecked=!1,this._touchFlags.gestureCenter=null,this._touchFlags.lastPinchEvent=null,this._touchFlags.initialCurrentLeft=this._holderElement.scrollLeft,this._touchFlags.initialCurrentTop=this._holderElement.scrollTop},t.prototype._onPinch=function(t){null!==this._touchFlags.mouseDown.onTimeout&&(clearTimeout(this._touchFlags.mouseDown.timeout),this._touchFlags.mouseDown.onTimeout=null);var n=this._touchFlags;if(null==n.gestureCenter&&(n.gestureCenter=t.gesture.center),n.lastPinchEvent=t,n.isScroll){var i=n.initialCurrentLeft+(n.gestureCenter.pageX-t.gesture.center.pageX),o=n.initialCurrentTop+(n.gestureCenter.pageY-t.gesture.center.pageY);this.set_scrollingPosition(new M.PointF(i,o))}else(!I.a.IsIos()||I.a.IosMajorVersion()>5)&&e.prototype._onPinch.call(this,t,!1);if(!n.isScrollChecked&&this.pinchZoomEnabled&&t.gesture.deltaTime>350){n.isScrollChecked=!0;var r=this._calcAngle(t.gesture.touches[0],t.gesture.touches[1],n.gestureCenter);this._isPinchByAngle(r,t.gesture.scale)&&this._isPinchByModule(t.gesture.touches[0],t.gesture.touches[1],n.gestureCenter)&&(n.isScroll=!1,e.prototype._onPinch.call(this,t,!1))}},t.prototype._onRelease=function(t){var n=this._touchFlags;if(this.pinchZoomEnabled&&!n.isScrollChecked&&null!=n.lastPinchEvent){var i=this._calcAngle(n.lastPinchEvent.gesture.touches[0],n.lastPinchEvent.gesture.touches[1],n.gestureCenter);this._isPinchByAngle(i,n.lastPinchEvent.gesture.scale)&&e.prototype._onPinch.call(this,n.lastPinchEvent,!1)}e.prototype._onRelease.call(this,t)},t.prototype._isPinchByAngle=function(e,t){return I.a.IsTouchIE()?e>=160||t<=.85||t>=1.3:e>=160&&(t<=.85||t>=1.3)},t.prototype._isPinchByModule=function(e,t,n){var i=[e.pageX-n.pageX,e.pageY-n.pageY],o=[t.pageX-n.pageX,t.pageY-n.pageY],r=Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)),a=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)),s=[i[0]+o[0],i[1]+o[1]],l=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2));return l<r&&l<a},t.prototype._calcAngle=function(e,t,n){var i=[e.pageX-n.pageX,e.pageY-n.pageY],o=[t.pageX-n.pageX,t.pageY-n.pageY],r=(i[0]*o[0]+i[1]*o[1])/(Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2))*Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)));return 180*Math.acos(r)/Math.PI},t.prototype.initialize=function(n){var i=this,o=void 0===n?{}:n,a=o.ignore,l=void 0===a||a,c=o.intervalCheckLoop,h=void 0===c?null:c;if(!l){e.prototype.initialize.call(this,h),this._holderElement.style.msTouchAction="none",this._holderElement.style.touchAction="none",this._contentElements.push(this._imageCtx=this.get_element().querySelector("#cvImage")),this._whitespaceDiv=document.createElement("div"),this._whitespaceDiv.id="cvWhitespace",this._whitespaceDiv.tabIndex=-1,this._whitespaceDiv.style.position="absolute",this._whitespaceDiv.style.zIndex="1",this._whitespaceDiv.style.overflow="hidden",this._holderElement.appendChild(this._whitespaceDiv),this._updateWhitespace();var u=this._get_pointerEvents();this._whitespaceDiv.addEventListener("click",s.c.createBoundedWrapper(this,this._onWorkspaceClick)),u.start.split(" ").forEach(function(e){i._holderElement.addEventListener(e,s.c.createBoundedWrapper(i,i._onWhitespaceMouseDown))}),u.move.split(" ").forEach(function(e){i._holderElement.addEventListener(e,s.c.createBoundedWrapper(i,i._onWhitespaceMouseMove))}),u.up.split(" ").forEach(function(e){i._holderElement.addEventListener(e,s.c.createBoundedWrapper(i,i._onWhitespaceMouseUp))}),u.cancel.split(" ").forEach(function(e){i._holderElement.addEventListener(e,s.c.createBoundedWrapper(i,i._onWhitespaceMouseUp))}),x(this._whitespaceDiv).on("doubletap",this._onWorkspaceDoubleClick.bind(this));var d=this.get_canvas();d.addStyles();var _,p=this._contentCtx.firstChild;this._onCanvasStatusChangedDelegate||(this._onCanvasStatusChangedDelegate=this._onCanvasStatusChanged.bind(this),d.add_statusChanged(this._onCanvasStatusChangedDelegate));d.get_status()==r.a.ready&&d.get_isInitialized()?(d.set_zoom(this.zoom,!0),d.addElement(p),d.redraw()):(_=function(){d.get_status()==r.a.ready&&d.get_isInitialized()&&(d.remove_statusChanged(_),d.remove_initialized(_),_=null,d.set_zoom(this.get_zoom(),!0),d.addElement(p),d.redraw())}.bind(this),d.add_statusChanged(_),d.add_initialized(_));var g=function(e){return!(null!=e.code&&!s.c.isEventPathContainsClass(e,t.preventKeyHandleClass)&&s.c.getEventPath(e).includes(d.viewer.get_whitespaceDiv()))||"ArrowLeft"!==e.code&&"ArrowUp"!==e.code&&"ArrowRight"!==e.code&&"ArrowDown"!==e.code&&"ShiftLeft"!==e.code&&"ShiftRight"!==e.code&&"Delete"!==e.code&&function(e){if(e.ctrlKey||e.metaKey)return"KeyZ"!==e.code&&"KeyY"!==e.code;return!0}(e)};this._keyUpDelegate=function(e){g(e)||(d.raiseKeyUp(e),e.preventDefault())},this._keyDownDelegate=function(e){g(e)||(d.raiseKeyDown(e),e.preventDefault())},document.addEventListener("keyup",this._keyUpDelegate),document.addEventListener("keydown",this._keyDownDelegate),this._touchFlags.mouseDown={onTimeout:null},this._mouseDownDelegate=function(e,t){if(i._setActiveElementIeFix(),"touchstart"===t.type||"MSPointerDown"===t.type||"pointerDown"===t.type){"touchstart"===t.type&&(i._ignoreMouseDown=!0),null!=i._ignoreMouseDownTimeout&&clearTimeout(i._ignoreMouseDownTimeout),i._ignoreMouseDownTimeout=setTimeout(function(){this._ignoreMouseDown=!1},300);var n=function(){d.raiseMouseDown(t)};i._touchFlags.mouseDown.onTimeout=n,i._touchFlags.mouseDown.timeout=setTimeout(n,250)}else i._ignoreMouseDown||d.raiseMouseDown(t);return!0},this.add_workspaceMouseDown(this._mouseDownDelegate),this._doubleClickDelegate=function(e,t){return i._setActiveElementIeFix(),d.raiseDoubleClick(t),!0},this.add_workspaceDoubleClick(this._doubleClickDelegate),this._mouseMoveDelegate=function(e,t){return null!==i._touchFlags.mouseDown.onTimeout&&(clearTimeout(i._touchFlags.mouseDown.timeout),i._touchFlags.mouseDown.onTimeout(),i._touchFlags.mouseDown.onTimeout=null),d.raiseMouseMove(t),!0},this.add_workspaceMouseMove(this._mouseMoveDelegate),this._mouseUpDelegate=function(e,t){return null!==i._touchFlags.mouseDown.onTimeout&&(clearTimeout(i._touchFlags.mouseDown.timeout),i._touchFlags.mouseDown.onTimeout(),i._touchFlags.mouseDown.onTimeout=null),d.raiseMouseUp(t),!0},this.add_workspaceMouseUp(this._mouseUpDelegate),this._resizeDelegate=this._onResize.bind(this),d.add_workspaceSizeChanged(this._resizeDelegate),this._resizeCheckIntervalId=this._intervalCheckLoop.start({checkFunction:function(){return i._devicePixelRatio!==I.a.devicePixelRatio},onChange:function(){i._devicePixelRatio=I.a.devicePixelRatio,i._onResize(i,!1)}})}},t.prototype._onWorkspaceClick=function(t){e.prototype._onWorkspaceClick.call(this,t);var n=new M.PointF(t.x,t.y),i=this.canvas.getItemHandlersByHitTest(n);null!=i[0]&&i[0].dispatchClickEvent(null)},t.prototype._setActiveElementIeFix=function(){if(I.a.IsIE()){var e=this.get_element();try{if(!(document.activeElement===e)&&e.setActive){if(!this._setActiveThrowsException)try{e.setActive(!0)}catch(e){this._setActiveThrowsException=!0}if(this._setActiveThrowsException){var t=null;try{t=this._getCurrentScrollPosition()}catch(e){}e.focus(),t&&window.parent.scrollTo(t.x,t.y)}}}catch(e){console.log(e)}}},t.prototype._getCurrentScrollPosition=function(){var e,t,n=null!=window.parent?window.parent:window;return void 0!==n.pageXOffset?(e=n.pageXOffset,t=n.pageYOffset):void 0!==n.scrollX?(e=n.scrollX,t=n.scrollY):document.documentElement&&void 0!==document.documentElement.scrollLeft?(e=document.documentElement.scrollLeft,t=document.documentElement.scrollTop):(e=document.body.scrollLeft,t=document.body.scrollTop),{x:e,y:t}},t.prototype._updateWhitespace=function(){if(null!=this._whitespaceDiv){var e=90===this._contentAngle||270===this._contentAngle,t=e?this.get_contentHeight():this.get_contentWidth(),n=e?this.get_contentWidth():this.get_contentHeight(),i=this._getViewportLocation(),o=this.get_width(),r=this.get_height(),s=this.rulerEnabled?this.rulerWidth:0,l=this.get_scrollBarWidth(),c=this.get_scrollBarsStyle()===a.a.always,h=this.get_scrollBarsStyle()===a.a.auto,u=c||h&&n>r-s,d=c||h&&t>o-s;u=u||d&&h&&n>r-s-l,d=d||u&&h&&t>o-s-l;var _=u?l:0,p=d?l:0;this._whitespaceDiv.style.left=Math.min(i.x,s)+"px",this._whitespaceDiv.style.top=Math.min(i.y,s)+"px",this._whitespaceDiv.style.width=Math.max(o-s-_,t)+"px",this._whitespaceDiv.style.height=Math.max(r-s-p,n)+"px",h&&(this._holderElement.style.overflowX=d?"auto":"hidden",this._holderElement.style.overflowY=u?"auto":"hidden"),this.canvas.updateButtonGroups()}},t.prototype._updateViewport=function(){e.prototype._updateViewport.call(this),this._updateWhitespace()},t.prototype._onWhitespaceDoubleClick=function(e){var t=this._useWorkspaceCoords(e),n={x:t.x,y:t.y};this._workspaceDoubleClickEvent.notify(this,n)},t.prototype._onWhitespaceMouseDown=function(e){if(!this._isManyTouches(e)){var t=this._useWorkspaceCoords(e);this._workspaceMouseDownEvent.notify(this,t),I.a.IsTouchIE()||this._whitespaceDiv.setCapture()}},t.prototype._onWhitespaceMouseUp=function(e){if(!this._isManyTouches(e)){var t=this._useWorkspaceCoords(e);this._workspaceMouseUpEvent.notify(this,t),this._whitespaceDiv.releaseCapture()}},t.prototype._onWhitespaceMouseMove=function(e){if(this._isManyTouches(e))e.preventDefault();else{var t=this._useWorkspaceCoords(e);this._workspaceMouseMoveEvent.notify(this,t)}},t.prototype._get_elementForCursor=function(){return null!=this._whitespaceDiv?this._whitespaceDiv:e.prototype._get_elementForCursor.call(this)},t.prototype._onResize=function(t,n){e.prototype._onResize.call(this,t,n);var i=this.get_canvas();i.service.beginMultiCall(),i.set_zoom(this.zoom,void 0,{force:!0,updateButtonGroup:n}),i.service.endMultiCall().finally(function(){return i.redraw()})},t.prototype._onCanvasStatusChanged=function(e){this.get_canvas().get_status()==r.a.busy?this.lockViewer():this.unlockViewer()},t.prototype.lockViewer=function(){this._isViewerLocked=!0;var e=this.get_element(),t=document.getElementById(this.get_id()+"_modalBg");if(!t){var n=(t=document.createElement("div")).style;n.position="absolute",n.top="0",n.left="0",this._modalBgClass?t.className=this._modalBgClass:(n.backgroundPosition="50% 50%",n.backgroundColor="#000000",n.opacity="0.4",n.filter="alpha(opacity=40)",n.zIndex="1000"),t.id=this.get_id()+"_modalBg",e.offsetParent&&e.offsetParent.appendChild(t),n.width="100%",n.height="100%",n.bottom="0",n.right="0"}t.style.display="block"},t.prototype.unlockViewer=function(){this._isViewerLocked=!1;var e=document.getElementById(this.get_id()+"_modalBg");e&&(e.style.display="none")},t.prototype.contentToWhitespaceRectangle=function(e){var t=this.rulerEnabled?this.rulerWidth:0,n=this._getViewportLocation();return new s.b(e.x+n.x-t,e.y+n.y-t,e.width,e.height)},t.prototype.getHandler=function(e){return this._canvas.handlerFactory.get(e)},t.prototype.waitUpdate=function(){return A(this,void 0,void 0,function(){return F(this,function(e){switch(e.label){case 0:return[4,this._canvas.waitUpdate()];case 1:return e.sent(),[2]}})})},t.prototype.getParentPosition=function(e){var t=this.get_element();return{top:e.offsetTop-t.scrollTop,left:e.offsetLeft-t.scrollLeft}},t.prototype.dispose=function(){null!=this._resizeCheckIntervalId&&this._intervalCheckLoop.stop(this._resizeCheckIntervalId);var t=this.get_canvas();t&&(this._mouseUpDelegate&&(this.remove_workspaceMouseUp(this._mouseUpDelegate),this._mouseUpDelegate=null),this._mouseDownDelegate&&(this.remove_workspaceMouseDown(this._mouseDownDelegate),this._mouseDownDelegate=null),this._mouseMoveDelegate&&(this.remove_workspaceMouseMove(this._mouseMoveDelegate),this._mouseMoveDelegate=null),this._doubleClickDelegate&&(this.remove_workspaceDoubleClick(this._doubleClickDelegate),this._doubleClickDelegate=null),this._zoomDelegate&&(this.remove_zoomed(this._zoomDelegate),this._zoomDelegate=null),this._onCanvasStatusChangedDelegate&&(t.remove_statusChanged(this._onCanvasStatusChangedDelegate),delete this._onCanvasStatusChangedDelegate),this._resizeDelegate&&(t.remove_workspaceSizeChanged(this._resizeDelegate),delete this._resizeDelegate)),e.prototype.dispose.call(this)},t.prototype._refresh=function(){this._refreshTimer&&window.clearTimeout(this._refreshTimer),this._needToRefresh=!1},t.preventKeyHandleClass="preventCanvasKeyHandle",t.preventClickHandleClass="preventCanvasClickHandle",t}(o.a)},897:function(e,t,n){"use strict";var i=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a},o=function(){function e(e,t){this._service=e,this._imageLoaderService=t,this._multiCallInProgress=!1,this._multiCallItems=null,this._multiCallCallbacks=null,this._endMultiCallPromiseFuncs=null,this._multiCallInProgress=!1,this._multiCallItems=[],this._multiCallCallbacks=[],this._multiCallCounter=0,this._endMultiCallPromiseFuncs=[]}return e.prototype.increaseCounter=function(){this._multiCallCounter++},e.prototype.decreaseCounter=function(){return this._multiCallCounter--,this._multiCallCounter},e.prototype.enqueueEndMultiCall=function(){var e=this;return new Promise(function(t,n){return e._endMultiCallPromiseFuncs.push([t,n])})},Object.defineProperty(e.prototype,"multiCallStarted",{get:function(){return this._multiCallCounter>0},enumerable:!0,configurable:!0}),e.prototype.beginMultiCall=function(){this.increaseCounter()},e.prototype.endMultiCall=function(e){if(void 0===e&&(e=!0),this.decreaseCounter()>0)return this.enqueueEndMultiCall();if(null==this._multiCallItems||this._multiCallItems.length<1)return this._onMultiCallFinally(),Promise.resolve(!1);var t=this._multiCallItems,n=this._multiCallCallbacks,i=this._endMultiCallPromiseFuncs;return this._multiCallItems=[],this._multiCallCallbacks=[],this._endMultiCallPromiseFuncs=[],this._updateByMultiCall(t,n,i,e)},e.prototype.queueForMultiCall=function(e,t,n){return!this._multiCallInProgress&&(this._multiCallItems.push(e),this._multiCallCallbacks.push([t,n]),!0)},e.prototype._updateByMultiCall=function(e,t,n,i){var o=this;return void 0===i&&(i=!0),this._multiCallInProgress=!0,new Promise(function(r,a){var s=o._filter(e,t);o._updateByMultiCallRequest({items:s.items},function(e){return o._onMultiCallDone(e,s.callbacks,r,n,i)},function(i,r,s){return o._onMultiCallFailed(i,r,s,e,t,a,n)})})},e.prototype._filter=function(e,t){e=e.reverse(),t=t.reverse();var n=[],i=[];return{items:e=e.filter(function(e,t){return!i.includes(e.itemData.id)&&(i.push(e.itemData.id),n.push(t),!0)}),callbacks:n.map(function(e){return t[e]})}},e.prototype._onMultiCallDone=function(e,t,n,i,o){void 0===o&&(o=!0);try{o&&this._imageLoaderService.loadCombinedImage(e.combinedImageDescription);for(var r=e.items,a=0;a<r.length;a++)this._processItemResult(r[a],t[a])}finally{this._onMultiCallFinally(),n(!0),null!=i&&i.forEach(function(e){return e[0](!0)})}},e.prototype._processItemResult=function(e,t){try{var n=i(t,2),o=n[0],r=n[1];e.error?r({errorMessage:e.errorMessage}):o(e.result)}catch(e){console.error("Error while processing ItemHandlers service response",e)}},e.prototype._onMultiCallFailed=function(e,t,n,i,o,r,a){try{for(var s=0;s<o.length;s++)o[s][1]&&o[s][1](e,t,n)}finally{this._onMultiCallFinally(),r(),null!=a&&a.forEach(function(e){return e[1]()})}},e.prototype._updateByMultiCallRequest=function(e,t,n){this._service.sendRequest("UpdateByMultiCallRequest",e,t,n)},e.prototype._onMultiCallFinally=function(){this._multiCallInProgress=!1,this._multiCallItems=[],this._multiCallCallbacks=[]},e}(),r=n(469),a=n(383),s=n(370),l=function(){function e(e){this._serviceEndpoint=e,this.imageContainers={},this._fileCacheIdToCombined={},this._rectangles={},this._imageContainerLoadedEvent=new s.b}return e.prototype.loadCombinedImage=function(e){var t=this;if(null!=e){var n=new r.a(function(){return t._raiseImageLoadedEvent()});for(var i in this.imageContainers[e.fileCacheId]=n,n.updateUrl(this._getImageUrl(e.fileCacheId)),e.itemsRectangles)this._fileCacheIdToCombined[i]=e.fileCacheId,this._rectangles[i]=a.a.fromString(e.itemsRectangles[i])}},e.prototype.getImageContainerFor=function(e){if(!this.hasImageContainerFor(e))return null;var t=this._fileCacheIdToCombined[e];return this.imageContainers[t]},e.prototype.hasImageContainerFor=function(e){return null!=e&&void 0!==e&&0!==e.length&&e in this._fileCacheIdToCombined},e.prototype.getImageContainerRectangleFor=function(e){return this._rectangles[e]},e.prototype.addImageContainerLoaded=function(e){this._imageContainerLoadedEvent.add(e)},e.prototype.removeImageContainerLoaded=function(e){this._imageContainerLoadedEvent.remove(e)},e.prototype._getImageUrl=function(e){return this._serviceEndpoint+"/txt?f="+encodeURIComponent(e)},e.prototype._raiseImageLoadedEvent=function(){this._imageContainerLoadedEvent.notify(this)},e}();n.d(t,"a",function(){return h});var c=function(){return function(e,t,n,i,o){this._timeout=e,this._message=t,this._stacktrace=n,this._type=i,this._data=o}}(),h=function(){function e(e,t){void 0===t&&(t=6e4),this._serviceEndpoint=e,this._timeout=t,this._multiCallEnabled=!1,this._nextMultiCallRequest=null,this.imageLoaderService=new l(this._serviceEndpoint)}return Object.defineProperty(e.prototype,"multiCallEnabled",{get:function(){return this._multiCallEnabled},set:function(e){this._multiCallEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serviceEndpoint",{get:function(){return this._serviceEndpoint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiCallStarted",{get:function(){return null!=this._nextMultiCallRequest&&this._nextMultiCallRequest.multiCallStarted},enumerable:!0,configurable:!0}),e.prototype.beginMultiCall=function(){this.multiCallEnabled&&(this.multiCallStarted||(this._nextMultiCallRequest=new o(this,this.imageLoaderService)),this._nextMultiCallRequest.beginMultiCall())},e.prototype.endMultiCall=function(e){if(void 0===e&&(e=!0),!this.multiCallEnabled)return Promise.resolve(!1);if(!this.multiCallStarted)throw new Error("ServiceProxy: beginMultiCall should be called first to start MultiCall.");return this._nextMultiCallRequest.endMultiCall(e)},e.prototype.UpdateImageItemHandler=function(e,t,n,i,o,r,a,s){var l={canvasData:e,itemHandlerData:t,itemData:n,actualSize:i,preserveAspectRatio:o,url:r};this.sendRequest("UpdateImageItemHandler",l,a,s)},e.prototype.UpdateBarcodeItemHandler=function(e,t,n,i,o){var r={canvasData:e,itemHandlerData:t,itemData:n};this.sendRequest("UpdateBarcodeItemHandler",r,i,o)},e.prototype.UpdateBoundedTextItemHandler=function(e,t,n,i,o){this._callUpdateItemHandler(e,t,n,i,o,"_updateBoundedTextItemHandler")},e.prototype._updateBoundedTextItemHandler=function(e,t,n,i,o){var r={itemData:n,canvasData:e,itemHandlerData:t};this.sendRequest("UpdateBoundedTextItemHandler",r,i,o)},e.prototype.UpdatePathBoundedTextItemHandler=function(e,t,n,i,o){var r={itemData:n,canvasData:e,itemHandlerData:t};this.sendRequest("UpdatePathBoundedTextItemHandler",r,i,o)},e.prototype.UpdatePlainTextItemHandler=function(e,t,n,i,o){this._callUpdateItemHandler(e,t,n,i,o,"_updatePlainTextItemHandler")},e.prototype._updatePlainTextItemHandler=function(e,t,n,i,o){var r={itemData:n,canvasData:e,itemHandlerData:t};this.sendRequest("UpdatePlainTextItemHandler",r,i,o)},e.prototype.UpdateAutoScaledTextItemHandler=function(e,t,n,i,o){var r={itemData:n,canvasData:e,itemHandlerData:t};this.sendRequest("UpdateAutoScaledTextItemHandler",r,i,o)},e.prototype.UpdateCurvedTextItemHandler=function(e,t,n,i,o){var r={itemData:n,canvasData:e,itemHandlerData:t};this.sendRequest("UpdateCurvedTextItemHandler",r,i,o)},e.prototype.UpdateByColorData=function(e,t,n,i){this._callUpdateItemHandler(e,t,null,n,i,"_updateByColorData")},e.prototype._updateByColorData=function(e,t,n,i,o){var r={canvasData:e,colorData:t};this.sendRequest("UpdateByColorData",r,i,o)},e.prototype.UpdateByRectangleItemHandlerData=function(e,t,n,i,o){this.UpdateShapeItemHandler(e,t,n,i,o)},e.prototype.UpdateShapeItemHandler=function(e,t,n,i,o){this._callUpdateItemHandler(e,t,n,i,o,"_updateShapeItemHandler")},e.prototype._updateShapeItemHandler=function(e,t,n,i,o){var r={canvasData:e,itemData:n,itemHandlerData:t};this.sendRequest("UpdateShapeItemHandler",r,i,o)},e.prototype.GetImageSize=function(e,t,n,i){this._getImageSize(e,t,n,i)},e.prototype._getImageSize=function(e,t,n,i){var o={imageId:e,pageIndex:t};this.sendRequest("GetImageSize",o,n,i)},e.prototype.render=function(e,t,n,i){var o={product:e,renderingConfig:t};this.sendRequest("render",o,n,i)},e.prototype.getWatermarkItemsAsync=function(e,t,n){var i=this,o={width:e,height:t,watermarkConfig:n};return new Promise(function(e,t){i.sendRequest("getWatermarkItems",o,function(t){e(t)},function(e,n,i){return t({error:e,userContext:n,methodName:i})})})},e.prototype.getWatermarkItems=function(e,t,n,i,o){var r={width:e,height:t,watermarkConfig:n};this.sendRequest("getWatermarkItems",r,i,o)},e.prototype.sendRequest=function(e,t,n,i,o){void 0===o&&(o=!1);var r=new XMLHttpRequest,a=this._serviceEndpoint;"render"===e&&(a=a.replace("api/ccviewer","api/rendering")),r.open("POST",a+"/"+e),o&&(r.responseType="arraybuffer"),r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.timeout=this._timeout,r.onload=function(t){if(200===r.status)o?n(r.response,r):n(JSON.parse(r.response));else{var a=new c(!1,r.statusText,r.response);i(a,null,e)}},r.onerror=function(t){i("error",null,e)},r.ontimeout=function(t){var n=new c(!0,r.statusText,r.response);i(n,null,e)};var s=JSON.stringify(t);r.send(s)},e.prototype._callUpdateItemHandler=function(e,t,n,i,o,r){var a=r;r.startsWith("_")&&(a=r.charAt(1).toUpperCase()+r.substring(2));var s={canvasData:e,itemHandlerData:t,itemData:n,methodName:a};null!=this._nextMultiCallRequest&&this._nextMultiCallRequest.multiCallStarted&&this._nextMultiCallRequest.queueForMultiCall(s,i,o)||this[r](e,t,n,i,o)},e}()}}]);